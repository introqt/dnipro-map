(function(X){typeof define=="function"&&define.amd?define(X):X()})((function(){"use strict";function _mergeNamespaces(X,at){for(var Y=0;Y<at.length;Y++){const ot=at[Y];if(typeof ot!="string"&&!Array.isArray(ot)){for(const lt in ot)if(lt!=="default"&&!(lt in X)){const z=Object.getOwnPropertyDescriptor(ot,lt);z&&Object.defineProperty(X,lt,z.get?z:{enumerable:!0,get:()=>ot[lt]})}}}return Object.freeze(Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}))}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(X){return X&&X.__esModule&&Object.prototype.hasOwnProperty.call(X,"default")?X.default:X}var leafletSrc$1={exports:{}};var leafletSrc=leafletSrc$1.exports,hasRequiredLeafletSrc;function requireLeafletSrc(){return hasRequiredLeafletSrc||(hasRequiredLeafletSrc=1,(function(X,at){(function(Y,ot){ot(at)})(leafletSrc,(function(Y){var ot="1.9.4";function lt(_){var M,S,T,R;for(S=1,T=arguments.length;S<T;S++){R=arguments[S];for(M in R)_[M]=R[M]}return _}var z=Object.create||(function(){function _(){}return function(M){return _.prototype=M,new _}})();function N(_,M){var S=Array.prototype.slice;if(_.bind)return _.bind.apply(_,S.call(arguments,1));var T=S.call(arguments,2);return function(){return _.apply(M,T.length?T.concat(S.call(arguments)):arguments)}}var J=0;function et(_){return"_leaflet_id"in _||(_._leaflet_id=++J),_._leaflet_id}function mt(_,M,S){var T,R,j,Q;return Q=function(){T=!1,R&&(j.apply(S,R),R=!1)},j=function(){T?R=arguments:(_.apply(S,arguments),setTimeout(Q,M),T=!0)},j}function Lt(_,M,S){var T=M[1],R=M[0],j=T-R;return _===T&&S?_:((_-R)%j+j)%j+R}function ft(){return!1}function kt(_,M){if(M===!1)return _;var S=Math.pow(10,M===void 0?6:M);return Math.round(_*S)/S}function Ct(_){return _.trim?_.trim():_.replace(/^\s+|\s+$/g,"")}function Tt(_){return Ct(_).split(/\s+/)}function St(_,M){Object.prototype.hasOwnProperty.call(_,"options")||(_.options=_.options?z(_.options):{});for(var S in M)_.options[S]=M[S];return _.options}function $t(_,M,S){var T=[];for(var R in _)T.push(encodeURIComponent(S?R.toUpperCase():R)+"="+encodeURIComponent(_[R]));return(!M||M.indexOf("?")===-1?"?":"&")+T.join("&")}var Ut=/\{ *([\w_ -]+) *\}/g;function ee(_,M){return _.replace(Ut,function(S,T){var R=M[T];if(R===void 0)throw new Error("No value provided for variable "+S);return typeof R=="function"&&(R=R(M)),R})}var ie=Array.isArray||function(_){return Object.prototype.toString.call(_)==="[object Array]"};function ei(_,M){for(var S=0;S<_.length;S++)if(_[S]===M)return S;return-1}var ke="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ve(_){return window["webkit"+_]||window["moz"+_]||window["ms"+_]}var pn=0;function Pr(_){var M=+new Date,S=Math.max(0,16-(M-pn));return pn=M+S,window.setTimeout(_,S)}var Rn=window.requestAnimationFrame||Ve("RequestAnimationFrame")||Pr,Si=window.cancelAnimationFrame||Ve("CancelAnimationFrame")||Ve("CancelRequestAnimationFrame")||function(_){window.clearTimeout(_)};function ue(_,M,S){if(S&&Rn===Pr)_.call(M);else return Rn.call(window,N(_,M))}function Me(_){_&&Si.call(window,_)}var qs={__proto__:null,extend:lt,create:z,bind:N,get lastId(){return J},stamp:et,throttle:mt,wrapNum:Lt,falseFn:ft,formatNum:kt,trim:Ct,splitWords:Tt,setOptions:St,getParamString:$t,template:ee,isArray:ie,indexOf:ei,emptyImageUrl:ke,requestFn:Rn,cancelFn:Si,requestAnimFrame:ue,cancelAnimFrame:Me};function ii(){}ii.extend=function(_){var M=function(){St(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=M.__super__=this.prototype,T=z(S);T.constructor=M,M.prototype=T;for(var R in this)Object.prototype.hasOwnProperty.call(this,R)&&R!=="prototype"&&R!=="__super__"&&(M[R]=this[R]);return _.statics&&lt(M,_.statics),_.includes&&(Ks(_.includes),lt.apply(null,[T].concat(_.includes))),lt(T,_),delete T.statics,delete T.includes,T.options&&(T.options=S.options?z(S.options):{},lt(T.options,_.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var j=0,Q=T._initHooks.length;j<Q;j++)T._initHooks[j].call(this)}},M},ii.include=function(_){var M=this.prototype.options;return lt(this.prototype,_),_.options&&(this.prototype.options=M,this.mergeOptions(_.options)),this},ii.mergeOptions=function(_){return lt(this.prototype.options,_),this},ii.addInitHook=function(_){var M=Array.prototype.slice.call(arguments,1),S=typeof _=="function"?_:function(){this[_].apply(this,M)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function Ks(_){if(!(typeof L>"u"||!L||!L.Mixin)){_=ie(_)?_:[_];for(var M=0;M<_.length;M++)_[M]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var De={on:function(_,M,S){if(typeof _=="object")for(var T in _)this._on(T,_[T],M);else{_=Tt(_);for(var R=0,j=_.length;R<j;R++)this._on(_[R],M,S)}return this},off:function(_,M,S){if(!arguments.length)delete this._events;else if(typeof _=="object")for(var T in _)this._off(T,_[T],M);else{_=Tt(_);for(var R=arguments.length===1,j=0,Q=_.length;j<Q;j++)R?this._off(_[j]):this._off(_[j],M,S)}return this},_on:function(_,M,S,T){if(typeof M!="function"){console.warn("wrong listener type: "+typeof M);return}if(this._listens(_,M,S)===!1){S===this&&(S=void 0);var R={fn:M,ctx:S};T&&(R.once=!0),this._events=this._events||{},this._events[_]=this._events[_]||[],this._events[_].push(R)}},_off:function(_,M,S){var T,R,j;if(this._events&&(T=this._events[_],!!T)){if(arguments.length===1){if(this._firingCount)for(R=0,j=T.length;R<j;R++)T[R].fn=ft;delete this._events[_];return}if(typeof M!="function"){console.warn("wrong listener type: "+typeof M);return}var Q=this._listens(_,M,S);if(Q!==!1){var dt=T[Q];this._firingCount&&(dt.fn=ft,this._events[_]=T=T.slice()),T.splice(Q,1)}}},fire:function(_,M,S){if(!this.listens(_,S))return this;var T=lt({},M,{type:_,target:this,sourceTarget:M&&M.sourceTarget||this});if(this._events){var R=this._events[_];if(R){this._firingCount=this._firingCount+1||1;for(var j=0,Q=R.length;j<Q;j++){var dt=R[j],gt=dt.fn;dt.once&&this.off(_,gt,dt.ctx),gt.call(dt.ctx||this,T)}this._firingCount--}}return S&&this._propagateEvent(T),this},listens:function(_,M,S,T){typeof _!="string"&&console.warn('"string" type argument expected');var R=M;typeof M!="function"&&(T=!!M,R=void 0,S=void 0);var j=this._events&&this._events[_];if(j&&j.length&&this._listens(_,R,S)!==!1)return!0;if(T){for(var Q in this._eventParents)if(this._eventParents[Q].listens(_,M,S,T))return!0}return!1},_listens:function(_,M,S){if(!this._events)return!1;var T=this._events[_]||[];if(!M)return!!T.length;S===this&&(S=void 0);for(var R=0,j=T.length;R<j;R++)if(T[R].fn===M&&T[R].ctx===S)return R;return!1},once:function(_,M,S){if(typeof _=="object")for(var T in _)this._on(T,_[T],M,!0);else{_=Tt(_);for(var R=0,j=_.length;R<j;R++)this._on(_[R],M,S,!0)}return this},addEventParent:function(_){return this._eventParents=this._eventParents||{},this._eventParents[et(_)]=_,this},removeEventParent:function(_){return this._eventParents&&delete this._eventParents[et(_)],this},_propagateEvent:function(_){for(var M in this._eventParents)this._eventParents[M].fire(_.type,lt({layer:_.target,propagatedFrom:_.target},_),!0)}};De.addEventListener=De.on,De.removeEventListener=De.clearAllEventListeners=De.off,De.addOneTimeEventListener=De.once,De.fireEvent=De.fire,De.hasEventListeners=De.listens;var Yi=ii.extend(De);function Gt(_,M,S){this.x=S?Math.round(_):_,this.y=S?Math.round(M):M}var In=Math.trunc||function(_){return _>0?Math.floor(_):Math.ceil(_)};Gt.prototype={clone:function(){return new Gt(this.x,this.y)},add:function(_){return this.clone()._add(zt(_))},_add:function(_){return this.x+=_.x,this.y+=_.y,this},subtract:function(_){return this.clone()._subtract(zt(_))},_subtract:function(_){return this.x-=_.x,this.y-=_.y,this},divideBy:function(_){return this.clone()._divideBy(_)},_divideBy:function(_){return this.x/=_,this.y/=_,this},multiplyBy:function(_){return this.clone()._multiplyBy(_)},_multiplyBy:function(_){return this.x*=_,this.y*=_,this},scaleBy:function(_){return new Gt(this.x*_.x,this.y*_.y)},unscaleBy:function(_){return new Gt(this.x/_.x,this.y/_.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=In(this.x),this.y=In(this.y),this},distanceTo:function(_){_=zt(_);var M=_.x-this.x,S=_.y-this.y;return Math.sqrt(M*M+S*S)},equals:function(_){return _=zt(_),_.x===this.x&&_.y===this.y},contains:function(_){return _=zt(_),Math.abs(_.x)<=Math.abs(this.x)&&Math.abs(_.y)<=Math.abs(this.y)},toString:function(){return"Point("+kt(this.x)+", "+kt(this.y)+")"}};function zt(_,M,S){return _ instanceof Gt?_:ie(_)?new Gt(_[0],_[1]):_==null?_:typeof _=="object"&&"x"in _&&"y"in _?new Gt(_.x,_.y):new Gt(_,M,S)}function ne(_,M){if(_)for(var S=M?[_,M]:_,T=0,R=S.length;T<R;T++)this.extend(S[T])}ne.prototype={extend:function(_){var M,S;if(!_)return this;if(_ instanceof Gt||typeof _[0]=="number"||"x"in _)M=S=zt(_);else if(_=we(_),M=_.min,S=_.max,!M||!S)return this;return!this.min&&!this.max?(this.min=M.clone(),this.max=S.clone()):(this.min.x=Math.min(M.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(M.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(_){return zt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,_)},getBottomLeft:function(){return zt(this.min.x,this.max.y)},getTopRight:function(){return zt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(_){var M,S;return typeof _[0]=="number"||_ instanceof Gt?_=zt(_):_=we(_),_ instanceof ne?(M=_.min,S=_.max):M=S=_,M.x>=this.min.x&&S.x<=this.max.x&&M.y>=this.min.y&&S.y<=this.max.y},intersects:function(_){_=we(_);var M=this.min,S=this.max,T=_.min,R=_.max,j=R.x>=M.x&&T.x<=S.x,Q=R.y>=M.y&&T.y<=S.y;return j&&Q},overlaps:function(_){_=we(_);var M=this.min,S=this.max,T=_.min,R=_.max,j=R.x>M.x&&T.x<S.x,Q=R.y>M.y&&T.y<S.y;return j&&Q},isValid:function(){return!!(this.min&&this.max)},pad:function(_){var M=this.min,S=this.max,T=Math.abs(M.x-S.x)*_,R=Math.abs(M.y-S.y)*_;return we(zt(M.x-T,M.y-R),zt(S.x+T,S.y+R))},equals:function(_){return _?(_=we(_),this.min.equals(_.getTopLeft())&&this.max.equals(_.getBottomRight())):!1}};function we(_,M){return!_||_ instanceof ne?_:new ne(_,M)}function Ee(_,M){if(_)for(var S=M?[_,M]:_,T=0,R=S.length;T<R;T++)this.extend(S[T])}Ee.prototype={extend:function(_){var M=this._southWest,S=this._northEast,T,R;if(_ instanceof Qt)T=_,R=_;else if(_ instanceof Ee){if(T=_._southWest,R=_._northEast,!T||!R)return this}else return _?this.extend(Kt(_)||le(_)):this;return!M&&!S?(this._southWest=new Qt(T.lat,T.lng),this._northEast=new Qt(R.lat,R.lng)):(M.lat=Math.min(T.lat,M.lat),M.lng=Math.min(T.lng,M.lng),S.lat=Math.max(R.lat,S.lat),S.lng=Math.max(R.lng,S.lng)),this},pad:function(_){var M=this._southWest,S=this._northEast,T=Math.abs(M.lat-S.lat)*_,R=Math.abs(M.lng-S.lng)*_;return new Ee(new Qt(M.lat-T,M.lng-R),new Qt(S.lat+T,S.lng+R))},getCenter:function(){return new Qt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Qt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Qt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(_){typeof _[0]=="number"||_ instanceof Qt||"lat"in _?_=Kt(_):_=le(_);var M=this._southWest,S=this._northEast,T,R;return _ instanceof Ee?(T=_.getSouthWest(),R=_.getNorthEast()):T=R=_,T.lat>=M.lat&&R.lat<=S.lat&&T.lng>=M.lng&&R.lng<=S.lng},intersects:function(_){_=le(_);var M=this._southWest,S=this._northEast,T=_.getSouthWest(),R=_.getNorthEast(),j=R.lat>=M.lat&&T.lat<=S.lat,Q=R.lng>=M.lng&&T.lng<=S.lng;return j&&Q},overlaps:function(_){_=le(_);var M=this._southWest,S=this._northEast,T=_.getSouthWest(),R=_.getNorthEast(),j=R.lat>M.lat&&T.lat<S.lat,Q=R.lng>M.lng&&T.lng<S.lng;return j&&Q},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(_,M){return _?(_=le(_),this._southWest.equals(_.getSouthWest(),M)&&this._northEast.equals(_.getNorthEast(),M)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function le(_,M){return _ instanceof Ee?_:new Ee(_,M)}function Qt(_,M,S){if(isNaN(_)||isNaN(M))throw new Error("Invalid LatLng object: ("+_+", "+M+")");this.lat=+_,this.lng=+M,S!==void 0&&(this.alt=+S)}Qt.prototype={equals:function(_,M){if(!_)return!1;_=Kt(_);var S=Math.max(Math.abs(this.lat-_.lat),Math.abs(this.lng-_.lng));return S<=(M===void 0?1e-9:M)},toString:function(_){return"LatLng("+kt(this.lat,_)+", "+kt(this.lng,_)+")"},distanceTo:function(_){return li.distance(this,Kt(_))},wrap:function(){return li.wrapLatLng(this)},toBounds:function(_){var M=180*_/40075017,S=M/Math.cos(Math.PI/180*this.lat);return le([this.lat-M,this.lng-S],[this.lat+M,this.lng+S])},clone:function(){return new Qt(this.lat,this.lng,this.alt)}};function Kt(_,M,S){return _ instanceof Qt?_:ie(_)&&typeof _[0]!="object"?_.length===3?new Qt(_[0],_[1],_[2]):_.length===2?new Qt(_[0],_[1]):null:_==null?_:typeof _=="object"&&"lat"in _?new Qt(_.lat,"lng"in _?_.lng:_.lon,_.alt):M===void 0?null:new Qt(_,M,S)}var ni={latLngToPoint:function(_,M){var S=this.projection.project(_),T=this.scale(M);return this.transformation._transform(S,T)},pointToLatLng:function(_,M){var S=this.scale(M),T=this.transformation.untransform(_,S);return this.projection.unproject(T)},project:function(_){return this.projection.project(_)},unproject:function(_){return this.projection.unproject(_)},scale:function(_){return 256*Math.pow(2,_)},zoom:function(_){return Math.log(_/256)/Math.LN2},getProjectedBounds:function(_){if(this.infinite)return null;var M=this.projection.bounds,S=this.scale(_),T=this.transformation.transform(M.min,S),R=this.transformation.transform(M.max,S);return new ne(T,R)},infinite:!1,wrapLatLng:function(_){var M=this.wrapLng?Lt(_.lng,this.wrapLng,!0):_.lng,S=this.wrapLat?Lt(_.lat,this.wrapLat,!0):_.lat,T=_.alt;return new Qt(S,M,T)},wrapLatLngBounds:function(_){var M=_.getCenter(),S=this.wrapLatLng(M),T=M.lat-S.lat,R=M.lng-S.lng;if(T===0&&R===0)return _;var j=_.getSouthWest(),Q=_.getNorthEast(),dt=new Qt(j.lat-T,j.lng-R),gt=new Qt(Q.lat-T,Q.lng-R);return new Ee(dt,gt)}},li=lt({},ni,{wrapLng:[-180,180],R:6371e3,distance:function(_,M){var S=Math.PI/180,T=_.lat*S,R=M.lat*S,j=Math.sin((M.lat-_.lat)*S/2),Q=Math.sin((M.lng-_.lng)*S/2),dt=j*j+Math.cos(T)*Math.cos(R)*Q*Q,gt=2*Math.atan2(Math.sqrt(dt),Math.sqrt(1-dt));return this.R*gt}}),Ji=6378137,zn={R:Ji,MAX_LATITUDE:85.0511287798,project:function(_){var M=Math.PI/180,S=this.MAX_LATITUDE,T=Math.max(Math.min(S,_.lat),-S),R=Math.sin(T*M);return new Gt(this.R*_.lng*M,this.R*Math.log((1+R)/(1-R))/2)},unproject:function(_){var M=180/Math.PI;return new Qt((2*Math.atan(Math.exp(_.y/this.R))-Math.PI/2)*M,_.x*M/this.R)},bounds:(function(){var _=Ji*Math.PI;return new ne([-_,-_],[_,_])})()};function Nn(_,M,S,T){if(ie(_)){this._a=_[0],this._b=_[1],this._c=_[2],this._d=_[3];return}this._a=_,this._b=M,this._c=S,this._d=T}Nn.prototype={transform:function(_,M){return this._transform(_.clone(),M)},_transform:function(_,M){return M=M||1,_.x=M*(this._a*_.x+this._b),_.y=M*(this._c*_.y+this._d),_},untransform:function(_,M){return M=M||1,new Gt((_.x/M-this._b)/this._a,(_.y/M-this._d)/this._c)}};function Xi(_,M,S,T){return new Nn(_,M,S,T)}var Gn=lt({},li,{code:"EPSG:3857",projection:zn,transformation:(function(){var _=.5/(Math.PI*zn.R);return Xi(_,.5,-_,.5)})()}),Sr=lt({},Gn,{code:"EPSG:900913"});function Ar(_){return document.createElementNS("http://www.w3.org/2000/svg",_)}function Dr(_,M){var S="",T,R,j,Q,dt,gt;for(T=0,j=_.length;T<j;T++){for(dt=_[T],R=0,Q=dt.length;R<Q;R++)gt=dt[R],S+=(R?"L":"M")+gt.x+" "+gt.y;S+=M?Rt.svg?"z":"x":""}return S||"M0 0"}var fn=document.documentElement.style,Ai="ActiveXObject"in window,Tr=Ai&&!document.addEventListener,Or="msLaunchUri"in navigator&&!("documentMode"in document),Zn=je("webkit"),Fr=je("android"),Rr=je("android 2")||je("android 3"),Ws=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ys=Fr&&je("Google")&&Ws<537&&!("AudioNode"in window),jn=!!window.opera,Ir=!Or&&je("chrome"),zr=je("gecko")&&!Zn&&!jn&&!Ai,Nr=!Ir&&je("safari"),Un=je("phantom"),Gr="OTransition"in fn,Di=navigator.platform.indexOf("Win")===0,Zr=Ai&&"transition"in fn,_n="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Rr,Ti="MozPerspective"in fn,jr=!window.L_DISABLE_3D&&(Zr||_n||Ti)&&!Gr&&!Un,Li=typeof orientation<"u"||je("mobile"),Js=Li&&Zn,Xs=Li&&_n,Hn=!window.PointerEvent&&window.MSPointerEvent,Ur=!!(window.PointerEvent||Hn),Hr="ontouchstart"in window||!!window.TouchEvent,$s=!window.L_NO_TOUCH&&(Hr||Ur),Qs=Li&&jn,Vr=Li&&zr,qr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ta=(function(){var _=!1;try{var M=Object.defineProperty({},"passive",{get:function(){_=!0}});window.addEventListener("testPassiveEventSupport",ft,M),window.removeEventListener("testPassiveEventSupport",ft,M)}catch{}return _})(),ea=(function(){return!!document.createElement("canvas").getContext})(),Vn=!!(document.createElementNS&&Ar("svg").createSVGRect),Kr=!!Vn&&(function(){var _=document.createElement("div");return _.innerHTML="<svg/>",(_.firstChild&&_.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ia=!Vn&&(function(){try{var _=document.createElement("div");_.innerHTML='<v:shape adj="1"/>';var M=_.firstChild;return M.style.behavior="url(#default#VML)",M&&typeof M.adj=="object"}catch{return!1}})(),na=navigator.platform.indexOf("Mac")===0,ra=navigator.platform.indexOf("Linux")===0;function je(_){return navigator.userAgent.toLowerCase().indexOf(_)>=0}var Rt={ie:Ai,ielt9:Tr,edge:Or,webkit:Zn,android:Fr,android23:Rr,androidStock:Ys,opera:jn,chrome:Ir,gecko:zr,safari:Nr,phantom:Un,opera12:Gr,win:Di,ie3d:Zr,webkit3d:_n,gecko3d:Ti,any3d:jr,mobile:Li,mobileWebkit:Js,mobileWebkit3d:Xs,msPointer:Hn,pointer:Ur,touch:$s,touchNative:Hr,mobileOpera:Qs,mobileGecko:Vr,retina:qr,passiveEvents:ta,canvas:ea,svg:Vn,vml:ia,inlineSvg:Kr,mac:na,linux:ra},Wr=Rt.msPointer?"MSPointerDown":"pointerdown",Yr=Rt.msPointer?"MSPointerMove":"pointermove",qn=Rt.msPointer?"MSPointerUp":"pointerup",Jr=Rt.msPointer?"MSPointerCancel":"pointercancel",Kn={touchstart:Wr,touchmove:Yr,touchend:qn,touchcancel:Jr},Xr={touchstart:la,touchmove:gn,touchend:gn,touchcancel:gn},Oi={},$r=!1;function sa(_,M,S){return M==="touchstart"&&Wn(),Xr[M]?(S=Xr[M].bind(this,S),_.addEventListener(Kn[M],S,!1),S):(console.warn("wrong event specified:",M),ft)}function aa(_,M,S){if(!Kn[M]){console.warn("wrong event specified:",M);return}_.removeEventListener(Kn[M],S,!1)}function oa(_){Oi[_.pointerId]=_}function ua(_){Oi[_.pointerId]&&(Oi[_.pointerId]=_)}function mn(_){delete Oi[_.pointerId]}function Wn(){$r||(document.addEventListener(Wr,oa,!0),document.addEventListener(Yr,ua,!0),document.addEventListener(qn,mn,!0),document.addEventListener(Jr,mn,!0),$r=!0)}function gn(_,M){if(M.pointerType!==(M.MSPOINTER_TYPE_MOUSE||"mouse")){M.touches=[];for(var S in Oi)M.touches.push(Oi[S]);M.changedTouches=[M],_(M)}}function la(_,M){M.MSPOINTER_TYPE_TOUCH&&M.pointerType===M.MSPOINTER_TYPE_TOUCH&&me(M),gn(_,M)}function ha(_){var M={},S,T;for(T in _)S=_[T],M[T]=S&&S.bind?S.bind(_):S;return _=M,M.type="dblclick",M.detail=2,M.isTrusted=!1,M._simulated=!0,M}var ca=200;function da(_,M){_.addEventListener("dblclick",M);var S=0,T;function R(j){if(j.detail!==1){T=j.detail;return}if(!(j.pointerType==="mouse"||j.sourceCapabilities&&!j.sourceCapabilities.firesTouchEvents)){var Q=ns(j);if(!(Q.some(function(gt){return gt instanceof HTMLLabelElement&&gt.attributes.for})&&!Q.some(function(gt){return gt instanceof HTMLInputElement||gt instanceof HTMLSelectElement}))){var dt=Date.now();dt-S<=ca?(T++,T===2&&M(ha(j))):T=1,S=dt}}}return _.addEventListener("click",R),{dblclick:M,simDblclick:R}}function pa(_,M){_.removeEventListener("dblclick",M.dblclick),_.removeEventListener("click",M.simDblclick)}var Yn=vn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),$i=vn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Qr=$i==="webkitTransition"||$i==="OTransition"?$i+"End":"transitionend";function ts(_){return typeof _=="string"?document.getElementById(_):_}function hi(_,M){var S=_.style[M]||_.currentStyle&&_.currentStyle[M];if((!S||S==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(_,null);S=T?T[M]:null}return S==="auto"?null:S}function Yt(_,M,S){var T=document.createElement(_);return T.className=M||"",S&&S.appendChild(T),T}function re(_){var M=_.parentNode;M&&M.removeChild(_)}function Qi(_){for(;_.firstChild;)_.removeChild(_.firstChild)}function Fi(_){var M=_.parentNode;M&&M.lastChild!==_&&M.appendChild(_)}function Ri(_){var M=_.parentNode;M&&M.firstChild!==_&&M.insertBefore(_,M.firstChild)}function Jn(_,M){if(_.classList!==void 0)return _.classList.contains(M);var S=yn(_);return S.length>0&&new RegExp("(^|\\s)"+M+"(\\s|$)").test(S)}function Ht(_,M){if(_.classList!==void 0)for(var S=Tt(M),T=0,R=S.length;T<R;T++)_.classList.add(S[T]);else if(!Jn(_,M)){var j=yn(_);Xn(_,(j?j+" ":"")+M)}}function ae(_,M){_.classList!==void 0?_.classList.remove(M):Xn(_,Ct((" "+yn(_)+" ").replace(" "+M+" "," ")))}function Xn(_,M){_.className.baseVal===void 0?_.className=M:_.className.baseVal=M}function yn(_){return _.correspondingElement&&(_=_.correspondingElement),_.className.baseVal===void 0?_.className:_.className.baseVal}function Re(_,M){"opacity"in _.style?_.style.opacity=M:"filter"in _.style&&fa(_,M)}function fa(_,M){var S=!1,T="DXImageTransform.Microsoft.Alpha";try{S=_.filters.item(T)}catch{if(M===1)return}M=Math.round(M*100),S?(S.Enabled=M!==100,S.Opacity=M):_.style.filter+=" progid:"+T+"(opacity="+M+")"}function vn(_){for(var M=document.documentElement.style,S=0;S<_.length;S++)if(_[S]in M)return _[S];return!1}function Ci(_,M,S){var T=M||new Gt(0,0);_.style[Yn]=(Rt.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(S?" scale("+S+")":"")}function he(_,M){_._leaflet_pos=M,Rt.any3d?Ci(_,M):(_.style.left=M.x+"px",_.style.top=M.y+"px")}function ci(_){return _._leaflet_pos||new Gt(0,0)}var tn,en,$n;if("onselectstart"in document)tn=function(){Zt(window,"selectstart",me)},en=function(){Jt(window,"selectstart",me)};else{var nn=vn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);tn=function(){if(nn){var _=document.documentElement.style;$n=_[nn],_[nn]="none"}},en=function(){nn&&(document.documentElement.style[nn]=$n,$n=void 0)}}function Qn(){Zt(window,"dragstart",me)}function tr(){Jt(window,"dragstart",me)}var Ln,er;function ir(_){for(;_.tabIndex===-1;)_=_.parentNode;_.style&&(Cn(),Ln=_,er=_.style.outlineStyle,_.style.outlineStyle="none",Zt(window,"keydown",Cn))}function Cn(){Ln&&(Ln.style.outlineStyle=er,Ln=void 0,er=void 0,Jt(window,"keydown",Cn))}function es(_){do _=_.parentNode;while((!_.offsetWidth||!_.offsetHeight)&&_!==document.body);return _}function nr(_){var M=_.getBoundingClientRect();return{x:M.width/_.offsetWidth||1,y:M.height/_.offsetHeight||1,boundingClientRect:M}}var _a={__proto__:null,TRANSFORM:Yn,TRANSITION:$i,TRANSITION_END:Qr,get:ts,getStyle:hi,create:Yt,remove:re,empty:Qi,toFront:Fi,toBack:Ri,hasClass:Jn,addClass:Ht,removeClass:ae,setClass:Xn,getClass:yn,setOpacity:Re,testProp:vn,setTransform:Ci,setPosition:he,getPosition:ci,get disableTextSelection(){return tn},get enableTextSelection(){return en},disableImageDrag:Qn,enableImageDrag:tr,preventOutline:ir,restoreOutline:Cn,getSizedParentNode:es,getScale:nr};function Zt(_,M,S,T){if(M&&typeof M=="object")for(var R in M)sr(_,R,M[R],S);else{M=Tt(M);for(var j=0,Q=M.length;j<Q;j++)sr(_,M[j],S,T)}return this}var qe="_leaflet_events";function Jt(_,M,S,T){if(arguments.length===1)is(_),delete _[qe];else if(M&&typeof M=="object")for(var R in M)ar(_,R,M[R],S);else if(M=Tt(M),arguments.length===2)is(_,function(dt){return ei(M,dt)!==-1});else for(var j=0,Q=M.length;j<Q;j++)ar(_,M[j],S,T);return this}function is(_,M){for(var S in _[qe]){var T=S.split(/\d/)[0];(!M||M(T))&&ar(_,T,null,null,S)}}var rr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function sr(_,M,S,T){var R=M+et(S)+(T?"_"+et(T):"");if(_[qe]&&_[qe][R])return this;var j=function(dt){return S.call(T||_,dt||window.event)},Q=j;!Rt.touchNative&&Rt.pointer&&M.indexOf("touch")===0?j=sa(_,M,j):Rt.touch&&M==="dblclick"?j=da(_,j):"addEventListener"in _?M==="touchstart"||M==="touchmove"||M==="wheel"||M==="mousewheel"?_.addEventListener(rr[M]||M,j,Rt.passiveEvents?{passive:!1}:!1):M==="mouseenter"||M==="mouseleave"?(j=function(dt){dt=dt||window.event,bn(_,dt)&&Q(dt)},_.addEventListener(rr[M],j,!1)):_.addEventListener(M,Q,!1):_.attachEvent("on"+M,j),_[qe]=_[qe]||{},_[qe][R]=j}function ar(_,M,S,T,R){R=R||M+et(S)+(T?"_"+et(T):"");var j=_[qe]&&_[qe][R];if(!j)return this;!Rt.touchNative&&Rt.pointer&&M.indexOf("touch")===0?aa(_,M,j):Rt.touch&&M==="dblclick"?pa(_,j):"removeEventListener"in _?_.removeEventListener(rr[M]||M,j,!1):_.detachEvent("on"+M,j),_[qe][R]=null}function bi(_){return _.stopPropagation?_.stopPropagation():_.originalEvent?_.originalEvent._stopped=!0:_.cancelBubble=!0,this}function or(_){return sr(_,"wheel",bi),this}function rn(_){return Zt(_,"mousedown touchstart dblclick contextmenu",bi),_._leaflet_disable_click=!0,this}function me(_){return _.preventDefault?_.preventDefault():_.returnValue=!1,this}function xi(_){return me(_),bi(_),this}function ns(_){if(_.composedPath)return _.composedPath();for(var M=[],S=_.target;S;)M.push(S),S=S.parentNode;return M}function sn(_,M){if(!M)return new Gt(_.clientX,_.clientY);var S=nr(M),T=S.boundingClientRect;return new Gt((_.clientX-T.left)/S.x-M.clientLeft,(_.clientY-T.top)/S.y-M.clientTop)}var ma=Rt.linux&&Rt.chrome?window.devicePixelRatio:Rt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function rs(_){return Rt.edge?_.wheelDeltaY/2:_.deltaY&&_.deltaMode===0?-_.deltaY/ma:_.deltaY&&_.deltaMode===1?-_.deltaY*20:_.deltaY&&_.deltaMode===2?-_.deltaY*60:_.deltaX||_.deltaZ?0:_.wheelDelta?(_.wheelDeltaY||_.wheelDelta)/2:_.detail&&Math.abs(_.detail)<32765?-_.detail*20:_.detail?_.detail/-32765*60:0}function bn(_,M){var S=M.relatedTarget;if(!S)return!0;try{for(;S&&S!==_;)S=S.parentNode}catch{return!1}return S!==_}var Wt={__proto__:null,on:Zt,off:Jt,stopPropagation:bi,disableScrollPropagation:or,disableClickPropagation:rn,preventDefault:me,stop:xi,getPropagationPath:ns,getMousePosition:sn,getWheelDelta:rs,isExternalTarget:bn,addListener:Zt,removeListener:Jt},ss=Yi.extend({run:function(_,M,S,T){this.stop(),this._el=_,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=ci(_),this._offset=M.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ue(this._animate,this),this._step()},_step:function(_){var M=+new Date-this._startTime,S=this._duration*1e3;M<S?this._runFrame(this._easeOut(M/S),_):(this._runFrame(1),this._complete())},_runFrame:function(_,M){var S=this._startPos.add(this._offset.multiplyBy(_));M&&S._round(),he(this._el,S),this.fire("step")},_complete:function(){Me(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(_){return 1-Math.pow(1-_,this._easeOutPower)}}),qt=Yi.extend({options:{crs:Gn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(_,M){M=St(this,M),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(_),this._initLayout(),this._onResize=N(this._onResize,this),this._initEvents(),M.maxBounds&&this.setMaxBounds(M.maxBounds),M.zoom!==void 0&&(this._zoom=this._limitZoom(M.zoom)),M.center&&M.zoom!==void 0&&this.setView(Kt(M.center),M.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=$i&&Rt.any3d&&!Rt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Zt(this._proxy,Qr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(_,M,S){if(M=M===void 0?this._zoom:this._limitZoom(M),_=this._limitCenter(Kt(_),M,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=lt({animate:S.animate},S.zoom),S.pan=lt({animate:S.animate,duration:S.duration},S.pan));var T=this._zoom!==M?this._tryAnimatedZoom&&this._tryAnimatedZoom(_,M,S.zoom):this._tryAnimatedPan(_,S.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(_,M,S.pan&&S.pan.noMoveStart),this},setZoom:function(_,M){return this._loaded?this.setView(this.getCenter(),_,{zoom:M}):(this._zoom=_,this)},zoomIn:function(_,M){return _=_||(Rt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+_,M)},zoomOut:function(_,M){return _=_||(Rt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-_,M)},setZoomAround:function(_,M,S){var T=this.getZoomScale(M),R=this.getSize().divideBy(2),j=_ instanceof Gt?_:this.latLngToContainerPoint(_),Q=j.subtract(R).multiplyBy(1-1/T),dt=this.containerPointToLatLng(R.add(Q));return this.setView(dt,M,{zoom:S})},_getBoundsCenterZoom:function(_,M){M=M||{},_=_.getBounds?_.getBounds():le(_);var S=zt(M.paddingTopLeft||M.padding||[0,0]),T=zt(M.paddingBottomRight||M.padding||[0,0]),R=this.getBoundsZoom(_,!1,S.add(T));if(R=typeof M.maxZoom=="number"?Math.min(M.maxZoom,R):R,R===1/0)return{center:_.getCenter(),zoom:R};var j=T.subtract(S).divideBy(2),Q=this.project(_.getSouthWest(),R),dt=this.project(_.getNorthEast(),R),gt=this.unproject(Q.add(dt).divideBy(2).add(j),R);return{center:gt,zoom:R}},fitBounds:function(_,M){if(_=le(_),!_.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(_,M);return this.setView(S.center,S.zoom,M)},fitWorld:function(_){return this.fitBounds([[-90,-180],[90,180]],_)},panTo:function(_,M){return this.setView(_,this._zoom,{pan:M})},panBy:function(_,M){if(_=zt(_).round(),M=M||{},!_.x&&!_.y)return this.fire("moveend");if(M.animate!==!0&&!this.getSize().contains(_))return this._resetView(this.unproject(this.project(this.getCenter()).add(_)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ss,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),M.noMoveStart||this.fire("movestart"),M.animate!==!1){Ht(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(_).round();this._panAnim.run(this._mapPane,S,M.duration||.25,M.easeLinearity)}else this._rawPanBy(_),this.fire("move").fire("moveend");return this},flyTo:function(_,M,S){if(S=S||{},S.animate===!1||!Rt.any3d)return this.setView(_,M,S);this._stop();var T=this.project(this.getCenter()),R=this.project(_),j=this.getSize(),Q=this._zoom;_=Kt(_),M=M===void 0?Q:M;var dt=Math.max(j.x,j.y),gt=dt*this.getZoomScale(Q,M),Mt=R.distanceTo(T)||1,Dt=1.42,It=Dt*Dt;function Vt(se){var xe=se?-1:1,Se=se?gt:dt,Ts=gt*gt-dt*dt+xe*It*It*Mt*Mt,He=2*Se*It*Mt,Nt=Ts/He,On=Math.sqrt(Nt*Nt+1)-Nt,xr=On<1e-9?-18:Math.log(On);return xr}function be(se){return(Math.exp(se)-Math.exp(-se))/2}function _e(se){return(Math.exp(se)+Math.exp(-se))/2}function Ze(se){return be(se)/_e(se)}var Pe=Vt(0);function mi(se){return dt*(_e(Pe)/_e(Pe+Dt*se))}function Ss(se){return dt*(_e(Pe)*Ze(Pe+Dt*se)-be(Pe))/It}function br(se){return 1-Math.pow(1-se,1.5)}var Oa=Date.now(),As=(Vt(1)-Pe)/Dt,Fa=S.duration?1e3*S.duration:1e3*As*.8;function Ds(){var se=(Date.now()-Oa)/Fa,xe=br(se)*As;se<=1?(this._flyToFrame=ue(Ds,this),this._move(this.unproject(T.add(R.subtract(T).multiplyBy(Ss(xe)/Mt)),Q),this.getScaleZoom(dt/mi(xe),Q),{flyTo:!0})):this._move(_,M)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),Ds.call(this),this},flyToBounds:function(_,M){var S=this._getBoundsCenterZoom(_,M);return this.flyTo(S.center,S.zoom,M)},setMaxBounds:function(_){return _=le(_),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),_.isValid()?(this.options.maxBounds=_,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(_){var M=this.options.minZoom;return this.options.minZoom=_,this._loaded&&M!==_&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(_):this},setMaxZoom:function(_){var M=this.options.maxZoom;return this.options.maxZoom=_,this._loaded&&M!==_&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(_):this},panInsideBounds:function(_,M){this._enforcingBounds=!0;var S=this.getCenter(),T=this._limitCenter(S,this._zoom,le(_));return S.equals(T)||this.panTo(T,M),this._enforcingBounds=!1,this},panInside:function(_,M){M=M||{};var S=zt(M.paddingTopLeft||M.padding||[0,0]),T=zt(M.paddingBottomRight||M.padding||[0,0]),R=this.project(this.getCenter()),j=this.project(_),Q=this.getPixelBounds(),dt=we([Q.min.add(S),Q.max.subtract(T)]),gt=dt.getSize();if(!dt.contains(j)){this._enforcingBounds=!0;var Mt=j.subtract(dt.getCenter()),Dt=dt.extend(j).getSize().subtract(gt);R.x+=Mt.x<0?-Dt.x:Dt.x,R.y+=Mt.y<0?-Dt.y:Dt.y,this.panTo(this.unproject(R),M),this._enforcingBounds=!1}return this},invalidateSize:function(_){if(!this._loaded)return this;_=lt({animate:!1,pan:!0},_===!0?{animate:!0}:_);var M=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),T=M.divideBy(2).round(),R=S.divideBy(2).round(),j=T.subtract(R);return!j.x&&!j.y?this:(_.animate&&_.pan?this.panBy(j):(_.pan&&this._rawPanBy(j),this.fire("move"),_.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(N(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:M,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(_){if(_=this._locateOptions=lt({timeout:1e4,watch:!1},_),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var M=N(this._handleGeolocationResponse,this),S=N(this._handleGeolocationError,this);return _.watch?this._locationWatchId=navigator.geolocation.watchPosition(M,S,_):navigator.geolocation.getCurrentPosition(M,S,_),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(_){if(this._container._leaflet_id){var M=_.code,S=_.message||(M===1?"permission denied":M===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:M,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(_){if(this._container._leaflet_id){var M=_.coords.latitude,S=_.coords.longitude,T=new Qt(M,S),R=T.toBounds(_.coords.accuracy*2),j=this._locateOptions;if(j.setView){var Q=this.getBoundsZoom(R);this.setView(T,j.maxZoom?Math.min(Q,j.maxZoom):Q)}var dt={latlng:T,bounds:R,timestamp:_.timestamp};for(var gt in _.coords)typeof _.coords[gt]=="number"&&(dt[gt]=_.coords[gt]);this.fire("locationfound",dt)}},addHandler:function(_,M){if(!M)return this;var S=this[_]=new M(this);return this._handlers.push(S),this.options[_]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),re(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Me(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var _;for(_ in this._layers)this._layers[_].remove();for(_ in this._panes)re(this._panes[_]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(_,M){var S="leaflet-pane"+(_?" leaflet-"+_.replace("Pane","")+"-pane":""),T=Yt("div",S,M||this._mapPane);return _&&(this._panes[_]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var _=this.getPixelBounds(),M=this.unproject(_.getBottomLeft()),S=this.unproject(_.getTopRight());return new Ee(M,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(_,M,S){_=le(_),S=zt(S||[0,0]);var T=this.getZoom()||0,R=this.getMinZoom(),j=this.getMaxZoom(),Q=_.getNorthWest(),dt=_.getSouthEast(),gt=this.getSize().subtract(S),Mt=we(this.project(dt,T),this.project(Q,T)).getSize(),Dt=Rt.any3d?this.options.zoomSnap:1,It=gt.x/Mt.x,Vt=gt.y/Mt.y,be=M?Math.max(It,Vt):Math.min(It,Vt);return T=this.getScaleZoom(be,T),Dt&&(T=Math.round(T/(Dt/100))*(Dt/100),T=M?Math.ceil(T/Dt)*Dt:Math.floor(T/Dt)*Dt),Math.max(R,Math.min(j,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Gt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(_,M){var S=this._getTopLeftPoint(_,M);return new ne(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(_){return this.options.crs.getProjectedBounds(_===void 0?this.getZoom():_)},getPane:function(_){return typeof _=="string"?this._panes[_]:_},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(_,M){var S=this.options.crs;return M=M===void 0?this._zoom:M,S.scale(_)/S.scale(M)},getScaleZoom:function(_,M){var S=this.options.crs;M=M===void 0?this._zoom:M;var T=S.zoom(_*S.scale(M));return isNaN(T)?1/0:T},project:function(_,M){return M=M===void 0?this._zoom:M,this.options.crs.latLngToPoint(Kt(_),M)},unproject:function(_,M){return M=M===void 0?this._zoom:M,this.options.crs.pointToLatLng(zt(_),M)},layerPointToLatLng:function(_){var M=zt(_).add(this.getPixelOrigin());return this.unproject(M)},latLngToLayerPoint:function(_){var M=this.project(Kt(_))._round();return M._subtract(this.getPixelOrigin())},wrapLatLng:function(_){return this.options.crs.wrapLatLng(Kt(_))},wrapLatLngBounds:function(_){return this.options.crs.wrapLatLngBounds(le(_))},distance:function(_,M){return this.options.crs.distance(Kt(_),Kt(M))},containerPointToLayerPoint:function(_){return zt(_).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(_){return zt(_).add(this._getMapPanePos())},containerPointToLatLng:function(_){var M=this.containerPointToLayerPoint(zt(_));return this.layerPointToLatLng(M)},latLngToContainerPoint:function(_){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Kt(_)))},mouseEventToContainerPoint:function(_){return sn(_,this._container)},mouseEventToLayerPoint:function(_){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(_))},mouseEventToLatLng:function(_){return this.layerPointToLatLng(this.mouseEventToLayerPoint(_))},_initContainer:function(_){var M=this._container=ts(_);if(M){if(M._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Zt(M,"scroll",this._onScroll,this),this._containerId=et(M)},_initLayout:function(){var _=this._container;this._fadeAnimated=this.options.fadeAnimation&&Rt.any3d,Ht(_,"leaflet-container"+(Rt.touch?" leaflet-touch":"")+(Rt.retina?" leaflet-retina":"")+(Rt.ielt9?" leaflet-oldie":"")+(Rt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var M=hi(_,"position");M!=="absolute"&&M!=="relative"&&M!=="fixed"&&M!=="sticky"&&(_.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var _=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),he(this._mapPane,new Gt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ht(_.markerPane,"leaflet-zoom-hide"),Ht(_.shadowPane,"leaflet-zoom-hide"))},_resetView:function(_,M,S){he(this._mapPane,new Gt(0,0));var T=!this._loaded;this._loaded=!0,M=this._limitZoom(M),this.fire("viewprereset");var R=this._zoom!==M;this._moveStart(R,S)._move(_,M)._moveEnd(R),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(_,M){return _&&this.fire("zoomstart"),M||this.fire("movestart"),this},_move:function(_,M,S,T){M===void 0&&(M=this._zoom);var R=this._zoom!==M;return this._zoom=M,this._lastCenter=_,this._pixelOrigin=this._getNewPixelOrigin(_),T?S&&S.pinch&&this.fire("zoom",S):((R||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(_){return _&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Me(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(_){he(this._mapPane,this._getMapPanePos().subtract(_))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(_){this._targets={},this._targets[et(this._container)]=this;var M=_?Jt:Zt;M(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&M(window,"resize",this._onResize,this),Rt.any3d&&this.options.transform3DLimit&&(_?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Me(this._resizeRequest),this._resizeRequest=ue(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var _=this._getMapPanePos();Math.max(Math.abs(_.x),Math.abs(_.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(_,M){for(var S=[],T,R=M==="mouseout"||M==="mouseover",j=_.target||_.srcElement,Q=!1;j;){if(T=this._targets[et(j)],T&&(M==="click"||M==="preclick")&&this._draggableMoved(T)){Q=!0;break}if(T&&T.listens(M,!0)&&(R&&!bn(j,_)||(S.push(T),R))||j===this._container)break;j=j.parentNode}return!S.length&&!Q&&!R&&this.listens(M,!0)&&(S=[this]),S},_isClickDisabled:function(_){for(;_&&_!==this._container;){if(_._leaflet_disable_click)return!0;_=_.parentNode}},_handleDOMEvent:function(_){var M=_.target||_.srcElement;if(!(!this._loaded||M._leaflet_disable_events||_.type==="click"&&this._isClickDisabled(M))){var S=_.type;S==="mousedown"&&ir(M),this._fireDOMEvent(_,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(_,M,S){if(_.type==="click"){var T=lt({},_);T.type="preclick",this._fireDOMEvent(T,T.type,S)}var R=this._findEventTargets(_,M);if(S){for(var j=[],Q=0;Q<S.length;Q++)S[Q].listens(M,!0)&&j.push(S[Q]);R=j.concat(R)}if(R.length){M==="contextmenu"&&me(_);var dt=R[0],gt={originalEvent:_};if(_.type!=="keypress"&&_.type!=="keydown"&&_.type!=="keyup"){var Mt=dt.getLatLng&&(!dt._radius||dt._radius<=10);gt.containerPoint=Mt?this.latLngToContainerPoint(dt.getLatLng()):this.mouseEventToContainerPoint(_),gt.layerPoint=this.containerPointToLayerPoint(gt.containerPoint),gt.latlng=Mt?dt.getLatLng():this.layerPointToLatLng(gt.layerPoint)}for(Q=0;Q<R.length;Q++)if(R[Q].fire(M,gt,!0),gt.originalEvent._stopped||R[Q].options.bubblingMouseEvents===!1&&ei(this._mouseEvents,M)!==-1)return}},_draggableMoved:function(_){return _=_.dragging&&_.dragging.enabled()?_:this,_.dragging&&_.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var _=0,M=this._handlers.length;_<M;_++)this._handlers[_].disable()},whenReady:function(_,M){return this._loaded?_.call(M||this,{target:this}):this.on("load",_,M),this},_getMapPanePos:function(){return ci(this._mapPane)||new Gt(0,0)},_moved:function(){var _=this._getMapPanePos();return _&&!_.equals([0,0])},_getTopLeftPoint:function(_,M){var S=_&&M!==void 0?this._getNewPixelOrigin(_,M):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(_,M){var S=this.getSize()._divideBy(2);return this.project(_,M)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(_,M,S){var T=this._getNewPixelOrigin(S,M);return this.project(_,M)._subtract(T)},_latLngBoundsToNewLayerBounds:function(_,M,S){var T=this._getNewPixelOrigin(S,M);return we([this.project(_.getSouthWest(),M)._subtract(T),this.project(_.getNorthWest(),M)._subtract(T),this.project(_.getSouthEast(),M)._subtract(T),this.project(_.getNorthEast(),M)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(_){return this.latLngToLayerPoint(_).subtract(this._getCenterLayerPoint())},_limitCenter:function(_,M,S){if(!S)return _;var T=this.project(_,M),R=this.getSize().divideBy(2),j=new ne(T.subtract(R),T.add(R)),Q=this._getBoundsOffset(j,S,M);return Math.abs(Q.x)<=1&&Math.abs(Q.y)<=1?_:this.unproject(T.add(Q),M)},_limitOffset:function(_,M){if(!M)return _;var S=this.getPixelBounds(),T=new ne(S.min.add(_),S.max.add(_));return _.add(this._getBoundsOffset(T,M))},_getBoundsOffset:function(_,M,S){var T=we(this.project(M.getNorthEast(),S),this.project(M.getSouthWest(),S)),R=T.min.subtract(_.min),j=T.max.subtract(_.max),Q=this._rebound(R.x,-j.x),dt=this._rebound(R.y,-j.y);return new Gt(Q,dt)},_rebound:function(_,M){return _+M>0?Math.round(_-M)/2:Math.max(0,Math.ceil(_))-Math.max(0,Math.floor(M))},_limitZoom:function(_){var M=this.getMinZoom(),S=this.getMaxZoom(),T=Rt.any3d?this.options.zoomSnap:1;return T&&(_=Math.round(_/T)*T),Math.max(M,Math.min(S,_))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ae(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(_,M){var S=this._getCenterOffset(_)._trunc();return(M&&M.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,M),!0)},_createAnimProxy:function(){var _=this._proxy=Yt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(_),this.on("zoomanim",function(M){var S=Yn,T=this._proxy.style[S];Ci(this._proxy,this.project(M.center,M.zoom),this.getZoomScale(M.zoom,1)),T===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){re(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var _=this.getCenter(),M=this.getZoom();Ci(this._proxy,this.project(_,M),this.getZoomScale(M,1))},_catchTransitionEnd:function(_){this._animatingZoom&&_.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(_,M,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(M-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(M),R=this._getCenterOffset(_)._divideBy(1-1/T);return S.animate!==!0&&!this.getSize().contains(R)?!1:(ue(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(_,M,!0)},this),!0)},_animateZoom:function(_,M,S,T){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=_,this._animateToZoom=M,Ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:_,zoom:M,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(N(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ae(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function xn(_,M){return new qt(_,M)}var Ue=ii.extend({options:{position:"topright"},initialize:function(_){St(this,_)},getPosition:function(){return this.options.position},setPosition:function(_){var M=this._map;return M&&M.removeControl(this),this.options.position=_,M&&M.addControl(this),this},getContainer:function(){return this._container},addTo:function(_){this.remove(),this._map=_;var M=this._container=this.onAdd(_),S=this.getPosition(),T=_._controlCorners[S];return Ht(M,"leaflet-control"),S.indexOf("bottom")!==-1?T.insertBefore(M,T.firstChild):T.appendChild(M),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(re(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(_){this._map&&_&&_.screenX>0&&_.screenY>0&&this._map.getContainer().focus()}}),Ii=function(_){return new Ue(_)};qt.include({addControl:function(_){return _.addTo(this),this},removeControl:function(_){return _.remove(),this},_initControlPos:function(){var _=this._controlCorners={},M="leaflet-",S=this._controlContainer=Yt("div",M+"control-container",this._container);function T(R,j){var Q=M+R+" "+M+j;_[R+j]=Yt("div",Q,S)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var _ in this._controlCorners)re(this._controlCorners[_]);re(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var as=Ue.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(_,M,S,T){return S<T?-1:T<S?1:0}},initialize:function(_,M,S){St(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in _)this._addLayer(_[T],T);for(T in M)this._addLayer(M[T],T,!0)},onAdd:function(_){this._initLayout(),this._update(),this._map=_,_.on("zoomend",this._checkDisabledLayers,this);for(var M=0;M<this._layers.length;M++)this._layers[M].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(_){return Ue.prototype.addTo.call(this,_),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(_,M){return this._addLayer(_,M),this._map?this._update():this},addOverlay:function(_,M){return this._addLayer(_,M,!0),this._map?this._update():this},removeLayer:function(_){_.off("add remove",this._onLayerChange,this);var M=this._getLayer(et(_));return M&&this._layers.splice(this._layers.indexOf(M),1),this._map?this._update():this},expand:function(){Ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var _=this._map.getSize().y-(this._container.offsetTop+50);return _<this._section.clientHeight?(Ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=_+"px"):ae(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ae(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var _="leaflet-control-layers",M=this._container=Yt("div",_),S=this.options.collapsed;M.setAttribute("aria-haspopup",!0),rn(M),or(M);var T=this._section=Yt("section",_+"-list");S&&(this._map.on("click",this.collapse,this),Zt(M,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var R=this._layersLink=Yt("a",_+"-toggle",M);R.href="#",R.title="Layers",R.setAttribute("role","button"),Zt(R,{keydown:function(j){j.keyCode===13&&this._expandSafely()},click:function(j){me(j),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=Yt("div",_+"-base",T),this._separator=Yt("div",_+"-separator",T),this._overlaysList=Yt("div",_+"-overlays",T),M.appendChild(T)},_getLayer:function(_){for(var M=0;M<this._layers.length;M++)if(this._layers[M]&&et(this._layers[M].layer)===_)return this._layers[M]},_addLayer:function(_,M,S){this._map&&_.on("add remove",this._onLayerChange,this),this._layers.push({layer:_,name:M,overlay:S}),this.options.sortLayers&&this._layers.sort(N(function(T,R){return this.options.sortFunction(T.layer,R.layer,T.name,R.name)},this)),this.options.autoZIndex&&_.setZIndex&&(this._lastZIndex++,_.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Qi(this._baseLayersList),Qi(this._overlaysList),this._layerControlInputs=[];var _,M,S,T,R=0;for(S=0;S<this._layers.length;S++)T=this._layers[S],this._addItem(T),M=M||T.overlay,_=_||!T.overlay,R+=T.overlay?0:1;return this.options.hideSingleBase&&(_=_&&R>1,this._baseLayersList.style.display=_?"":"none"),this._separator.style.display=M&&_?"":"none",this},_onLayerChange:function(_){this._handlingClick||this._update();var M=this._getLayer(et(_.target)),S=M.overlay?_.type==="add"?"overlayadd":"overlayremove":_.type==="add"?"baselayerchange":null;S&&this._map.fire(S,M)},_createRadioElement:function(_,M){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+_+'"'+(M?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=S,T.firstChild},_addItem:function(_){var M=document.createElement("label"),S=this._map.hasLayer(_.layer),T;_.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=S):T=this._createRadioElement("leaflet-base-layers_"+et(this),S),this._layerControlInputs.push(T),T.layerId=et(_.layer),Zt(T,"click",this._onInputClick,this);var R=document.createElement("span");R.innerHTML=" "+_.name;var j=document.createElement("span");M.appendChild(j),j.appendChild(T),j.appendChild(R);var Q=_.overlay?this._overlaysList:this._baseLayersList;return Q.appendChild(M),this._checkDisabledLayers(),M},_onInputClick:function(){if(!this._preventClick){var _=this._layerControlInputs,M,S,T=[],R=[];this._handlingClick=!0;for(var j=_.length-1;j>=0;j--)M=_[j],S=this._getLayer(M.layerId).layer,M.checked?T.push(S):M.checked||R.push(S);for(j=0;j<R.length;j++)this._map.hasLayer(R[j])&&this._map.removeLayer(R[j]);for(j=0;j<T.length;j++)this._map.hasLayer(T[j])||this._map.addLayer(T[j]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var _=this._layerControlInputs,M,S,T=this._map.getZoom(),R=_.length-1;R>=0;R--)M=_[R],S=this._getLayer(M.layerId).layer,M.disabled=S.options.minZoom!==void 0&&T<S.options.minZoom||S.options.maxZoom!==void 0&&T>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var _=this._section;this._preventClick=!0,Zt(_,"click",me),this.expand();var M=this;setTimeout(function(){Jt(_,"click",me),M._preventClick=!1})}}),ur=function(_,M,S){return new as(_,M,S)},zi=Ue.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(_){var M="leaflet-control-zoom",S=Yt("div",M+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,M+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,M+"-out",S,this._zoomOut),this._updateDisabled(),_.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(_){_.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(_){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(_.shiftKey?3:1))},_zoomOut:function(_){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(_.shiftKey?3:1))},_createButton:function(_,M,S,T,R){var j=Yt("a",S,T);return j.innerHTML=_,j.href="#",j.title=M,j.setAttribute("role","button"),j.setAttribute("aria-label",M),rn(j),Zt(j,"click",xi),Zt(j,"click",R,this),Zt(j,"click",this._refocusOnMap,this),j},_updateDisabled:function(){var _=this._map,M="leaflet-disabled";ae(this._zoomInButton,M),ae(this._zoomOutButton,M),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||_._zoom===_.getMinZoom())&&(Ht(this._zoomOutButton,M),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||_._zoom===_.getMaxZoom())&&(Ht(this._zoomInButton,M),this._zoomInButton.setAttribute("aria-disabled","true"))}});qt.mergeOptions({zoomControl:!0}),qt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zi,this.addControl(this.zoomControl))});var ga=function(_){return new zi(_)},ri=Ue.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(_){var M="leaflet-control-scale",S=Yt("div",M),T=this.options;return this._addScales(T,M+"-line",S),_.on(T.updateWhenIdle?"moveend":"move",this._update,this),_.whenReady(this._update,this),S},onRemove:function(_){_.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(_,M,S){_.metric&&(this._mScale=Yt("div",M,S)),_.imperial&&(this._iScale=Yt("div",M,S))},_update:function(){var _=this._map,M=_.getSize().y/2,S=_.distance(_.containerPointToLatLng([0,M]),_.containerPointToLatLng([this.options.maxWidth,M]));this._updateScales(S)},_updateScales:function(_){this.options.metric&&_&&this._updateMetric(_),this.options.imperial&&_&&this._updateImperial(_)},_updateMetric:function(_){var M=this._getRoundNum(_),S=M<1e3?M+" m":M/1e3+" km";this._updateScale(this._mScale,S,M/_)},_updateImperial:function(_){var M=_*3.2808399,S,T,R;M>5280?(S=M/5280,T=this._getRoundNum(S),this._updateScale(this._iScale,T+" mi",T/S)):(R=this._getRoundNum(M),this._updateScale(this._iScale,R+" ft",R/M))},_updateScale:function(_,M,S){_.style.width=Math.round(this.options.maxWidth*S)+"px",_.innerHTML=M},_getRoundNum:function(_){var M=Math.pow(10,(Math.floor(_)+"").length-1),S=_/M;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,M*S}}),os=function(_){return new ri(_)},Ni='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',lr=Ue.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Rt.inlineSvg?Ni+" ":"")+"Leaflet</a>"},initialize:function(_){St(this,_),this._attributions={}},onAdd:function(_){_.attributionControl=this,this._container=Yt("div","leaflet-control-attribution"),rn(this._container);for(var M in _._layers)_._layers[M].getAttribution&&this.addAttribution(_._layers[M].getAttribution());return this._update(),_.on("layeradd",this._addAttribution,this),this._container},onRemove:function(_){_.off("layeradd",this._addAttribution,this)},_addAttribution:function(_){_.layer.getAttribution&&(this.addAttribution(_.layer.getAttribution()),_.layer.once("remove",function(){this.removeAttribution(_.layer.getAttribution())},this))},setPrefix:function(_){return this.options.prefix=_,this._update(),this},addAttribution:function(_){return _?(this._attributions[_]||(this._attributions[_]=0),this._attributions[_]++,this._update(),this):this},removeAttribution:function(_){return _?(this._attributions[_]&&(this._attributions[_]--,this._update()),this):this},_update:function(){if(this._map){var _=[];for(var M in this._attributions)this._attributions[M]&&_.push(M);var S=[];this.options.prefix&&S.push(this.options.prefix),_.length&&S.push(_.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});qt.mergeOptions({attributionControl:!0}),qt.addInitHook(function(){this.options.attributionControl&&new lr().addTo(this)});var ya=function(_){return new lr(_)};Ue.Layers=as,Ue.Zoom=zi,Ue.Scale=ri,Ue.Attribution=lr,Ii.layers=ur,Ii.zoom=ga,Ii.scale=os,Ii.attribution=ya;var Ke=ii.extend({initialize:function(_){this._map=_},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ke.addTo=function(_,M){return _.addHandler(M,this),this};var va={Events:De},us=Rt.touch?"touchstart mousedown":"mousedown",di=Yi.extend({options:{clickTolerance:3},initialize:function(_,M,S,T){St(this,T),this._element=_,this._dragStartTarget=M||_,this._preventOutline=S},enable:function(){this._enabled||(Zt(this._dragStartTarget,us,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(di._dragging===this&&this.finishDrag(!0),Jt(this._dragStartTarget,us,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(_){if(this._enabled&&(this._moved=!1,!Jn(this._element,"leaflet-zoom-anim"))){if(_.touches&&_.touches.length!==1){di._dragging===this&&this.finishDrag();return}if(!(di._dragging||_.shiftKey||_.which!==1&&_.button!==1&&!_.touches)&&(di._dragging=this,this._preventOutline&&ir(this._element),Qn(),tn(),!this._moving)){this.fire("down");var M=_.touches?_.touches[0]:_,S=es(this._element);this._startPoint=new Gt(M.clientX,M.clientY),this._startPos=ci(this._element),this._parentScale=nr(S);var T=_.type==="mousedown";Zt(document,T?"mousemove":"touchmove",this._onMove,this),Zt(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(_){if(this._enabled){if(_.touches&&_.touches.length>1){this._moved=!0;return}var M=_.touches&&_.touches.length===1?_.touches[0]:_,S=new Gt(M.clientX,M.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,me(_),this._moved||(this.fire("dragstart"),this._moved=!0,Ht(document.body,"leaflet-dragging"),this._lastTarget=_.target||_.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=_,this._updatePosition())}},_updatePosition:function(){var _={originalEvent:this._lastEvent};this.fire("predrag",_),he(this._element,this._newPos),this.fire("drag",_)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(_){ae(document.body,"leaflet-dragging"),this._lastTarget&&(ae(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Jt(document,"mousemove touchmove",this._onMove,this),Jt(document,"mouseup touchend touchcancel",this._onUp,this),tr(),en();var M=this._moved&&this._moving;this._moving=!1,di._dragging=!1,M&&this.fire("dragend",{noInertia:_,distance:this._newPos.distanceTo(this._startPos)})}});function ls(_,M,S){var T,R=[1,4,2,8],j,Q,dt,gt,Mt,Dt,It,Vt;for(j=0,Dt=_.length;j<Dt;j++)_[j]._code=pi(_[j],M);for(dt=0;dt<4;dt++){for(It=R[dt],T=[],j=0,Dt=_.length,Q=Dt-1;j<Dt;Q=j++)gt=_[j],Mt=_[Q],gt._code&It?Mt._code&It||(Vt=kn(Mt,gt,It,M,S),Vt._code=pi(Vt,M),T.push(Vt)):(Mt._code&It&&(Vt=kn(Mt,gt,It,M,S),Vt._code=pi(Vt,M),T.push(Vt)),T.push(gt));_=T}return _}function hs(_,M){var S,T,R,j,Q,dt,gt,Mt,Dt;if(!_||_.length===0)throw new Error("latlngs not passed");ze(_)||(console.warn("latlngs are not flat! Only the first ring will be used"),_=_[0]);var It=Kt([0,0]),Vt=le(_),be=Vt.getNorthWest().distanceTo(Vt.getSouthWest())*Vt.getNorthEast().distanceTo(Vt.getNorthWest());be<1700&&(It=hr(_));var _e=_.length,Ze=[];for(S=0;S<_e;S++){var Pe=Kt(_[S]);Ze.push(M.project(Kt([Pe.lat-It.lat,Pe.lng-It.lng])))}for(dt=gt=Mt=0,S=0,T=_e-1;S<_e;T=S++)R=Ze[S],j=Ze[T],Q=R.y*j.x-j.y*R.x,gt+=(R.x+j.x)*Q,Mt+=(R.y+j.y)*Q,dt+=Q*3;dt===0?Dt=Ze[0]:Dt=[gt/dt,Mt/dt];var mi=M.unproject(zt(Dt));return Kt([mi.lat+It.lat,mi.lng+It.lng])}function hr(_){for(var M=0,S=0,T=0,R=0;R<_.length;R++){var j=Kt(_[R]);M+=j.lat,S+=j.lng,T++}return Kt([M/T,S/T])}var cs={__proto__:null,clipPolygon:ls,polygonCenter:hs,centroid:hr};function ds(_,M){if(!M||!_.length)return _.slice();var S=M*M;return _=Gi(_,S),_=La(_,S),_}function fe(_,M,S){return Math.sqrt(ji(_,M,S,!0))}function Te(_,M,S){return ji(_,M,S)}function La(_,M){var S=_.length,T=typeof Uint8Array<"u"?Uint8Array:Array,R=new T(S);R[0]=R[S-1]=1,We(_,R,M,0,S-1);var j,Q=[];for(j=0;j<S;j++)R[j]&&Q.push(_[j]);return Q}function We(_,M,S,T,R){var j=0,Q,dt,gt;for(dt=T+1;dt<=R-1;dt++)gt=ji(_[dt],_[T],_[R],!0),gt>j&&(Q=dt,j=gt);j>S&&(M[Q]=1,We(_,M,S,T,Q),We(_,M,S,Q,R))}function Gi(_,M){for(var S=[_[0]],T=1,R=0,j=_.length;T<j;T++)Zi(_[T],_[R])>M&&(S.push(_[T]),R=T);return R<j-1&&S.push(_[j-1]),S}var an;function Ie(_,M,S,T,R){var j=T?an:pi(_,S),Q=pi(M,S),dt,gt,Mt;for(an=Q;;){if(!(j|Q))return[_,M];if(j&Q)return!1;dt=j||Q,gt=kn(_,M,dt,S,R),Mt=pi(gt,S),dt===j?(_=gt,j=Mt):(M=gt,Q=Mt)}}function kn(_,M,S,T,R){var j=M.x-_.x,Q=M.y-_.y,dt=T.min,gt=T.max,Mt,Dt;return S&8?(Mt=_.x+j*(gt.y-_.y)/Q,Dt=gt.y):S&4?(Mt=_.x+j*(dt.y-_.y)/Q,Dt=dt.y):S&2?(Mt=gt.x,Dt=_.y+Q*(gt.x-_.x)/j):S&1&&(Mt=dt.x,Dt=_.y+Q*(dt.x-_.x)/j),new Gt(Mt,Dt,R)}function pi(_,M){var S=0;return _.x<M.min.x?S|=1:_.x>M.max.x&&(S|=2),_.y<M.min.y?S|=4:_.y>M.max.y&&(S|=8),S}function Zi(_,M){var S=M.x-_.x,T=M.y-_.y;return S*S+T*T}function ji(_,M,S,T){var R=M.x,j=M.y,Q=S.x-R,dt=S.y-j,gt=Q*Q+dt*dt,Mt;return gt>0&&(Mt=((_.x-R)*Q+(_.y-j)*dt)/gt,Mt>1?(R=S.x,j=S.y):Mt>0&&(R+=Q*Mt,j+=dt*Mt)),Q=_.x-R,dt=_.y-j,T?Q*Q+dt*dt:new Gt(R,j)}function ze(_){return!ie(_[0])||typeof _[0][0]!="object"&&typeof _[0][0]<"u"}function ps(_){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ze(_)}function fs(_,M){var S,T,R,j,Q,dt,gt,Mt;if(!_||_.length===0)throw new Error("latlngs not passed");ze(_)||(console.warn("latlngs are not flat! Only the first ring will be used"),_=_[0]);var Dt=Kt([0,0]),It=le(_),Vt=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());Vt<1700&&(Dt=hr(_));var be=_.length,_e=[];for(S=0;S<be;S++){var Ze=Kt(_[S]);_e.push(M.project(Kt([Ze.lat-Dt.lat,Ze.lng-Dt.lng])))}for(S=0,T=0;S<be-1;S++)T+=_e[S].distanceTo(_e[S+1])/2;if(T===0)Mt=_e[0];else for(S=0,j=0;S<be-1;S++)if(Q=_e[S],dt=_e[S+1],R=Q.distanceTo(dt),j+=R,j>T){gt=(j-T)/R,Mt=[dt.x-gt*(dt.x-Q.x),dt.y-gt*(dt.y-Q.y)];break}var Pe=M.unproject(zt(Mt));return Kt([Pe.lat+Dt.lat,Pe.lng+Dt.lng])}var Mn={__proto__:null,simplify:ds,pointToSegmentDistance:fe,closestPointOnSegment:Te,clipSegment:Ie,_getEdgeIntersection:kn,_getBitCode:pi,_sqClosestPointOnSegment:ji,isFlat:ze,_flat:ps,polylineCenter:fs},wn={project:function(_){return new Gt(_.lng,_.lat)},unproject:function(_){return new Qt(_.y,_.x)},bounds:new ne([-180,-90],[180,90])},cr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ne([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(_){var M=Math.PI/180,S=this.R,T=_.lat*M,R=this.R_MINOR/S,j=Math.sqrt(1-R*R),Q=j*Math.sin(T),dt=Math.tan(Math.PI/4-T/2)/Math.pow((1-Q)/(1+Q),j/2);return T=-S*Math.log(Math.max(dt,1e-10)),new Gt(_.lng*M*S,T)},unproject:function(_){for(var M=180/Math.PI,S=this.R,T=this.R_MINOR/S,R=Math.sqrt(1-T*T),j=Math.exp(-_.y/S),Q=Math.PI/2-2*Math.atan(j),dt=0,gt=.1,Mt;dt<15&&Math.abs(gt)>1e-7;dt++)Mt=R*Math.sin(Q),Mt=Math.pow((1-Mt)/(1+Mt),R/2),gt=Math.PI/2-2*Math.atan(j*Mt)-Q,Q+=gt;return new Qt(Q*M,_.x*M/S)}},_s={__proto__:null,LonLat:wn,Mercator:cr,SphericalMercator:zn},Ca=lt({},li,{code:"EPSG:3395",projection:cr,transformation:(function(){var _=.5/(Math.PI*cr.R);return Xi(_,.5,-_,.5)})()}),dr=lt({},li,{code:"EPSG:4326",projection:wn,transformation:Xi(1/180,1,-1/180,.5)}),ba=lt({},ni,{projection:wn,transformation:Xi(1,0,-1,0),scale:function(_){return Math.pow(2,_)},zoom:function(_){return Math.log(_)/Math.LN2},distance:function(_,M){var S=M.lng-_.lng,T=M.lat-_.lat;return Math.sqrt(S*S+T*T)},infinite:!0});ni.Earth=li,ni.EPSG3395=Ca,ni.EPSG3857=Gn,ni.EPSG900913=Sr,ni.EPSG4326=dr,ni.Simple=ba;var Be=Yi.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(_){return _.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(_){return _&&_.removeLayer(this),this},getPane:function(_){return this._map.getPane(_?this.options[_]||_:this.options.pane)},addInteractiveTarget:function(_){return this._map._targets[et(_)]=this,this},removeInteractiveTarget:function(_){return delete this._map._targets[et(_)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(_){var M=_.target;if(M.hasLayer(this)){if(this._map=M,this._zoomAnimated=M._zoomAnimated,this.getEvents){var S=this.getEvents();M.on(S,this),this.once("remove",function(){M.off(S,this)},this)}this.onAdd(M),this.fire("add"),M.fire("layeradd",{layer:this})}}});qt.include({addLayer:function(_){if(!_._layerAdd)throw new Error("The provided object is not a Layer.");var M=et(_);return this._layers[M]?this:(this._layers[M]=_,_._mapToAdd=this,_.beforeAdd&&_.beforeAdd(this),this.whenReady(_._layerAdd,_),this)},removeLayer:function(_){var M=et(_);return this._layers[M]?(this._loaded&&_.onRemove(this),delete this._layers[M],this._loaded&&(this.fire("layerremove",{layer:_}),_.fire("remove")),_._map=_._mapToAdd=null,this):this},hasLayer:function(_){return et(_)in this._layers},eachLayer:function(_,M){for(var S in this._layers)_.call(M,this._layers[S]);return this},_addLayers:function(_){_=_?ie(_)?_:[_]:[];for(var M=0,S=_.length;M<S;M++)this.addLayer(_[M])},_addZoomLimit:function(_){(!isNaN(_.options.maxZoom)||!isNaN(_.options.minZoom))&&(this._zoomBoundLayers[et(_)]=_,this._updateZoomLevels())},_removeZoomLimit:function(_){var M=et(_);this._zoomBoundLayers[M]&&(delete this._zoomBoundLayers[M],this._updateZoomLevels())},_updateZoomLevels:function(){var _=1/0,M=-1/0,S=this._getZoomSpan();for(var T in this._zoomBoundLayers){var R=this._zoomBoundLayers[T].options;_=R.minZoom===void 0?_:Math.min(_,R.minZoom),M=R.maxZoom===void 0?M:Math.max(M,R.maxZoom)}this._layersMaxZoom=M===-1/0?void 0:M,this._layersMinZoom=_===1/0?void 0:_,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var si=Be.extend({initialize:function(_,M){St(this,M),this._layers={};var S,T;if(_)for(S=0,T=_.length;S<T;S++)this.addLayer(_[S])},addLayer:function(_){var M=this.getLayerId(_);return this._layers[M]=_,this._map&&this._map.addLayer(_),this},removeLayer:function(_){var M=_ in this._layers?_:this.getLayerId(_);return this._map&&this._layers[M]&&this._map.removeLayer(this._layers[M]),delete this._layers[M],this},hasLayer:function(_){var M=typeof _=="number"?_:this.getLayerId(_);return M in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(_){var M=Array.prototype.slice.call(arguments,1),S,T;for(S in this._layers)T=this._layers[S],T[_]&&T[_].apply(T,M);return this},onAdd:function(_){this.eachLayer(_.addLayer,_)},onRemove:function(_){this.eachLayer(_.removeLayer,_)},eachLayer:function(_,M){for(var S in this._layers)_.call(M,this._layers[S]);return this},getLayer:function(_){return this._layers[_]},getLayers:function(){var _=[];return this.eachLayer(_.push,_),_},setZIndex:function(_){return this.invoke("setZIndex",_)},getLayerId:function(_){return et(_)}}),En=function(_,M){return new si(_,M)},Ye=si.extend({addLayer:function(_){return this.hasLayer(_)?this:(_.addEventParent(this),si.prototype.addLayer.call(this,_),this.fire("layeradd",{layer:_}))},removeLayer:function(_){return this.hasLayer(_)?(_ in this._layers&&(_=this._layers[_]),_.removeEventParent(this),si.prototype.removeLayer.call(this,_),this.fire("layerremove",{layer:_})):this},setStyle:function(_){return this.invoke("setStyle",_)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var _=new Ee;for(var M in this._layers){var S=this._layers[M];_.extend(S.getBounds?S.getBounds():S.getLatLng())}return _}}),xa=function(_,M){return new Ye(_,M)},Ui=ii.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(_){St(this,_)},createIcon:function(_){return this._createIcon("icon",_)},createShadow:function(_){return this._createIcon("shadow",_)},_createIcon:function(_,M){var S=this._getIconUrl(_);if(!S){if(_==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(S,M&&M.tagName==="IMG"?M:null);return this._setIconStyles(T,_),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(_,M){var S=this.options,T=S[M+"Size"];typeof T=="number"&&(T=[T,T]);var R=zt(T),j=zt(M==="shadow"&&S.shadowAnchor||S.iconAnchor||R&&R.divideBy(2,!0));_.className="leaflet-marker-"+M+" "+(S.className||""),j&&(_.style.marginLeft=-j.x+"px",_.style.marginTop=-j.y+"px"),R&&(_.style.width=R.x+"px",_.style.height=R.y+"px")},_createImg:function(_,M){return M=M||document.createElement("img"),M.src=_,M},_getIconUrl:function(_){return Rt.retina&&this.options[_+"RetinaUrl"]||this.options[_+"Url"]}});function ka(_){return new Ui(_)}var on=Ui.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(_){return typeof on.imagePath!="string"&&(on.imagePath=this._detectIconPath()),(this.options.imagePath||on.imagePath)+Ui.prototype._getIconUrl.call(this,_)},_stripUrl:function(_){var M=function(S,T,R){var j=T.exec(S);return j&&j[R]};return _=M(_,/^url\((['"])?(.+)\1\)$/,2),_&&M(_,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var _=Yt("div","leaflet-default-icon-path",document.body),M=hi(_,"background-image")||hi(_,"backgroundImage");if(document.body.removeChild(_),M=this._stripUrl(M),M)return M;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),ms=Ke.extend({initialize:function(_){this._marker=_},addHooks:function(){var _=this._marker._icon;this._draggable||(this._draggable=new di(_,_,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ht(_,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ae(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(_){var M=this._marker,S=M._map,T=this._marker.options.autoPanSpeed,R=this._marker.options.autoPanPadding,j=ci(M._icon),Q=S.getPixelBounds(),dt=S.getPixelOrigin(),gt=we(Q.min._subtract(dt).add(R),Q.max._subtract(dt).subtract(R));if(!gt.contains(j)){var Mt=zt((Math.max(gt.max.x,j.x)-gt.max.x)/(Q.max.x-gt.max.x)-(Math.min(gt.min.x,j.x)-gt.min.x)/(Q.min.x-gt.min.x),(Math.max(gt.max.y,j.y)-gt.max.y)/(Q.max.y-gt.max.y)-(Math.min(gt.min.y,j.y)-gt.min.y)/(Q.min.y-gt.min.y)).multiplyBy(T);S.panBy(Mt,{animate:!1}),this._draggable._newPos._add(Mt),this._draggable._startPos._add(Mt),he(M._icon,this._draggable._newPos),this._onDrag(_),this._panRequest=ue(this._adjustPan.bind(this,_))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(_){this._marker.options.autoPan&&(Me(this._panRequest),this._panRequest=ue(this._adjustPan.bind(this,_)))},_onDrag:function(_){var M=this._marker,S=M._shadow,T=ci(M._icon),R=M._map.layerPointToLatLng(T);S&&he(S,T),M._latlng=R,_.latlng=R,_.oldLatLng=this._oldLatLng,M.fire("move",_).fire("drag",_)},_onDragEnd:function(_){Me(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",_)}}),Bn=Be.extend({options:{icon:new on,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(_,M){St(this,M),this._latlng=Kt(_)},onAdd:function(_){this._zoomAnimated=this._zoomAnimated&&_.options.markerZoomAnimation,this._zoomAnimated&&_.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(_){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&_.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(_){var M=this._latlng;return this._latlng=Kt(_),this.update(),this.fire("move",{oldLatLng:M,latlng:this._latlng})},setZIndexOffset:function(_){return this.options.zIndexOffset=_,this.update()},getIcon:function(){return this.options.icon},setIcon:function(_){return this.options.icon=_,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var _=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(_)}return this},_initIcon:function(){var _=this.options,M="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=_.icon.createIcon(this._icon),T=!1;S!==this._icon&&(this._icon&&this._removeIcon(),T=!0,_.title&&(S.title=_.title),S.tagName==="IMG"&&(S.alt=_.alt||"")),Ht(S,M),_.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,_.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Zt(S,"focus",this._panOnFocus,this);var R=_.icon.createShadow(this._shadow),j=!1;R!==this._shadow&&(this._removeShadow(),j=!0),R&&(Ht(R,M),R.alt=""),this._shadow=R,_.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),R&&j&&this.getPane(_.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Jt(this._icon,"focus",this._panOnFocus,this),re(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&re(this._shadow),this._shadow=null},_setPos:function(_){this._icon&&he(this._icon,_),this._shadow&&he(this._shadow,_),this._zIndex=_.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(_){this._icon&&(this._icon.style.zIndex=this._zIndex+_)},_animateZoom:function(_){var M=this._map._latLngToNewLayerPoint(this._latlng,_.zoom,_.center).round();this._setPos(M)},_initInteraction:function(){if(this.options.interactive&&(Ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ms)){var _=this.options.draggable;this.dragging&&(_=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ms(this),_&&this.dragging.enable()}},setOpacity:function(_){return this.options.opacity=_,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var _=this.options.opacity;this._icon&&Re(this._icon,_),this._shadow&&Re(this._shadow,_)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var _=this._map;if(_){var M=this.options.icon.options,S=M.iconSize?zt(M.iconSize):zt(0,0),T=M.iconAnchor?zt(M.iconAnchor):zt(0,0);_.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:S.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function gs(_,M){return new Bn(_,M)}var Ne=Be.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(_){this._renderer=_.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(_){return St(this,_),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&_&&Object.prototype.hasOwnProperty.call(_,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Pn=Ne.extend({options:{fill:!0,radius:10},initialize:function(_,M){St(this,M),this._latlng=Kt(_),this._radius=this.options.radius},setLatLng:function(_){var M=this._latlng;return this._latlng=Kt(_),this.redraw(),this.fire("move",{oldLatLng:M,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(_){return this.options.radius=this._radius=_,this.redraw()},getRadius:function(){return this._radius},setStyle:function(_){var M=_&&_.radius||this._radius;return Ne.prototype.setStyle.call(this,_),this.setRadius(M),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var _=this._radius,M=this._radiusY||_,S=this._clickTolerance(),T=[_+S,M+S];this._pxBounds=new ne(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(_){return _.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function pr(_,M){return new Pn(_,M)}var Hi=Pn.extend({initialize:function(_,M,S){if(typeof M=="number"&&(M=lt({},S,{radius:M})),St(this,M),this._latlng=Kt(_),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(_){return this._mRadius=_,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var _=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(_)),this._map.layerPointToLatLng(this._point.add(_)))},setStyle:Ne.prototype.setStyle,_project:function(){var _=this._latlng.lng,M=this._latlng.lat,S=this._map,T=S.options.crs;if(T.distance===li.distance){var R=Math.PI/180,j=this._mRadius/li.R/R,Q=S.project([M+j,_]),dt=S.project([M-j,_]),gt=Q.add(dt).divideBy(2),Mt=S.unproject(gt).lat,Dt=Math.acos((Math.cos(j*R)-Math.sin(M*R)*Math.sin(Mt*R))/(Math.cos(M*R)*Math.cos(Mt*R)))/R;(isNaN(Dt)||Dt===0)&&(Dt=j/Math.cos(Math.PI/180*M)),this._point=gt.subtract(S.getPixelOrigin()),this._radius=isNaN(Dt)?0:gt.x-S.project([Mt,_-Dt]).x,this._radiusY=gt.y-Q.y}else{var It=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(It).x}this._updateBounds()}});function Ma(_,M,S){return new Hi(_,M,S)}var ai=Ne.extend({options:{smoothFactor:1,noClip:!1},initialize:function(_,M){St(this,M),this._setLatLngs(_)},getLatLngs:function(){return this._latlngs},setLatLngs:function(_){return this._setLatLngs(_),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(_){for(var M=1/0,S=null,T=ji,R,j,Q=0,dt=this._parts.length;Q<dt;Q++)for(var gt=this._parts[Q],Mt=1,Dt=gt.length;Mt<Dt;Mt++){R=gt[Mt-1],j=gt[Mt];var It=T(_,R,j,!0);It<M&&(M=It,S=T(_,R,j))}return S&&(S.distance=Math.sqrt(M)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return fs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(_,M){return M=M||this._defaultShape(),_=Kt(_),M.push(_),this._bounds.extend(_),this.redraw()},_setLatLngs:function(_){this._bounds=new Ee,this._latlngs=this._convertLatLngs(_)},_defaultShape:function(){return ze(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(_){for(var M=[],S=ze(_),T=0,R=_.length;T<R;T++)S?(M[T]=Kt(_[T]),this._bounds.extend(M[T])):M[T]=this._convertLatLngs(_[T]);return M},_project:function(){var _=new ne;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,_),this._bounds.isValid()&&_.isValid()&&(this._rawPxBounds=_,this._updateBounds())},_updateBounds:function(){var _=this._clickTolerance(),M=new Gt(_,_);this._rawPxBounds&&(this._pxBounds=new ne([this._rawPxBounds.min.subtract(M),this._rawPxBounds.max.add(M)]))},_projectLatlngs:function(_,M,S){var T=_[0]instanceof Qt,R=_.length,j,Q;if(T){for(Q=[],j=0;j<R;j++)Q[j]=this._map.latLngToLayerPoint(_[j]),S.extend(Q[j]);M.push(Q)}else for(j=0;j<R;j++)this._projectLatlngs(_[j],M,S)},_clipPoints:function(){var _=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(_))){if(this.options.noClip){this._parts=this._rings;return}var M=this._parts,S,T,R,j,Q,dt,gt;for(S=0,R=0,j=this._rings.length;S<j;S++)for(gt=this._rings[S],T=0,Q=gt.length;T<Q-1;T++)dt=Ie(gt[T],gt[T+1],_,T,!0),dt&&(M[R]=M[R]||[],M[R].push(dt[0]),(dt[1]!==gt[T+1]||T===Q-2)&&(M[R].push(dt[1]),R++))}},_simplifyPoints:function(){for(var _=this._parts,M=this.options.smoothFactor,S=0,T=_.length;S<T;S++)_[S]=ds(_[S],M)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(_,M){var S,T,R,j,Q,dt,gt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(_))return!1;for(S=0,j=this._parts.length;S<j;S++)for(dt=this._parts[S],T=0,Q=dt.length,R=Q-1;T<Q;R=T++)if(!(!M&&T===0)&&fe(_,dt[R],dt[T])<=gt)return!0;return!1}});function fr(_,M){return new ai(_,M)}ai._flat=ps;var Le=ai.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return hs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(_){var M=ai.prototype._convertLatLngs.call(this,_),S=M.length;return S>=2&&M[0]instanceof Qt&&M[0].equals(M[S-1])&&M.pop(),M},_setLatLngs:function(_){ai.prototype._setLatLngs.call(this,_),ze(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ze(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var _=this._renderer._bounds,M=this.options.weight,S=new Gt(M,M);if(_=new ne(_.min.subtract(S),_.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(_))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,R=this._rings.length,j;T<R;T++)j=ls(this._rings[T],_,!0),j.length&&this._parts.push(j)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(_){var M=!1,S,T,R,j,Q,dt,gt,Mt;if(!this._pxBounds||!this._pxBounds.contains(_))return!1;for(j=0,gt=this._parts.length;j<gt;j++)for(S=this._parts[j],Q=0,Mt=S.length,dt=Mt-1;Q<Mt;dt=Q++)T=S[Q],R=S[dt],T.y>_.y!=R.y>_.y&&_.x<(R.x-T.x)*(_.y-T.y)/(R.y-T.y)+T.x&&(M=!M);return M||ai.prototype._containsPoint.call(this,_,!0)}});function _r(_,M){return new Le(_,M)}var oi=Ye.extend({initialize:function(_,M){St(this,M),this._layers={},_&&this.addData(_)},addData:function(_){var M=ie(_)?_:_.features,S,T,R;if(M){for(S=0,T=M.length;S<T;S++)R=M[S],(R.geometries||R.geometry||R.features||R.coordinates)&&this.addData(R);return this}var j=this.options;if(j.filter&&!j.filter(_))return this;var Q=un(_,j);return Q?(Q.feature=Sn(_),Q.defaultOptions=Q.options,this.resetStyle(Q),j.onEachFeature&&j.onEachFeature(_,Q),this.addLayer(Q)):this},resetStyle:function(_){return _===void 0?this.eachLayer(this.resetStyle,this):(_.options=lt({},_.defaultOptions),this._setLayerStyle(_,this.options.style),this)},setStyle:function(_){return this.eachLayer(function(M){this._setLayerStyle(M,_)},this)},_setLayerStyle:function(_,M){_.setStyle&&(typeof M=="function"&&(M=M(_.feature)),_.setStyle(M))}});function un(_,M){var S=_.type==="Feature"?_.geometry:_,T=S?S.coordinates:null,R=[],j=M&&M.pointToLayer,Q=M&&M.coordsToLatLng||mr,dt,gt,Mt,Dt;if(!T&&!S)return null;switch(S.type){case"Point":return dt=Q(T),ys(j,_,dt,M);case"MultiPoint":for(Mt=0,Dt=T.length;Mt<Dt;Mt++)dt=Q(T[Mt]),R.push(ys(j,_,dt,M));return new Ye(R);case"LineString":case"MultiLineString":return gt=Oe(T,S.type==="LineString"?0:1,Q),new ai(gt,M);case"Polygon":case"MultiPolygon":return gt=Oe(T,S.type==="Polygon"?1:2,Q),new Le(gt,M);case"GeometryCollection":for(Mt=0,Dt=S.geometries.length;Mt<Dt;Mt++){var It=un({geometry:S.geometries[Mt],type:"Feature",properties:_.properties},M);It&&R.push(It)}return new Ye(R);case"FeatureCollection":for(Mt=0,Dt=S.features.length;Mt<Dt;Mt++){var Vt=un(S.features[Mt],M);Vt&&R.push(Vt)}return new Ye(R);default:throw new Error("Invalid GeoJSON object.")}}function ys(_,M,S,T){return _?_(M,S):new Bn(S,T&&T.markersInheritOptions&&T)}function mr(_){return new Qt(_[1],_[0],_[2])}function Oe(_,M,S){for(var T=[],R=0,j=_.length,Q;R<j;R++)Q=M?Oe(_[R],M-1,S):(S||mr)(_[R]),T.push(Q);return T}function ui(_,M){return _=Kt(_),_.alt!==void 0?[kt(_.lng,M),kt(_.lat,M),kt(_.alt,M)]:[kt(_.lng,M),kt(_.lat,M)]}function ki(_,M,S,T){for(var R=[],j=0,Q=_.length;j<Q;j++)R.push(M?ki(_[j],ze(_[j])?0:M-1,S,T):ui(_[j],T));return!M&&S&&R.length>0&&R.push(R[0].slice()),R}function Mi(_,M){return _.feature?lt({},_.feature,{geometry:M}):Sn(M)}function Sn(_){return _.type==="Feature"||_.type==="FeatureCollection"?_:{type:"Feature",properties:{},geometry:_}}var gr={toGeoJSON:function(_){return Mi(this,{type:"Point",coordinates:ui(this.getLatLng(),_)})}};Bn.include(gr),Hi.include(gr),Pn.include(gr),ai.include({toGeoJSON:function(_){var M=!ze(this._latlngs),S=ki(this._latlngs,M?1:0,!1,_);return Mi(this,{type:(M?"Multi":"")+"LineString",coordinates:S})}}),Le.include({toGeoJSON:function(_){var M=!ze(this._latlngs),S=M&&!ze(this._latlngs[0]),T=ki(this._latlngs,S?2:M?1:0,!0,_);return M||(T=[T]),Mi(this,{type:(S?"Multi":"")+"Polygon",coordinates:T})}}),si.include({toMultiPoint:function(_){var M=[];return this.eachLayer(function(S){M.push(S.toGeoJSON(_).geometry.coordinates)}),Mi(this,{type:"MultiPoint",coordinates:M})},toGeoJSON:function(_){var M=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(M==="MultiPoint")return this.toMultiPoint(_);var S=M==="GeometryCollection",T=[];return this.eachLayer(function(R){if(R.toGeoJSON){var j=R.toGeoJSON(_);if(S)T.push(j.geometry);else{var Q=Sn(j);Q.type==="FeatureCollection"?T.push.apply(T,Q.features):T.push(Q)}}}),S?Mi(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function vs(_,M){return new oi(_,M)}var wa=vs,Vi=Be.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(_,M,S){this._url=_,this._bounds=le(M),St(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){re(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(_){return this.options.opacity=_,this._image&&this._updateOpacity(),this},setStyle:function(_){return _.opacity&&this.setOpacity(_.opacity),this},bringToFront:function(){return this._map&&Fi(this._image),this},bringToBack:function(){return this._map&&Ri(this._image),this},setUrl:function(_){return this._url=_,this._image&&(this._image.src=_),this},setBounds:function(_){return this._bounds=le(_),this._map&&this._reset(),this},getEvents:function(){var _={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(_.zoomanim=this._animateZoom),_},setZIndex:function(_){return this.options.zIndex=_,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var _=this._url.tagName==="IMG",M=this._image=_?this._url:Yt("img");if(Ht(M,"leaflet-image-layer"),this._zoomAnimated&&Ht(M,"leaflet-zoom-animated"),this.options.className&&Ht(M,this.options.className),M.onselectstart=ft,M.onmousemove=ft,M.onload=N(this.fire,this,"load"),M.onerror=N(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),_){this._url=M.src;return}M.src=this._url,M.alt=this.options.alt},_animateZoom:function(_){var M=this._map.getZoomScale(_.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,_.zoom,_.center).min;Ci(this._image,S,M)},_reset:function(){var _=this._image,M=new ne(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=M.getSize();he(_,M.min),_.style.width=S.x+"px",_.style.height=S.y+"px"},_updateOpacity:function(){Re(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var _=this.options.errorOverlayUrl;_&&this._url!==_&&(this._url=_,this._image.src=_)},getCenter:function(){return this._bounds.getCenter()}}),Ea=function(_,M,S){return new Vi(_,M,S)},Ls=Vi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var _=this._url.tagName==="VIDEO",M=this._image=_?this._url:Yt("video");if(Ht(M,"leaflet-image-layer"),this._zoomAnimated&&Ht(M,"leaflet-zoom-animated"),this.options.className&&Ht(M,this.options.className),M.onselectstart=ft,M.onmousemove=ft,M.onloadeddata=N(this.fire,this,"load"),_){for(var S=M.getElementsByTagName("source"),T=[],R=0;R<S.length;R++)T.push(S[R].src);this._url=S.length>0?T:[M.src];return}ie(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(M.style,"objectFit")&&(M.style.objectFit="fill"),M.autoplay=!!this.options.autoplay,M.loop=!!this.options.loop,M.muted=!!this.options.muted,M.playsInline=!!this.options.playsInline;for(var j=0;j<this._url.length;j++){var Q=Yt("source");Q.src=this._url[j],M.appendChild(Q)}}});function Ba(_,M,S){return new Ls(_,M,S)}var yr=Vi.extend({_initImage:function(){var _=this._image=this._url;Ht(_,"leaflet-image-layer"),this._zoomAnimated&&Ht(_,"leaflet-zoom-animated"),this.options.className&&Ht(_,this.options.className),_.onselectstart=ft,_.onmousemove=ft}});function Pa(_,M,S){return new yr(_,M,S)}var Je=Be.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(_,M){_&&(_ instanceof Qt||ie(_))?(this._latlng=Kt(_),St(this,M)):(St(this,_),this._source=M),this.options.content&&(this._content=this.options.content)},openOn:function(_){return _=arguments.length?_:this._source._map,_.hasLayer(this)||_.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(_){return this._map?this.close():(arguments.length?this._source=_:_=this._source,this._prepareOpen(),this.openOn(_._map)),this},onAdd:function(_){this._zoomAnimated=_._zoomAnimated,this._container||this._initLayout(),_._fadeAnimated&&Re(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),_._fadeAnimated&&Re(this._container,1),this.bringToFront(),this.options.interactive&&(Ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(_){_._fadeAnimated?(Re(this._container,0),this._removeTimeout=setTimeout(N(re,void 0,this._container),200)):re(this._container),this.options.interactive&&(ae(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(_){return this._latlng=Kt(_),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(_){return this._content=_,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var _={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(_.zoomanim=this._animateZoom),_},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fi(this._container),this},bringToBack:function(){return this._map&&Ri(this._container),this},_prepareOpen:function(_){var M=this._source;if(!M._map)return!1;if(M instanceof Ye){M=null;var S=this._source._layers;for(var T in S)if(S[T]._map){M=S[T];break}if(!M)return!1;this._source=M}if(!_)if(M.getCenter)_=M.getCenter();else if(M.getLatLng)_=M.getLatLng();else if(M.getBounds)_=M.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(_),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var _=this._contentNode,M=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof M=="string")_.innerHTML=M;else{for(;_.hasChildNodes();)_.removeChild(_.firstChild);_.appendChild(M)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var _=this._map.latLngToLayerPoint(this._latlng),M=zt(this.options.offset),S=this._getAnchor();this._zoomAnimated?he(this._container,_.add(S)):M=M.add(_).add(S);var T=this._containerBottom=-M.y,R=this._containerLeft=-Math.round(this._containerWidth/2)+M.x;this._container.style.bottom=T+"px",this._container.style.left=R+"px"}},_getAnchor:function(){return[0,0]}});qt.include({_initOverlay:function(_,M,S,T){var R=M;return R instanceof _||(R=new _(T).setContent(M)),S&&R.setLatLng(S),R}}),Be.include({_initOverlay:function(_,M,S,T){var R=S;return R instanceof _?(St(R,T),R._source=this):(R=M&&!T?M:new _(T,this),R.setContent(S)),R}});var ln=Je.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(_){return _=arguments.length?_:this._source._map,!_.hasLayer(this)&&_._popup&&_._popup.options.autoClose&&_.removeLayer(_._popup),_._popup=this,Je.prototype.openOn.call(this,_)},onAdd:function(_){Je.prototype.onAdd.call(this,_),_.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ne||this._source.on("preclick",bi))},onRemove:function(_){Je.prototype.onRemove.call(this,_),_.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ne||this._source.off("preclick",bi))},getEvents:function(){var _=Je.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(_.preclick=this.close),this.options.keepInView&&(_.moveend=this._adjustPan),_},_initLayout:function(){var _="leaflet-popup",M=this._container=Yt("div",_+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=Yt("div",_+"-content-wrapper",M);if(this._contentNode=Yt("div",_+"-content",S),rn(M),or(this._contentNode),Zt(M,"contextmenu",bi),this._tipContainer=Yt("div",_+"-tip-container",M),this._tip=Yt("div",_+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=Yt("a",_+"-close-button",M);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',Zt(T,"click",function(R){me(R),this.close()},this)}},_updateLayout:function(){var _=this._contentNode,M=_.style;M.width="",M.whiteSpace="nowrap";var S=_.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),M.width=S+1+"px",M.whiteSpace="",M.height="";var T=_.offsetHeight,R=this.options.maxHeight,j="leaflet-popup-scrolled";R&&T>R?(M.height=R+"px",Ht(_,j)):ae(_,j),this._containerWidth=this._container.offsetWidth},_animateZoom:function(_){var M=this._map._latLngToNewLayerPoint(this._latlng,_.zoom,_.center),S=this._getAnchor();he(this._container,M.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var _=this._map,M=parseInt(hi(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+M,T=this._containerWidth,R=new Gt(this._containerLeft,-S-this._containerBottom);R._add(ci(this._container));var j=_.layerPointToContainerPoint(R),Q=zt(this.options.autoPanPadding),dt=zt(this.options.autoPanPaddingTopLeft||Q),gt=zt(this.options.autoPanPaddingBottomRight||Q),Mt=_.getSize(),Dt=0,It=0;j.x+T+gt.x>Mt.x&&(Dt=j.x+T-Mt.x+gt.x),j.x-Dt-dt.x<0&&(Dt=j.x-dt.x),j.y+S+gt.y>Mt.y&&(It=j.y+S-Mt.y+gt.y),j.y-It-dt.y<0&&(It=j.y-dt.y),(Dt||It)&&(this.options.keepInView&&(this._autopanning=!0),_.fire("autopanstart").panBy([Dt,It]))}},_getAnchor:function(){return zt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Sa=function(_,M){return new ln(_,M)};qt.mergeOptions({closePopupOnClick:!0}),qt.include({openPopup:function(_,M,S){return this._initOverlay(ln,_,M,S).openOn(this),this},closePopup:function(_){return _=arguments.length?_:this._popup,_&&_.close(),this}}),Be.include({bindPopup:function(_,M){return this._popup=this._initOverlay(ln,this._popup,_,M),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(_){return this._popup&&(this instanceof Ye||(this._popup._source=this),this._popup._prepareOpen(_||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(_){return this._popup&&this._popup.setContent(_),this},getPopup:function(){return this._popup},_openPopup:function(_){if(!(!this._popup||!this._map)){xi(_);var M=_.layer||_.target;if(this._popup._source===M&&!(M instanceof Ne)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(_.latlng);return}this._popup._source=M,this.openPopup(_.latlng)}},_movePopup:function(_){this._popup.setLatLng(_.latlng)},_onKeyPress:function(_){_.originalEvent.keyCode===13&&this._openPopup(_)}});var An=Je.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(_){Je.prototype.onAdd.call(this,_),this.setOpacity(this.options.opacity),_.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(_){Je.prototype.onRemove.call(this,_),_.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var _=Je.prototype.getEvents.call(this);return this.options.permanent||(_.preclick=this.close),_},_initLayout:function(){var _="leaflet-tooltip",M=_+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Yt("div",M),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+et(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(_){var M,S,T=this._map,R=this._container,j=T.latLngToContainerPoint(T.getCenter()),Q=T.layerPointToContainerPoint(_),dt=this.options.direction,gt=R.offsetWidth,Mt=R.offsetHeight,Dt=zt(this.options.offset),It=this._getAnchor();dt==="top"?(M=gt/2,S=Mt):dt==="bottom"?(M=gt/2,S=0):dt==="center"?(M=gt/2,S=Mt/2):dt==="right"?(M=0,S=Mt/2):dt==="left"?(M=gt,S=Mt/2):Q.x<j.x?(dt="right",M=0,S=Mt/2):(dt="left",M=gt+(Dt.x+It.x)*2,S=Mt/2),_=_.subtract(zt(M,S,!0)).add(Dt).add(It),ae(R,"leaflet-tooltip-right"),ae(R,"leaflet-tooltip-left"),ae(R,"leaflet-tooltip-top"),ae(R,"leaflet-tooltip-bottom"),Ht(R,"leaflet-tooltip-"+dt),he(R,_)},_updatePosition:function(){var _=this._map.latLngToLayerPoint(this._latlng);this._setPosition(_)},setOpacity:function(_){this.options.opacity=_,this._container&&Re(this._container,_)},_animateZoom:function(_){var M=this._map._latLngToNewLayerPoint(this._latlng,_.zoom,_.center);this._setPosition(M)},_getAnchor:function(){return zt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Aa=function(_,M){return new An(_,M)};qt.include({openTooltip:function(_,M,S){return this._initOverlay(An,_,M,S).openOn(this),this},closeTooltip:function(_){return _.close(),this}}),Be.include({bindTooltip:function(_,M){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(An,this._tooltip,_,M),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(_){if(!(!_&&this._tooltipHandlersAdded)){var M=_?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[M](S),this._tooltipHandlersAdded=!_}},openTooltip:function(_){return this._tooltip&&(this instanceof Ye||(this._tooltip._source=this),this._tooltip._prepareOpen(_)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(_){return this._tooltip&&this._tooltip.setContent(_),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(_){var M=typeof _.getElement=="function"&&_.getElement();M&&(Zt(M,"focus",function(){this._tooltip._source=_,this.openTooltip()},this),Zt(M,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(_){var M=typeof _.getElement=="function"&&_.getElement();M&&M.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(_){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var M=this;this._map.once("moveend",function(){M._openOnceFlag=!1,M._openTooltip(_)});return}this._tooltip._source=_.layer||_.target,this.openTooltip(this._tooltip.options.sticky?_.latlng:void 0)}},_moveTooltip:function(_){var M=_.latlng,S,T;this._tooltip.options.sticky&&_.originalEvent&&(S=this._map.mouseEventToContainerPoint(_.originalEvent),T=this._map.containerPointToLayerPoint(S),M=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(M)}});var fi=Ui.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(_){var M=_&&_.tagName==="DIV"?_:document.createElement("div"),S=this.options;if(S.html instanceof Element?(Qi(M),M.appendChild(S.html)):M.innerHTML=S.html!==!1?S.html:"",S.bgPos){var T=zt(S.bgPos);M.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(M,"icon"),M},createShadow:function(){return null}});function hn(_){return new fi(_)}Ui.Default=on;var cn=Be.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Rt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(_){St(this,_)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(_){_._addZoomLimit(this)},onRemove:function(_){this._removeAllTiles(),re(this._container),_._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ri(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(_){return this.options.opacity=_,this._updateOpacity(),this},setZIndex:function(_){return this.options.zIndex=_,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var _=this._clampZoom(this._map.getZoom());_!==this._tileZoom&&(this._tileZoom=_,this._updateLevels()),this._update()}return this},getEvents:function(){var _={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=mt(this._onMoveEnd,this.options.updateInterval,this)),_.move=this._onMove),this._zoomAnimated&&(_.zoomanim=this._animateZoom),_},createTile:function(){return document.createElement("div")},getTileSize:function(){var _=this.options.tileSize;return _ instanceof Gt?_:new Gt(_,_)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(_){for(var M=this.getPane().children,S=-_(-1/0,1/0),T=0,R=M.length,j;T<R;T++)j=M[T].style.zIndex,M[T]!==this._container&&j&&(S=_(S,+j));isFinite(S)&&(this.options.zIndex=S+_(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Rt.ielt9){Re(this._container,this.options.opacity);var _=+new Date,M=!1,S=!1;for(var T in this._tiles){var R=this._tiles[T];if(!(!R.current||!R.loaded)){var j=Math.min(1,(_-R.loaded)/200);Re(R.el,j),j<1?M=!0:(R.active?S=!0:this._onOpaqueTile(R),R.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),M&&(Me(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this))}},_onOpaqueTile:ft,_initContainer:function(){this._container||(this._container=Yt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var _=this._tileZoom,M=this.options.maxZoom;if(_!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===_?(this._levels[S].el.style.zIndex=M-Math.abs(_-S),this._onUpdateLevel(S)):(re(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var T=this._levels[_],R=this._map;return T||(T=this._levels[_]={},T.el=Yt("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=M,T.origin=R.project(R.unproject(R.getPixelOrigin()),_).round(),T.zoom=_,this._setZoomTransform(T,R.getCenter(),R.getZoom()),ft(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:ft,_onRemoveLevel:ft,_onCreateLevel:ft,_pruneTiles:function(){if(this._map){var _,M,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(_ in this._tiles)M=this._tiles[_],M.retain=M.current;for(_ in this._tiles)if(M=this._tiles[_],M.current&&!M.active){var T=M.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(_ in this._tiles)this._tiles[_].retain||this._removeTile(_)}},_removeTilesAtZoom:function(_){for(var M in this._tiles)this._tiles[M].coords.z===_&&this._removeTile(M)},_removeAllTiles:function(){for(var _ in this._tiles)this._removeTile(_)},_invalidateAll:function(){for(var _ in this._levels)re(this._levels[_].el),this._onRemoveLevel(Number(_)),delete this._levels[_];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(_,M,S,T){var R=Math.floor(_/2),j=Math.floor(M/2),Q=S-1,dt=new Gt(+R,+j);dt.z=+Q;var gt=this._tileCoordsToKey(dt),Mt=this._tiles[gt];return Mt&&Mt.active?(Mt.retain=!0,!0):(Mt&&Mt.loaded&&(Mt.retain=!0),Q>T?this._retainParent(R,j,Q,T):!1)},_retainChildren:function(_,M,S,T){for(var R=2*_;R<2*_+2;R++)for(var j=2*M;j<2*M+2;j++){var Q=new Gt(R,j);Q.z=S+1;var dt=this._tileCoordsToKey(Q),gt=this._tiles[dt];if(gt&&gt.active){gt.retain=!0;continue}else gt&&gt.loaded&&(gt.retain=!0);S+1<T&&this._retainChildren(R,j,S+1,T)}},_resetView:function(_){var M=_&&(_.pinch||_.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),M,M)},_animateZoom:function(_){this._setView(_.center,_.zoom,!0,_.noUpdate)},_clampZoom:function(_){var M=this.options;return M.minNativeZoom!==void 0&&_<M.minNativeZoom?M.minNativeZoom:M.maxNativeZoom!==void 0&&M.maxNativeZoom<_?M.maxNativeZoom:_},_setView:function(_,M,S,T){var R=Math.round(M);this.options.maxZoom!==void 0&&R>this.options.maxZoom||this.options.minZoom!==void 0&&R<this.options.minZoom?R=void 0:R=this._clampZoom(R);var j=this.options.updateWhenZooming&&R!==this._tileZoom;(!T||j)&&(this._tileZoom=R,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),R!==void 0&&this._update(_),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(_,M)},_setZoomTransforms:function(_,M){for(var S in this._levels)this._setZoomTransform(this._levels[S],_,M)},_setZoomTransform:function(_,M,S){var T=this._map.getZoomScale(S,_.zoom),R=_.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(M,S)).round();Rt.any3d?Ci(_.el,R,T):he(_.el,R)},_resetGrid:function(){var _=this._map,M=_.options.crs,S=this._tileSize=this.getTileSize(),T=this._tileZoom,R=this._map.getPixelWorldBounds(this._tileZoom);R&&(this._globalTileRange=this._pxBoundsToTileRange(R)),this._wrapX=M.wrapLng&&!this.options.noWrap&&[Math.floor(_.project([0,M.wrapLng[0]],T).x/S.x),Math.ceil(_.project([0,M.wrapLng[1]],T).x/S.y)],this._wrapY=M.wrapLat&&!this.options.noWrap&&[Math.floor(_.project([M.wrapLat[0],0],T).y/S.x),Math.ceil(_.project([M.wrapLat[1],0],T).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(_){var M=this._map,S=M._animatingZoom?Math.max(M._animateToZoom,M.getZoom()):M.getZoom(),T=M.getZoomScale(S,this._tileZoom),R=M.project(_,this._tileZoom).floor(),j=M.getSize().divideBy(T*2);return new ne(R.subtract(j),R.add(j))},_update:function(_){var M=this._map;if(M){var S=this._clampZoom(M.getZoom());if(_===void 0&&(_=M.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(_),R=this._pxBoundsToTileRange(T),j=R.getCenter(),Q=[],dt=this.options.keepBuffer,gt=new ne(R.getBottomLeft().subtract([dt,-dt]),R.getTopRight().add([dt,-dt]));if(!(isFinite(R.min.x)&&isFinite(R.min.y)&&isFinite(R.max.x)&&isFinite(R.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Mt in this._tiles){var Dt=this._tiles[Mt].coords;(Dt.z!==this._tileZoom||!gt.contains(new Gt(Dt.x,Dt.y)))&&(this._tiles[Mt].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(_,S);return}for(var It=R.min.y;It<=R.max.y;It++)for(var Vt=R.min.x;Vt<=R.max.x;Vt++){var be=new Gt(Vt,It);if(be.z=this._tileZoom,!!this._isValidTile(be)){var _e=this._tiles[this._tileCoordsToKey(be)];_e?_e.current=!0:Q.push(be)}}if(Q.sort(function(Pe,mi){return Pe.distanceTo(j)-mi.distanceTo(j)}),Q.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ze=document.createDocumentFragment();for(Vt=0;Vt<Q.length;Vt++)this._addTile(Q[Vt],Ze);this._level.el.appendChild(Ze)}}}},_isValidTile:function(_){var M=this._map.options.crs;if(!M.infinite){var S=this._globalTileRange;if(!M.wrapLng&&(_.x<S.min.x||_.x>S.max.x)||!M.wrapLat&&(_.y<S.min.y||_.y>S.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(_);return le(this.options.bounds).overlaps(T)},_keyToBounds:function(_){return this._tileCoordsToBounds(this._keyToTileCoords(_))},_tileCoordsToNwSe:function(_){var M=this._map,S=this.getTileSize(),T=_.scaleBy(S),R=T.add(S),j=M.unproject(T,_.z),Q=M.unproject(R,_.z);return[j,Q]},_tileCoordsToBounds:function(_){var M=this._tileCoordsToNwSe(_),S=new Ee(M[0],M[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(_){return _.x+":"+_.y+":"+_.z},_keyToTileCoords:function(_){var M=_.split(":"),S=new Gt(+M[0],+M[1]);return S.z=+M[2],S},_removeTile:function(_){var M=this._tiles[_];M&&(re(M.el),delete this._tiles[_],this.fire("tileunload",{tile:M.el,coords:this._keyToTileCoords(_)}))},_initTile:function(_){Ht(_,"leaflet-tile");var M=this.getTileSize();_.style.width=M.x+"px",_.style.height=M.y+"px",_.onselectstart=ft,_.onmousemove=ft,Rt.ielt9&&this.options.opacity<1&&Re(_,this.options.opacity)},_addTile:function(_,M){var S=this._getTilePos(_),T=this._tileCoordsToKey(_),R=this.createTile(this._wrapCoords(_),N(this._tileReady,this,_));this._initTile(R),this.createTile.length<2&&ue(N(this._tileReady,this,_,null,R)),he(R,S),this._tiles[T]={el:R,coords:_,current:!0},M.appendChild(R),this.fire("tileloadstart",{tile:R,coords:_})},_tileReady:function(_,M,S){M&&this.fire("tileerror",{error:M,tile:S,coords:_});var T=this._tileCoordsToKey(_);S=this._tiles[T],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Re(S.el,0),Me(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),M||(Ht(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:_})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Rt.ielt9||!this._map._fadeAnimated?ue(this._pruneTiles,this):setTimeout(N(this._pruneTiles,this),250)))},_getTilePos:function(_){return _.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(_){var M=new Gt(this._wrapX?Lt(_.x,this._wrapX):_.x,this._wrapY?Lt(_.y,this._wrapY):_.y);return M.z=_.z,M},_pxBoundsToTileRange:function(_){var M=this.getTileSize();return new ne(_.min.unscaleBy(M).floor(),_.max.unscaleBy(M).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var _ in this._tiles)if(!this._tiles[_].loaded)return!1;return!0}});function Cs(_){return new cn(_)}var _i=cn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(_,M){this._url=_,M=St(this,M),M.detectRetina&&Rt.retina&&M.maxZoom>0?(M.tileSize=Math.floor(M.tileSize/2),M.zoomReverse?(M.zoomOffset--,M.minZoom=Math.min(M.maxZoom,M.minZoom+1)):(M.zoomOffset++,M.maxZoom=Math.max(M.minZoom,M.maxZoom-1)),M.minZoom=Math.max(0,M.minZoom)):M.zoomReverse?M.minZoom=Math.min(M.maxZoom,M.minZoom):M.maxZoom=Math.max(M.minZoom,M.maxZoom),typeof M.subdomains=="string"&&(M.subdomains=M.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(_,M){return this._url===_&&M===void 0&&(M=!0),this._url=_,M||this.redraw(),this},createTile:function(_,M){var S=document.createElement("img");return Zt(S,"load",N(this._tileOnLoad,this,M,S)),Zt(S,"error",N(this._tileOnError,this,M,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(_),S},getTileUrl:function(_){var M={r:Rt.retina?"@2x":"",s:this._getSubdomain(_),x:_.x,y:_.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-_.y;this.options.tms&&(M.y=S),M["-y"]=S}return ee(this._url,lt(M,this.options))},_tileOnLoad:function(_,M){Rt.ielt9?setTimeout(N(_,this,null,M),0):_(null,M)},_tileOnError:function(_,M,S){var T=this.options.errorTileUrl;T&&M.getAttribute("src")!==T&&(M.src=T),_(S,M)},_onTileRemove:function(_){_.tile.onload=null},_getZoomForUrl:function(){var _=this._tileZoom,M=this.options.maxZoom,S=this.options.zoomReverse,T=this.options.zoomOffset;return S&&(_=M-_),_+T},_getSubdomain:function(_){var M=Math.abs(_.x+_.y)%this.options.subdomains.length;return this.options.subdomains[M]},_abortLoading:function(){var _,M;for(_ in this._tiles)if(this._tiles[_].coords.z!==this._tileZoom&&(M=this._tiles[_].el,M.onload=ft,M.onerror=ft,!M.complete)){M.src=ke;var S=this._tiles[_].coords;re(M),delete this._tiles[_],this.fire("tileabort",{tile:M,coords:S})}},_removeTile:function(_){var M=this._tiles[_];if(M)return M.el.setAttribute("src",ke),cn.prototype._removeTile.call(this,_)},_tileReady:function(_,M,S){if(!(!this._map||S&&S.getAttribute("src")===ke))return cn.prototype._tileReady.call(this,_,M,S)}});function bs(_,M){return new _i(_,M)}var xs=_i.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(_,M){this._url=_;var S=lt({},this.defaultWmsParams);for(var T in M)T in this.options||(S[T]=M[T]);M=St(this,M);var R=M.detectRetina&&Rt.retina?2:1,j=this.getTileSize();S.width=j.x*R,S.height=j.y*R,this.wmsParams=S},onAdd:function(_){this._crs=this.options.crs||_.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var M=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[M]=this._crs.code,_i.prototype.onAdd.call(this,_)},getTileUrl:function(_){var M=this._tileCoordsToNwSe(_),S=this._crs,T=we(S.project(M[0]),S.project(M[1])),R=T.min,j=T.max,Q=(this._wmsVersion>=1.3&&this._crs===dr?[R.y,R.x,j.y,j.x]:[R.x,R.y,j.x,j.y]).join(","),dt=_i.prototype.getTileUrl.call(this,_);return dt+$t(this.wmsParams,dt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Q},setParams:function(_,M){return lt(this.wmsParams,_),M||this.redraw(),this}});function ks(_,M){return new xs(_,M)}_i.WMS=xs,bs.wms=ks;var Xe=Be.extend({options:{padding:.1},initialize:function(_){St(this,_),et(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var _={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(_.zoomanim=this._onAnimZoom),_},_onAnimZoom:function(_){this._updateTransform(_.center,_.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(_,M){var S=this._map.getZoomScale(M,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),R=this._map.project(this._center,M),j=T.multiplyBy(-S).add(R).subtract(this._map._getNewPixelOrigin(_,M));Rt.any3d?Ci(this._container,j,S):he(this._container,j)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var _ in this._layers)this._layers[_]._reset()},_onZoomEnd:function(){for(var _ in this._layers)this._layers[_]._project()},_updatePaths:function(){for(var _ in this._layers)this._layers[_]._update()},_update:function(){var _=this.options.padding,M=this._map.getSize(),S=this._map.containerPointToLayerPoint(M.multiplyBy(-_)).round();this._bounds=new ne(S,S.add(M.multiplyBy(1+_*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Dn=Xe.extend({options:{tolerance:0},getEvents:function(){var _=Xe.prototype.getEvents.call(this);return _.viewprereset=this._onViewPreReset,_},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Xe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var _=this._container=document.createElement("canvas");Zt(_,"mousemove",this._onMouseMove,this),Zt(_,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Zt(_,"mouseout",this._handleMouseOut,this),_._leaflet_disable_events=!0,this._ctx=_.getContext("2d")},_destroyContainer:function(){Me(this._redrawRequest),delete this._ctx,re(this._container),Jt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var _;this._redrawBounds=null;for(var M in this._layers)_=this._layers[M],_._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Xe.prototype._update.call(this);var _=this._bounds,M=this._container,S=_.getSize(),T=Rt.retina?2:1;he(M,_.min),M.width=T*S.x,M.height=T*S.y,M.style.width=S.x+"px",M.style.height=S.y+"px",Rt.retina&&this._ctx.scale(2,2),this._ctx.translate(-_.min.x,-_.min.y),this.fire("update")}},_reset:function(){Xe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(_){this._updateDashArray(_),this._layers[et(_)]=_;var M=_._order={layer:_,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=M),this._drawLast=M,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(_){this._requestRedraw(_)},_removePath:function(_){var M=_._order,S=M.next,T=M.prev;S?S.prev=T:this._drawLast=T,T?T.next=S:this._drawFirst=S,delete _._order,delete this._layers[et(_)],this._requestRedraw(_)},_updatePath:function(_){this._extendRedrawBounds(_),_._project(),_._update(),this._requestRedraw(_)},_updateStyle:function(_){this._updateDashArray(_),this._requestRedraw(_)},_updateDashArray:function(_){if(typeof _.options.dashArray=="string"){var M=_.options.dashArray.split(/[, ]+/),S=[],T,R;for(R=0;R<M.length;R++){if(T=Number(M[R]),isNaN(T))return;S.push(T)}_.options._dashArray=S}else _.options._dashArray=_.options.dashArray},_requestRedraw:function(_){this._map&&(this._extendRedrawBounds(_),this._redrawRequest=this._redrawRequest||ue(this._redraw,this))},_extendRedrawBounds:function(_){if(_._pxBounds){var M=(_.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ne,this._redrawBounds.extend(_._pxBounds.min.subtract([M,M])),this._redrawBounds.extend(_._pxBounds.max.add([M,M]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var _=this._redrawBounds;if(_){var M=_.getSize();this._ctx.clearRect(_.min.x,_.min.y,M.x,M.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var _,M=this._redrawBounds;if(this._ctx.save(),M){var S=M.getSize();this._ctx.beginPath(),this._ctx.rect(M.min.x,M.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)_=T.layer,(!M||_._pxBounds&&_._pxBounds.intersects(M))&&_._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(_,M){if(this._drawing){var S,T,R,j,Q=_._parts,dt=Q.length,gt=this._ctx;if(dt){for(gt.beginPath(),S=0;S<dt;S++){for(T=0,R=Q[S].length;T<R;T++)j=Q[S][T],gt[T?"lineTo":"moveTo"](j.x,j.y);M&&gt.closePath()}this._fillStroke(gt,_)}}},_updateCircle:function(_){if(!(!this._drawing||_._empty())){var M=_._point,S=this._ctx,T=Math.max(Math.round(_._radius),1),R=(Math.max(Math.round(_._radiusY),1)||T)/T;R!==1&&(S.save(),S.scale(1,R)),S.beginPath(),S.arc(M.x,M.y/R,T,0,Math.PI*2,!1),R!==1&&S.restore(),this._fillStroke(S,_)}},_fillStroke:function(_,M){var S=M.options;S.fill&&(_.globalAlpha=S.fillOpacity,_.fillStyle=S.fillColor||S.color,_.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(_.setLineDash&&_.setLineDash(M.options&&M.options._dashArray||[]),_.globalAlpha=S.opacity,_.lineWidth=S.weight,_.strokeStyle=S.color,_.lineCap=S.lineCap,_.lineJoin=S.lineJoin,_.stroke())},_onClick:function(_){for(var M=this._map.mouseEventToLayerPoint(_),S,T,R=this._drawFirst;R;R=R.next)S=R.layer,S.options.interactive&&S._containsPoint(M)&&(!(_.type==="click"||_.type==="preclick")||!this._map._draggableMoved(S))&&(T=S);this._fireEvent(T?[T]:!1,_)},_onMouseMove:function(_){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var M=this._map.mouseEventToLayerPoint(_);this._handleMouseHover(_,M)}},_handleMouseOut:function(_){var M=this._hoveredLayer;M&&(ae(this._container,"leaflet-interactive"),this._fireEvent([M],_,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(_,M){if(!this._mouseHoverThrottled){for(var S,T,R=this._drawFirst;R;R=R.next)S=R.layer,S.options.interactive&&S._containsPoint(M)&&(T=S);T!==this._hoveredLayer&&(this._handleMouseOut(_),T&&(Ht(this._container,"leaflet-interactive"),this._fireEvent([T],_,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,_),this._mouseHoverThrottled=!0,setTimeout(N(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(_,M,S){this._map._fireDOMEvent(M,S||M.type,_)},_bringToFront:function(_){var M=_._order;if(M){var S=M.next,T=M.prev;if(S)S.prev=T;else return;T?T.next=S:S&&(this._drawFirst=S),M.prev=this._drawLast,this._drawLast.next=M,M.next=null,this._drawLast=M,this._requestRedraw(_)}},_bringToBack:function(_){var M=_._order;if(M){var S=M.next,T=M.prev;if(T)T.next=S;else return;S?S.prev=T:T&&(this._drawLast=T),M.prev=null,M.next=this._drawFirst,this._drawFirst.prev=M,this._drawFirst=M,this._requestRedraw(_)}}});function vr(_){return Rt.canvas?new Dn(_):null}var wi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(_){return document.createElement("<lvml:"+_+' class="lvml">')}}catch{}return function(_){return document.createElement("<"+_+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Da={_initContainer:function(){this._container=Yt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Xe.prototype._update.call(this),this.fire("update"))},_initPath:function(_){var M=_._container=wi("shape");Ht(M,"leaflet-vml-shape "+(this.options.className||"")),M.coordsize="1 1",_._path=wi("path"),M.appendChild(_._path),this._updateStyle(_),this._layers[et(_)]=_},_addPath:function(_){var M=_._container;this._container.appendChild(M),_.options.interactive&&_.addInteractiveTarget(M)},_removePath:function(_){var M=_._container;re(M),_.removeInteractiveTarget(M),delete this._layers[et(_)]},_updateStyle:function(_){var M=_._stroke,S=_._fill,T=_.options,R=_._container;R.stroked=!!T.stroke,R.filled=!!T.fill,T.stroke?(M||(M=_._stroke=wi("stroke")),R.appendChild(M),M.weight=T.weight+"px",M.color=T.color,M.opacity=T.opacity,T.dashArray?M.dashStyle=ie(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):M.dashStyle="",M.endcap=T.lineCap.replace("butt","flat"),M.joinstyle=T.lineJoin):M&&(R.removeChild(M),_._stroke=null),T.fill?(S||(S=_._fill=wi("fill")),R.appendChild(S),S.color=T.fillColor||T.color,S.opacity=T.fillOpacity):S&&(R.removeChild(S),_._fill=null)},_updateCircle:function(_){var M=_._point.round(),S=Math.round(_._radius),T=Math.round(_._radiusY||S);this._setPath(_,_._empty()?"M0 0":"AL "+M.x+","+M.y+" "+S+","+T+" 0,"+65535*360)},_setPath:function(_,M){_._path.v=M},_bringToFront:function(_){Fi(_._container)},_bringToBack:function(_){Ri(_._container)}},Ge=Rt.vml?wi:Ar,ce=Xe.extend({_initContainer:function(){this._container=Ge("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ge("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){re(this._container),Jt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Xe.prototype._update.call(this);var _=this._bounds,M=_.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(M))&&(this._svgSize=M,S.setAttribute("width",M.x),S.setAttribute("height",M.y)),he(S,_.min),S.setAttribute("viewBox",[_.min.x,_.min.y,M.x,M.y].join(" ")),this.fire("update")}},_initPath:function(_){var M=_._path=Ge("path");_.options.className&&Ht(M,_.options.className),_.options.interactive&&Ht(M,"leaflet-interactive"),this._updateStyle(_),this._layers[et(_)]=_},_addPath:function(_){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(_._path),_.addInteractiveTarget(_._path)},_removePath:function(_){re(_._path),_.removeInteractiveTarget(_._path),delete this._layers[et(_)]},_updatePath:function(_){_._project(),_._update()},_updateStyle:function(_){var M=_._path,S=_.options;M&&(S.stroke?(M.setAttribute("stroke",S.color),M.setAttribute("stroke-opacity",S.opacity),M.setAttribute("stroke-width",S.weight),M.setAttribute("stroke-linecap",S.lineCap),M.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?M.setAttribute("stroke-dasharray",S.dashArray):M.removeAttribute("stroke-dasharray"),S.dashOffset?M.setAttribute("stroke-dashoffset",S.dashOffset):M.removeAttribute("stroke-dashoffset")):M.setAttribute("stroke","none"),S.fill?(M.setAttribute("fill",S.fillColor||S.color),M.setAttribute("fill-opacity",S.fillOpacity),M.setAttribute("fill-rule",S.fillRule||"evenodd")):M.setAttribute("fill","none"))},_updatePoly:function(_,M){this._setPath(_,Dr(_._parts,M))},_updateCircle:function(_){var M=_._point,S=Math.max(Math.round(_._radius),1),T=Math.max(Math.round(_._radiusY),1)||S,R="a"+S+","+T+" 0 1,0 ",j=_._empty()?"M0 0":"M"+(M.x-S)+","+M.y+R+S*2+",0 "+R+-S*2+",0 ";this._setPath(_,j)},_setPath:function(_,M){_._path.setAttribute("d",M)},_bringToFront:function(_){Fi(_._path)},_bringToBack:function(_){Ri(_._path)}});Rt.vml&&ce.include(Da);function Ms(_){return Rt.svg||Rt.vml?new ce(_):null}qt.include({getRenderer:function(_){var M=_.options.renderer||this._getPaneRenderer(_.options.pane)||this.options.renderer||this._renderer;return M||(M=this._renderer=this._createRenderer()),this.hasLayer(M)||this.addLayer(M),M},_getPaneRenderer:function(_){if(_==="overlayPane"||_===void 0)return!1;var M=this._paneRenderers[_];return M===void 0&&(M=this._createRenderer({pane:_}),this._paneRenderers[_]=M),M},_createRenderer:function(_){return this.options.preferCanvas&&vr(_)||Ms(_)}});var Tn=Le.extend({initialize:function(_,M){Le.prototype.initialize.call(this,this._boundsToLatLngs(_),M)},setBounds:function(_){return this.setLatLngs(this._boundsToLatLngs(_))},_boundsToLatLngs:function(_){return _=le(_),[_.getSouthWest(),_.getNorthWest(),_.getNorthEast(),_.getSouthEast()]}});function Ta(_,M){return new Tn(_,M)}ce.create=Ge,ce.pointsToPath=Dr,oi.geometryToLayer=un,oi.coordsToLatLng=mr,oi.coordsToLatLngs=Oe,oi.latLngToCoords=ui,oi.latLngsToCoords=ki,oi.getFeature=Mi,oi.asFeature=Sn,qt.mergeOptions({boxZoom:!0});var qi=Ke.extend({initialize:function(_){this._map=_,this._container=_._container,this._pane=_._panes.overlayPane,this._resetStateTimeout=0,_.on("unload",this._destroy,this)},addHooks:function(){Zt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Jt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){re(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(_){if(!_.shiftKey||_.which!==1&&_.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),tn(),Qn(),this._startPoint=this._map.mouseEventToContainerPoint(_),Zt(document,{contextmenu:xi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(_){this._moved||(this._moved=!0,this._box=Yt("div","leaflet-zoom-box",this._container),Ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(_);var M=new ne(this._point,this._startPoint),S=M.getSize();he(this._box,M.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(re(this._box),ae(this._container,"leaflet-crosshair")),en(),tr(),Jt(document,{contextmenu:xi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(_){if(!(_.which!==1&&_.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(N(this._resetState,this),0);var M=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(M).fire("boxzoomend",{boxZoomBounds:M})}},_onKeyDown:function(_){_.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});qt.addInitHook("addHandler","boxZoom",qi),qt.mergeOptions({doubleClickZoom:!0});var ws=Ke.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(_){var M=this._map,S=M.getZoom(),T=M.options.zoomDelta,R=_.originalEvent.shiftKey?S-T:S+T;M.options.doubleClickZoom==="center"?M.setZoom(R):M.setZoomAround(_.containerPoint,R)}});qt.addInitHook("addHandler","doubleClickZoom",ws),qt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Es=Ke.extend({addHooks:function(){if(!this._draggable){var _=this._map;this._draggable=new di(_._mapPane,_._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),_.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),_.on("zoomend",this._onZoomEnd,this),_.whenReady(this._onZoomEnd,this))}Ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ae(this._map._container,"leaflet-grab"),ae(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var _=this._map;if(_._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var M=le(this._map.options.maxBounds);this._offsetLimit=we(this._map.latLngToContainerPoint(M.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(M.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;_.fire("movestart").fire("dragstart"),_.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(_){if(this._map.options.inertia){var M=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(M),this._prunePositions(M)}this._map.fire("move",_).fire("drag",_)},_prunePositions:function(_){for(;this._positions.length>1&&_-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var _=this._map.getSize().divideBy(2),M=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=M.subtract(_).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(_,M){return _-(_-M)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var _=this._draggable._newPos.subtract(this._draggable._startPos),M=this._offsetLimit;_.x<M.min.x&&(_.x=this._viscousLimit(_.x,M.min.x)),_.y<M.min.y&&(_.y=this._viscousLimit(_.y,M.min.y)),_.x>M.max.x&&(_.x=this._viscousLimit(_.x,M.max.x)),_.y>M.max.y&&(_.y=this._viscousLimit(_.y,M.max.y)),this._draggable._newPos=this._draggable._startPos.add(_)}},_onPreDragWrap:function(){var _=this._worldWidth,M=Math.round(_/2),S=this._initialWorldOffset,T=this._draggable._newPos.x,R=(T-M+S)%_+M-S,j=(T+M+S)%_-M-S,Q=Math.abs(R+S)<Math.abs(j+S)?R:j;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Q},_onDragEnd:function(_){var M=this._map,S=M.options,T=!S.inertia||_.noInertia||this._times.length<2;if(M.fire("dragend",_),T)M.fire("moveend");else{this._prunePositions(+new Date);var R=this._lastPos.subtract(this._positions[0]),j=(this._lastTime-this._times[0])/1e3,Q=S.easeLinearity,dt=R.multiplyBy(Q/j),gt=dt.distanceTo([0,0]),Mt=Math.min(S.inertiaMaxSpeed,gt),Dt=dt.multiplyBy(Mt/gt),It=Mt/(S.inertiaDeceleration*Q),Vt=Dt.multiplyBy(-It/2).round();!Vt.x&&!Vt.y?M.fire("moveend"):(Vt=M._limitOffset(Vt,M.options.maxBounds),ue(function(){M.panBy(Vt,{duration:It,easeLinearity:Q,noMoveStart:!0,animate:!0})}))}}});qt.addInitHook("addHandler","dragging",Es),qt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Bs=Ke.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(_){this._map=_,this._setPanDelta(_.options.keyboardPanDelta),this._setZoomDelta(_.options.zoomDelta)},addHooks:function(){var _=this._map._container;_.tabIndex<=0&&(_.tabIndex="0"),Zt(_,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Jt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var _=document.body,M=document.documentElement,S=_.scrollTop||M.scrollTop,T=_.scrollLeft||M.scrollLeft;this._map._container.focus(),window.scrollTo(T,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(_){var M=this._panKeys={},S=this.keyCodes,T,R;for(T=0,R=S.left.length;T<R;T++)M[S.left[T]]=[-1*_,0];for(T=0,R=S.right.length;T<R;T++)M[S.right[T]]=[_,0];for(T=0,R=S.down.length;T<R;T++)M[S.down[T]]=[0,_];for(T=0,R=S.up.length;T<R;T++)M[S.up[T]]=[0,-1*_]},_setZoomDelta:function(_){var M=this._zoomKeys={},S=this.keyCodes,T,R;for(T=0,R=S.zoomIn.length;T<R;T++)M[S.zoomIn[T]]=_;for(T=0,R=S.zoomOut.length;T<R;T++)M[S.zoomOut[T]]=-_},_addHooks:function(){Zt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Jt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(_){if(!(_.altKey||_.ctrlKey||_.metaKey)){var M=_.keyCode,S=this._map,T;if(M in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(T=this._panKeys[M],_.shiftKey&&(T=zt(T).multiplyBy(3)),S.options.maxBounds&&(T=S._limitOffset(zt(T),S.options.maxBounds)),S.options.worldCopyJump){var R=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(T)));S.panTo(R)}else S.panBy(T)}else if(M in this._zoomKeys)S.setZoom(S.getZoom()+(_.shiftKey?3:1)*this._zoomKeys[M]);else if(M===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;xi(_)}}});qt.addInitHook("addHandler","keyboard",Bs),qt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ei=Ke.extend({addHooks:function(){Zt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Jt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(_){var M=rs(_),S=this._map.options.wheelDebounceTime;this._delta+=M,this._lastMousePos=this._map.mouseEventToContainerPoint(_),this._startTime||(this._startTime=+new Date);var T=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(N(this._performZoom,this),T),xi(_)},_performZoom:function(){var _=this._map,M=_.getZoom(),S=this._map.options.zoomSnap||0;_._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),R=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,j=S?Math.ceil(R/S)*S:R,Q=_._limitZoom(M+(this._delta>0?j:-j))-M;this._delta=0,this._startTime=null,Q&&(_.options.scrollWheelZoom==="center"?_.setZoom(M+Q):_.setZoomAround(this._lastMousePos,M+Q))}});qt.addInitHook("addHandler","scrollWheelZoom",Ei);var Ps=600;qt.mergeOptions({tapHold:Rt.touchNative&&Rt.safari&&Rt.mobile,tapTolerance:15});var Lr=Ke.extend({addHooks:function(){Zt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Jt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(_){if(clearTimeout(this._holdTimeout),_.touches.length===1){var M=_.touches[0];this._startPos=this._newPos=new Gt(M.clientX,M.clientY),this._holdTimeout=setTimeout(N(function(){this._cancel(),this._isTapValid()&&(Zt(document,"touchend",me),Zt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",M))},this),Ps),Zt(document,"touchend touchcancel contextmenu",this._cancel,this),Zt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function _(){Jt(document,"touchend",me),Jt(document,"touchend touchcancel",_)},_cancel:function(){clearTimeout(this._holdTimeout),Jt(document,"touchend touchcancel contextmenu",this._cancel,this),Jt(document,"touchmove",this._onMove,this)},_onMove:function(_){var M=_.touches[0];this._newPos=new Gt(M.clientX,M.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(_,M){var S=new MouseEvent(_,{bubbles:!0,cancelable:!0,view:window,screenX:M.screenX,screenY:M.screenY,clientX:M.clientX,clientY:M.clientY});S._simulated=!0,M.target.dispatchEvent(S)}});qt.addInitHook("addHandler","tapHold",Lr),qt.mergeOptions({touchZoom:Rt.touch,bounceAtZoomLimits:!0});var Cr=Ke.extend({addHooks:function(){Ht(this._map._container,"leaflet-touch-zoom"),Zt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ae(this._map._container,"leaflet-touch-zoom"),Jt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(_){var M=this._map;if(!(!_.touches||_.touches.length!==2||M._animatingZoom||this._zooming)){var S=M.mouseEventToContainerPoint(_.touches[0]),T=M.mouseEventToContainerPoint(_.touches[1]);this._centerPoint=M.getSize()._divideBy(2),this._startLatLng=M.containerPointToLatLng(this._centerPoint),M.options.touchZoom!=="center"&&(this._pinchStartLatLng=M.containerPointToLatLng(S.add(T)._divideBy(2))),this._startDist=S.distanceTo(T),this._startZoom=M.getZoom(),this._moved=!1,this._zooming=!0,M._stop(),Zt(document,"touchmove",this._onTouchMove,this),Zt(document,"touchend touchcancel",this._onTouchEnd,this),me(_)}},_onTouchMove:function(_){if(!(!_.touches||_.touches.length!==2||!this._zooming)){var M=this._map,S=M.mouseEventToContainerPoint(_.touches[0]),T=M.mouseEventToContainerPoint(_.touches[1]),R=S.distanceTo(T)/this._startDist;if(this._zoom=M.getScaleZoom(R,this._startZoom),!M.options.bounceAtZoomLimits&&(this._zoom<M.getMinZoom()&&R<1||this._zoom>M.getMaxZoom()&&R>1)&&(this._zoom=M._limitZoom(this._zoom)),M.options.touchZoom==="center"){if(this._center=this._startLatLng,R===1)return}else{var j=S._add(T)._divideBy(2)._subtract(this._centerPoint);if(R===1&&j.x===0&&j.y===0)return;this._center=M.unproject(M.project(this._pinchStartLatLng,this._zoom).subtract(j),this._zoom)}this._moved||(M._moveStart(!0,!1),this._moved=!0),Me(this._animRequest);var Q=N(M._move,M,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ue(Q,this,!0),me(_)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Me(this._animRequest),Jt(document,"touchmove",this._onTouchMove,this),Jt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});qt.addInitHook("addHandler","touchZoom",Cr),qt.BoxZoom=qi,qt.DoubleClickZoom=ws,qt.Drag=Es,qt.Keyboard=Bs,qt.ScrollWheelZoom=Ei,qt.TapHold=Lr,qt.TouchZoom=Cr,Y.Bounds=ne,Y.Browser=Rt,Y.CRS=ni,Y.Canvas=Dn,Y.Circle=Hi,Y.CircleMarker=Pn,Y.Class=ii,Y.Control=Ue,Y.DivIcon=fi,Y.DivOverlay=Je,Y.DomEvent=Wt,Y.DomUtil=_a,Y.Draggable=di,Y.Evented=Yi,Y.FeatureGroup=Ye,Y.GeoJSON=oi,Y.GridLayer=cn,Y.Handler=Ke,Y.Icon=Ui,Y.ImageOverlay=Vi,Y.LatLng=Qt,Y.LatLngBounds=Ee,Y.Layer=Be,Y.LayerGroup=si,Y.LineUtil=Mn,Y.Map=qt,Y.Marker=Bn,Y.Mixin=va,Y.Path=Ne,Y.Point=Gt,Y.PolyUtil=cs,Y.Polygon=Le,Y.Polyline=ai,Y.Popup=ln,Y.PosAnimation=ss,Y.Projection=_s,Y.Rectangle=Tn,Y.Renderer=Xe,Y.SVG=ce,Y.SVGOverlay=yr,Y.TileLayer=_i,Y.Tooltip=An,Y.Transformation=Nn,Y.Util=qs,Y.VideoOverlay=Ls,Y.bind=N,Y.bounds=we,Y.canvas=vr,Y.circle=Ma,Y.circleMarker=pr,Y.control=Ii,Y.divIcon=hn,Y.extend=lt,Y.featureGroup=xa,Y.geoJSON=vs,Y.geoJson=wa,Y.gridLayer=Cs,Y.icon=ka,Y.imageOverlay=Ea,Y.latLng=Kt,Y.latLngBounds=le,Y.layerGroup=En,Y.map=xn,Y.marker=gs,Y.point=zt,Y.polygon=_r,Y.polyline=fr,Y.popup=Sa,Y.rectangle=Ta,Y.setOptions=St,Y.stamp=et,Y.svg=Ms,Y.svgOverlay=Pa,Y.tileLayer=bs,Y.tooltip=Aa,Y.transformation=Xi,Y.version=ot,Y.videoOverlay=Ba;var Ce=window.L;Y.noConflict=function(){return window.L=Ce,this},window.L=Y}))})(leafletSrc$1,leafletSrc$1.exports)),leafletSrc$1.exports}var leafletSrcExports=requireLeafletSrc();const L$2=getDefaultExportFromCjs(leafletSrcExports),t=_mergeNamespaces({__proto__:null,default:L$2},[leafletSrcExports]);var leafletGeoman={},hasRequiredLeafletGeoman;function requireLeafletGeoman(){return hasRequiredLeafletGeoman||(hasRequiredLeafletGeoman=1,(()=>{var X=Object.create,at=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,ot=Object.getOwnPropertyNames,lt=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty,N=(C,k)=>()=>(k||C((k={exports:{}}).exports,k),k.exports),J=(C,k,B,P)=>{if(k&&typeof k=="object"||typeof k=="function")for(let A of ot(k))!z.call(C,A)&&A!==B&&at(C,A,{get:()=>k[A],enumerable:!(P=Y(k,A))||P.enumerable});return C},et=(C,k,B)=>(B=C!=null?X(lt(C)):{},J(k||!C||!C.__esModule?at(B,"default",{value:C,enumerable:!0}):B,C)),mt=N((C,k)=>{function B(){this.__data__=[],this.size=0}k.exports=B}),Lt=N((C,k)=>{function B(P,A){return P===A||P!==P&&A!==A}k.exports=B}),ft=N((C,k)=>{var B=Lt();function P(A,D){for(var O=A.length;O--;)if(B(A[O][0],D))return O;return-1}k.exports=P}),kt=N((C,k)=>{var B=ft(),P=Array.prototype,A=P.splice;function D(O){var F=this.__data__,G=B(F,O);if(G<0)return!1;var Z=F.length-1;return G==Z?F.pop():A.call(F,G,1),--this.size,!0}k.exports=D}),Ct=N((C,k)=>{var B=ft();function P(A){var D=this.__data__,O=B(D,A);return O<0?void 0:D[O][1]}k.exports=P}),Tt=N((C,k)=>{var B=ft();function P(A){return B(this.__data__,A)>-1}k.exports=P}),St=N((C,k)=>{var B=ft();function P(A,D){var O=this.__data__,F=B(O,A);return F<0?(++this.size,O.push([A,D])):O[F][1]=D,this}k.exports=P}),$t=N((C,k)=>{var B=mt(),P=kt(),A=Ct(),D=Tt(),O=St();function F(G){var Z=-1,W=G==null?0:G.length;for(this.clear();++Z<W;){var V=G[Z];this.set(V[0],V[1])}}F.prototype.clear=B,F.prototype.delete=P,F.prototype.get=A,F.prototype.has=D,F.prototype.set=O,k.exports=F}),Ut=N((C,k)=>{var B=$t();function P(){this.__data__=new B,this.size=0}k.exports=P}),ee=N((C,k)=>{function B(P){var A=this.__data__,D=A.delete(P);return this.size=A.size,D}k.exports=B}),ie=N((C,k)=>{function B(P){return this.__data__.get(P)}k.exports=B}),ei=N((C,k)=>{function B(P){return this.__data__.has(P)}k.exports=B}),ke=N((C,k)=>{var B=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;k.exports=B}),Ve=N((C,k)=>{var B=ke(),P=typeof self=="object"&&self&&self.Object===Object&&self,A=B||P||Function("return this")();k.exports=A}),pn=N((C,k)=>{var B=Ve(),P=B.Symbol;k.exports=P}),Pr=N((C,k)=>{var B=pn(),P=Object.prototype,A=P.hasOwnProperty,D=P.toString,O=B?B.toStringTag:void 0;function F(G){var Z=A.call(G,O),W=G[O];try{G[O]=void 0;var V=!0}catch{}var rt=D.call(G);return V&&(Z?G[O]=W:delete G[O]),rt}k.exports=F}),Rn=N((C,k)=>{var B=Object.prototype,P=B.toString;function A(D){return P.call(D)}k.exports=A}),Si=N((C,k)=>{var B=pn(),P=Pr(),A=Rn(),D="[object Null]",O="[object Undefined]",F=B?B.toStringTag:void 0;function G(Z){return Z==null?Z===void 0?O:D:F&&F in Object(Z)?P(Z):A(Z)}k.exports=G}),ue=N((C,k)=>{function B(P){var A=typeof P;return P!=null&&(A=="object"||A=="function")}k.exports=B}),Me=N((C,k)=>{var B=Si(),P=ue(),A="[object AsyncFunction]",D="[object Function]",O="[object GeneratorFunction]",F="[object Proxy]";function G(Z){if(!P(Z))return!1;var W=B(Z);return W==D||W==O||W==A||W==F}k.exports=G}),qs=N((C,k)=>{var B=Ve(),P=B["__core-js_shared__"];k.exports=P}),ii=N((C,k)=>{var B=qs(),P=(function(){var D=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""})();function A(D){return!!P&&P in D}k.exports=A}),Ks=N((C,k)=>{var B=Function.prototype,P=B.toString;function A(D){if(D!=null){try{return P.call(D)}catch{}try{return D+""}catch{}}return""}k.exports=A}),De=N((C,k)=>{var B=Me(),P=ii(),A=ue(),D=Ks(),O=/[\\^$.*+?()[\]{}|]/g,F=/^\[object .+?Constructor\]$/,G=Function.prototype,Z=Object.prototype,W=G.toString,V=Z.hasOwnProperty,rt=RegExp("^"+W.call(V).replace(O,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function st(vt){if(!A(vt)||P(vt))return!1;var bt=B(vt)?rt:F;return bt.test(D(vt))}k.exports=st}),Yi=N((C,k)=>{function B(P,A){return P?.[A]}k.exports=B}),Gt=N((C,k)=>{var B=De(),P=Yi();function A(D,O){var F=P(D,O);return B(F)?F:void 0}k.exports=A}),In=N((C,k)=>{var B=Gt(),P=Ve(),A=B(P,"Map");k.exports=A}),zt=N((C,k)=>{var B=Gt(),P=B(Object,"create");k.exports=P}),ne=N((C,k)=>{var B=zt();function P(){this.__data__=B?B(null):{},this.size=0}k.exports=P}),we=N((C,k)=>{function B(P){var A=this.has(P)&&delete this.__data__[P];return this.size-=A?1:0,A}k.exports=B}),Ee=N((C,k)=>{var B=zt(),P="__lodash_hash_undefined__",A=Object.prototype,D=A.hasOwnProperty;function O(F){var G=this.__data__;if(B){var Z=G[F];return Z===P?void 0:Z}return D.call(G,F)?G[F]:void 0}k.exports=O}),le=N((C,k)=>{var B=zt(),P=Object.prototype,A=P.hasOwnProperty;function D(O){var F=this.__data__;return B?F[O]!==void 0:A.call(F,O)}k.exports=D}),Qt=N((C,k)=>{var B=zt(),P="__lodash_hash_undefined__";function A(D,O){var F=this.__data__;return this.size+=this.has(D)?0:1,F[D]=B&&O===void 0?P:O,this}k.exports=A}),Kt=N((C,k)=>{var B=ne(),P=we(),A=Ee(),D=le(),O=Qt();function F(G){var Z=-1,W=G==null?0:G.length;for(this.clear();++Z<W;){var V=G[Z];this.set(V[0],V[1])}}F.prototype.clear=B,F.prototype.delete=P,F.prototype.get=A,F.prototype.has=D,F.prototype.set=O,k.exports=F}),ni=N((C,k)=>{var B=Kt(),P=$t(),A=In();function D(){this.size=0,this.__data__={hash:new B,map:new(A||P),string:new B}}k.exports=D}),li=N((C,k)=>{function B(P){var A=typeof P;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?P!=="__proto__":P===null}k.exports=B}),Ji=N((C,k)=>{var B=li();function P(A,D){var O=A.__data__;return B(D)?O[typeof D=="string"?"string":"hash"]:O.map}k.exports=P}),zn=N((C,k)=>{var B=Ji();function P(A){var D=B(this,A).delete(A);return this.size-=D?1:0,D}k.exports=P}),Nn=N((C,k)=>{var B=Ji();function P(A){return B(this,A).get(A)}k.exports=P}),Xi=N((C,k)=>{var B=Ji();function P(A){return B(this,A).has(A)}k.exports=P}),Gn=N((C,k)=>{var B=Ji();function P(A,D){var O=B(this,A),F=O.size;return O.set(A,D),this.size+=O.size==F?0:1,this}k.exports=P}),Sr=N((C,k)=>{var B=ni(),P=zn(),A=Nn(),D=Xi(),O=Gn();function F(G){var Z=-1,W=G==null?0:G.length;for(this.clear();++Z<W;){var V=G[Z];this.set(V[0],V[1])}}F.prototype.clear=B,F.prototype.delete=P,F.prototype.get=A,F.prototype.has=D,F.prototype.set=O,k.exports=F}),Ar=N((C,k)=>{var B=$t(),P=In(),A=Sr(),D=200;function O(F,G){var Z=this.__data__;if(Z instanceof B){var W=Z.__data__;if(!P||W.length<D-1)return W.push([F,G]),this.size=++Z.size,this;Z=this.__data__=new A(W)}return Z.set(F,G),this.size=Z.size,this}k.exports=O}),Dr=N((C,k)=>{var B=$t(),P=Ut(),A=ee(),D=ie(),O=ei(),F=Ar();function G(Z){var W=this.__data__=new B(Z);this.size=W.size}G.prototype.clear=P,G.prototype.delete=A,G.prototype.get=D,G.prototype.has=O,G.prototype.set=F,k.exports=G}),fn=N((C,k)=>{var B=Gt(),P=(function(){try{var A=B(Object,"defineProperty");return A({},"",{}),A}catch{}})();k.exports=P}),Ai=N((C,k)=>{var B=fn();function P(A,D,O){D=="__proto__"&&B?B(A,D,{configurable:!0,enumerable:!0,value:O,writable:!0}):A[D]=O}k.exports=P}),Tr=N((C,k)=>{var B=Ai(),P=Lt();function A(D,O,F){(F!==void 0&&!P(D[O],F)||F===void 0&&!(O in D))&&B(D,O,F)}k.exports=A}),Or=N((C,k)=>{function B(P){return function(A,D,O){for(var F=-1,G=Object(A),Z=O(A),W=Z.length;W--;){var V=Z[P?W:++F];if(D(G[V],V,G)===!1)break}return A}}k.exports=B}),Zn=N((C,k)=>{var B=Or(),P=B();k.exports=P}),Fr=N((C,k)=>{var B=Ve(),P=typeof C=="object"&&C&&!C.nodeType&&C,A=P&&typeof k=="object"&&k&&!k.nodeType&&k,D=A&&A.exports===P,O=D?B.Buffer:void 0,F=O?O.allocUnsafe:void 0;function G(Z,W){if(W)return Z.slice();var V=Z.length,rt=F?F(V):new Z.constructor(V);return Z.copy(rt),rt}k.exports=G}),Rr=N((C,k)=>{var B=Ve(),P=B.Uint8Array;k.exports=P}),Ws=N((C,k)=>{var B=Rr();function P(A){var D=new A.constructor(A.byteLength);return new B(D).set(new B(A)),D}k.exports=P}),Ys=N((C,k)=>{var B=Ws();function P(A,D){var O=D?B(A.buffer):A.buffer;return new A.constructor(O,A.byteOffset,A.length)}k.exports=P}),jn=N((C,k)=>{function B(P,A){var D=-1,O=P.length;for(A||(A=Array(O));++D<O;)A[D]=P[D];return A}k.exports=B}),Ir=N((C,k)=>{var B=ue(),P=Object.create,A=(function(){function D(){}return function(O){if(!B(O))return{};if(P)return P(O);D.prototype=O;var F=new D;return D.prototype=void 0,F}})();k.exports=A}),zr=N((C,k)=>{function B(P,A){return function(D){return P(A(D))}}k.exports=B}),Nr=N((C,k)=>{var B=zr(),P=B(Object.getPrototypeOf,Object);k.exports=P}),Un=N((C,k)=>{var B=Object.prototype;function P(A){var D=A&&A.constructor,O=typeof D=="function"&&D.prototype||B;return A===O}k.exports=P}),Gr=N((C,k)=>{var B=Ir(),P=Nr(),A=Un();function D(O){return typeof O.constructor=="function"&&!A(O)?B(P(O)):{}}k.exports=D}),Di=N((C,k)=>{function B(P){return P!=null&&typeof P=="object"}k.exports=B}),Zr=N((C,k)=>{var B=Si(),P=Di(),A="[object Arguments]";function D(O){return P(O)&&B(O)==A}k.exports=D}),_n=N((C,k)=>{var B=Zr(),P=Di(),A=Object.prototype,D=A.hasOwnProperty,O=A.propertyIsEnumerable,F=B((function(){return arguments})())?B:function(G){return P(G)&&D.call(G,"callee")&&!O.call(G,"callee")};k.exports=F}),Ti=N((C,k)=>{var B=Array.isArray;k.exports=B}),jr=N((C,k)=>{var B=9007199254740991;function P(A){return typeof A=="number"&&A>-1&&A%1==0&&A<=B}k.exports=P}),Li=N((C,k)=>{var B=Me(),P=jr();function A(D){return D!=null&&P(D.length)&&!B(D)}k.exports=A}),Js=N((C,k)=>{var B=Li(),P=Di();function A(D){return P(D)&&B(D)}k.exports=A}),Xs=N((C,k)=>{function B(){return!1}k.exports=B}),Hn=N((C,k)=>{var B=Ve(),P=Xs(),A=typeof C=="object"&&C&&!C.nodeType&&C,D=A&&typeof k=="object"&&k&&!k.nodeType&&k,O=D&&D.exports===A,F=O?B.Buffer:void 0,G=F?F.isBuffer:void 0,Z=G||P;k.exports=Z}),Ur=N((C,k)=>{var B=Si(),P=Nr(),A=Di(),D="[object Object]",O=Function.prototype,F=Object.prototype,G=O.toString,Z=F.hasOwnProperty,W=G.call(Object);function V(rt){if(!A(rt)||B(rt)!=D)return!1;var st=P(rt);if(st===null)return!0;var vt=Z.call(st,"constructor")&&st.constructor;return typeof vt=="function"&&vt instanceof vt&&G.call(vt)==W}k.exports=V}),Hr=N((C,k)=>{var B=Si(),P=jr(),A=Di(),D="[object Arguments]",O="[object Array]",F="[object Boolean]",G="[object Date]",Z="[object Error]",W="[object Function]",V="[object Map]",rt="[object Number]",st="[object Object]",vt="[object RegExp]",bt="[object Set]",Pt="[object String]",At="[object WeakMap]",K="[object ArrayBuffer]",ht="[object DataView]",yt="[object Float32Array]",Bt="[object Float64Array]",wt="[object Int8Array]",Et="[object Int16Array]",U="[object Int32Array]",H="[object Uint8Array]",q="[object Uint8ClampedArray]",it="[object Uint16Array]",tt="[object Uint32Array]",$={};$[yt]=$[Bt]=$[wt]=$[Et]=$[U]=$[H]=$[q]=$[it]=$[tt]=!0,$[D]=$[O]=$[K]=$[F]=$[ht]=$[G]=$[Z]=$[W]=$[V]=$[rt]=$[st]=$[vt]=$[bt]=$[Pt]=$[At]=!1;function ct(nt){return A(nt)&&P(nt.length)&&!!$[B(nt)]}k.exports=ct}),$s=N((C,k)=>{function B(P){return function(A){return P(A)}}k.exports=B}),Qs=N((C,k)=>{var B=ke(),P=typeof C=="object"&&C&&!C.nodeType&&C,A=P&&typeof k=="object"&&k&&!k.nodeType&&k,D=A&&A.exports===P,O=D&&B.process,F=(function(){try{var G=A&&A.require&&A.require("util").types;return G||O&&O.binding&&O.binding("util")}catch{}})();k.exports=F}),Vr=N((C,k)=>{var B=Hr(),P=$s(),A=Qs(),D=A&&A.isTypedArray,O=D?P(D):B;k.exports=O}),qr=N((C,k)=>{function B(P,A){if(!(A==="constructor"&&typeof P[A]=="function")&&A!="__proto__")return P[A]}k.exports=B}),ta=N((C,k)=>{var B=Ai(),P=Lt(),A=Object.prototype,D=A.hasOwnProperty;function O(F,G,Z){var W=F[G];(!(D.call(F,G)&&P(W,Z))||Z===void 0&&!(G in F))&&B(F,G,Z)}k.exports=O}),ea=N((C,k)=>{var B=ta(),P=Ai();function A(D,O,F,G){var Z=!F;F||(F={});for(var W=-1,V=O.length;++W<V;){var rt=O[W],st=G?G(F[rt],D[rt],rt,F,D):void 0;st===void 0&&(st=D[rt]),Z?P(F,rt,st):B(F,rt,st)}return F}k.exports=A}),Vn=N((C,k)=>{function B(P,A){for(var D=-1,O=Array(P);++D<P;)O[D]=A(D);return O}k.exports=B}),Kr=N((C,k)=>{var B=9007199254740991,P=/^(?:0|[1-9]\d*)$/;function A(D,O){var F=typeof D;return O=O??B,!!O&&(F=="number"||F!="symbol"&&P.test(D))&&D>-1&&D%1==0&&D<O}k.exports=A}),ia=N((C,k)=>{var B=Vn(),P=_n(),A=Ti(),D=Hn(),O=Kr(),F=Vr(),G=Object.prototype,Z=G.hasOwnProperty;function W(V,rt){var st=A(V),vt=!st&&P(V),bt=!st&&!vt&&D(V),Pt=!st&&!vt&&!bt&&F(V),At=st||vt||bt||Pt,K=At?B(V.length,String):[],ht=K.length;for(var yt in V)(rt||Z.call(V,yt))&&!(At&&(yt=="length"||bt&&(yt=="offset"||yt=="parent")||Pt&&(yt=="buffer"||yt=="byteLength"||yt=="byteOffset")||O(yt,ht)))&&K.push(yt);return K}k.exports=W}),na=N((C,k)=>{function B(P){var A=[];if(P!=null)for(var D in Object(P))A.push(D);return A}k.exports=B}),ra=N((C,k)=>{var B=ue(),P=Un(),A=na(),D=Object.prototype,O=D.hasOwnProperty;function F(G){if(!B(G))return A(G);var Z=P(G),W=[];for(var V in G)V=="constructor"&&(Z||!O.call(G,V))||W.push(V);return W}k.exports=F}),je=N((C,k)=>{var B=ia(),P=ra(),A=Li();function D(O){return A(O)?B(O,!0):P(O)}k.exports=D}),Rt=N((C,k)=>{var B=ea(),P=je();function A(D){return B(D,P(D))}k.exports=A}),Wr=N((C,k)=>{var B=Tr(),P=Fr(),A=Ys(),D=jn(),O=Gr(),F=_n(),G=Ti(),Z=Js(),W=Hn(),V=Me(),rt=ue(),st=Ur(),vt=Vr(),bt=qr(),Pt=Rt();function At(K,ht,yt,Bt,wt,Et,U){var H=bt(K,yt),q=bt(ht,yt),it=U.get(q);if(it){B(K,yt,it);return}var tt=Et?Et(H,q,yt+"",K,ht,U):void 0,$=tt===void 0;if($){var ct=G(q),nt=!ct&&W(q),ut=!ct&&!nt&&vt(q);tt=q,ct||nt||ut?G(H)?tt=H:Z(H)?tt=D(H):nt?($=!1,tt=P(q,!0)):ut?($=!1,tt=A(q,!0)):tt=[]:st(q)||F(q)?(tt=H,F(H)?tt=Pt(H):(!rt(H)||V(H))&&(tt=O(q))):$=!1}$&&(U.set(q,tt),wt(tt,q,Bt,Et,U),U.delete(q)),B(K,yt,tt)}k.exports=At}),Yr=N((C,k)=>{var B=Dr(),P=Tr(),A=Zn(),D=Wr(),O=ue(),F=je(),G=qr();function Z(W,V,rt,st,vt){W!==V&&A(V,function(bt,Pt){if(vt||(vt=new B),O(bt))D(W,V,Pt,rt,Z,st,vt);else{var At=st?st(G(W,Pt),bt,Pt+"",W,V,vt):void 0;At===void 0&&(At=bt),P(W,Pt,At)}},F)}k.exports=Z}),qn=N((C,k)=>{function B(P){return P}k.exports=B}),Jr=N((C,k)=>{function B(P,A,D){switch(D.length){case 0:return P.call(A);case 1:return P.call(A,D[0]);case 2:return P.call(A,D[0],D[1]);case 3:return P.call(A,D[0],D[1],D[2])}return P.apply(A,D)}k.exports=B}),Kn=N((C,k)=>{var B=Jr(),P=Math.max;function A(D,O,F){return O=P(O===void 0?D.length-1:O,0),function(){for(var G=arguments,Z=-1,W=P(G.length-O,0),V=Array(W);++Z<W;)V[Z]=G[O+Z];Z=-1;for(var rt=Array(O+1);++Z<O;)rt[Z]=G[Z];return rt[O]=F(V),B(D,this,rt)}}k.exports=A}),Xr=N((C,k)=>{function B(P){return function(){return P}}k.exports=B}),Oi=N((C,k)=>{var B=Xr(),P=fn(),A=qn(),D=P?function(O,F){return P(O,"toString",{configurable:!0,enumerable:!1,value:B(F),writable:!0})}:A;k.exports=D}),$r=N((C,k)=>{var B=800,P=16,A=Date.now;function D(O){var F=0,G=0;return function(){var Z=A(),W=P-(Z-G);if(G=Z,W>0){if(++F>=B)return arguments[0]}else F=0;return O.apply(void 0,arguments)}}k.exports=D}),sa=N((C,k)=>{var B=Oi(),P=$r(),A=P(B);k.exports=A}),aa=N((C,k)=>{var B=qn(),P=Kn(),A=sa();function D(O,F){return A(P(O,F,B),O+"")}k.exports=D}),oa=N((C,k)=>{var B=Lt(),P=Li(),A=Kr(),D=ue();function O(F,G,Z){if(!D(Z))return!1;var W=typeof G;return(W=="number"?P(Z)&&A(G,Z.length):W=="string"&&G in Z)?B(Z[G],F):!1}k.exports=O}),ua=N((C,k)=>{var B=aa(),P=oa();function A(D){return B(function(O,F){var G=-1,Z=F.length,W=Z>1?F[Z-1]:void 0,V=Z>2?F[2]:void 0;for(W=D.length>3&&typeof W=="function"?(Z--,W):void 0,V&&P(F[0],F[1],V)&&(W=Z<3?void 0:W,Z=1),O=Object(O);++G<Z;){var rt=F[G];rt&&D(O,rt,G,W)}return O})}k.exports=A}),mn=N((C,k)=>{var B=Yr(),P=ua(),A=P(function(D,O,F){B(D,O,F)});k.exports=A}),Wn=N((C,k)=>{var B=Si(),P=Di(),A="[object Symbol]";function D(O){return typeof O=="symbol"||P(O)&&B(O)==A}k.exports=D}),gn=N((C,k)=>{var B=Ti(),P=Wn(),A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,D=/^\w*$/;function O(F,G){if(B(F))return!1;var Z=typeof F;return Z=="number"||Z=="symbol"||Z=="boolean"||F==null||P(F)?!0:D.test(F)||!A.test(F)||G!=null&&F in Object(G)}k.exports=O}),la=N((C,k)=>{var B=Sr(),P="Expected a function";function A(D,O){if(typeof D!="function"||O!=null&&typeof O!="function")throw new TypeError(P);var F=function(){var G=arguments,Z=O?O.apply(this,G):G[0],W=F.cache;if(W.has(Z))return W.get(Z);var V=D.apply(this,G);return F.cache=W.set(Z,V)||W,V};return F.cache=new(A.Cache||B),F}A.Cache=B,k.exports=A}),ha=N((C,k)=>{var B=la(),P=500;function A(D){var O=B(D,function(G){return F.size===P&&F.clear(),G}),F=O.cache;return O}k.exports=A}),ca=N((C,k)=>{var B=ha(),P=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,A=/\\(\\)?/g,D=B(function(O){var F=[];return O.charCodeAt(0)===46&&F.push(""),O.replace(P,function(G,Z,W,V){F.push(W?V.replace(A,"$1"):Z||G)}),F});k.exports=D}),da=N((C,k)=>{function B(P,A){for(var D=-1,O=P==null?0:P.length,F=Array(O);++D<O;)F[D]=A(P[D],D,P);return F}k.exports=B}),pa=N((C,k)=>{var B=pn(),P=da(),A=Ti(),D=Wn(),O=B?B.prototype:void 0,F=O?O.toString:void 0;function G(Z){if(typeof Z=="string")return Z;if(A(Z))return P(Z,G)+"";if(D(Z))return F?F.call(Z):"";var W=Z+"";return W=="0"&&1/Z==-1/0?"-0":W}k.exports=G}),Yn=N((C,k)=>{var B=pa();function P(A){return A==null?"":B(A)}k.exports=P}),$i=N((C,k)=>{var B=Ti(),P=gn(),A=ca(),D=Yn();function O(F,G){return B(F)?F:P(F,G)?[F]:A(D(F))}k.exports=O}),Qr=N((C,k)=>{var B=Wn();function P(A){if(typeof A=="string"||B(A))return A;var D=A+"";return D=="0"&&1/A==-1/0?"-0":D}k.exports=P}),ts=N((C,k)=>{var B=$i(),P=Qr();function A(D,O){O=B(O,D);for(var F=0,G=O.length;D!=null&&F<G;)D=D[P(O[F++])];return F&&F==G?D:void 0}k.exports=A}),hi=N((C,k)=>{var B=ts();function P(A,D,O){var F=A==null?void 0:B(A,D);return F===void 0?O:F}k.exports=P}),Yt=N((C,k)=>{(function(B,P){typeof C=="object"&&typeof k<"u"?k.exports=P():(B=B||self).RBush=P()})(C,function(){function B(K,ht,yt,Bt,wt){(function Et(U,H,q,it,tt){for(;it>q;){if(it-q>600){var $=it-q+1,ct=H-q+1,nt=Math.log($),ut=.5*Math.exp(2*nt/3),_t=.5*Math.sqrt(nt*ut*($-ut)/$)*(ct-$/2<0?-1:1),pt=Math.max(q,Math.floor(H-ct*ut/$+_t)),xt=Math.min(it,Math.floor(H+($-ct)*ut/$+_t));Et(U,H,pt,xt,tt)}var Ot=U[H],Ft=q,jt=it;for(P(U,q,H),tt(U[it],Ot)>0&&P(U,q,it);Ft<jt;){for(P(U,Ft,jt),Ft++,jt--;tt(U[Ft],Ot)<0;)Ft++;for(;tt(U[jt],Ot)>0;)jt--}tt(U[q],Ot)===0?P(U,q,jt):P(U,++jt,it),jt<=H&&(q=jt+1),H<=jt&&(it=jt-1)}})(K,ht,yt||0,Bt||K.length-1,wt||A)}function P(K,ht,yt){var Bt=K[ht];K[ht]=K[yt],K[yt]=Bt}function A(K,ht){return K<ht?-1:K>ht?1:0}var D=function(K){K===void 0&&(K=9),this._maxEntries=Math.max(4,K),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function O(K,ht,yt){if(!yt)return ht.indexOf(K);for(var Bt=0;Bt<ht.length;Bt++)if(yt(K,ht[Bt]))return Bt;return-1}function F(K,ht){G(K,0,K.children.length,ht,K)}function G(K,ht,yt,Bt,wt){wt||(wt=Pt(null)),wt.minX=1/0,wt.minY=1/0,wt.maxX=-1/0,wt.maxY=-1/0;for(var Et=ht;Et<yt;Et++){var U=K.children[Et];Z(wt,K.leaf?Bt(U):U)}return wt}function Z(K,ht){return K.minX=Math.min(K.minX,ht.minX),K.minY=Math.min(K.minY,ht.minY),K.maxX=Math.max(K.maxX,ht.maxX),K.maxY=Math.max(K.maxY,ht.maxY),K}function W(K,ht){return K.minX-ht.minX}function V(K,ht){return K.minY-ht.minY}function rt(K){return(K.maxX-K.minX)*(K.maxY-K.minY)}function st(K){return K.maxX-K.minX+(K.maxY-K.minY)}function vt(K,ht){return K.minX<=ht.minX&&K.minY<=ht.minY&&ht.maxX<=K.maxX&&ht.maxY<=K.maxY}function bt(K,ht){return ht.minX<=K.maxX&&ht.minY<=K.maxY&&ht.maxX>=K.minX&&ht.maxY>=K.minY}function Pt(K){return{children:K,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function At(K,ht,yt,Bt,wt){for(var Et=[ht,yt];Et.length;)if(!((yt=Et.pop())-(ht=Et.pop())<=Bt)){var U=ht+Math.ceil((yt-ht)/Bt/2)*Bt;B(K,U,ht,yt,wt),Et.push(ht,U,U,yt)}}return D.prototype.all=function(){return this._all(this.data,[])},D.prototype.search=function(K){var ht=this.data,yt=[];if(!bt(K,ht))return yt;for(var Bt=this.toBBox,wt=[];ht;){for(var Et=0;Et<ht.children.length;Et++){var U=ht.children[Et],H=ht.leaf?Bt(U):U;bt(K,H)&&(ht.leaf?yt.push(U):vt(K,H)?this._all(U,yt):wt.push(U))}ht=wt.pop()}return yt},D.prototype.collides=function(K){var ht=this.data;if(!bt(K,ht))return!1;for(var yt=[];ht;){for(var Bt=0;Bt<ht.children.length;Bt++){var wt=ht.children[Bt],Et=ht.leaf?this.toBBox(wt):wt;if(bt(K,Et)){if(ht.leaf||vt(K,Et))return!0;yt.push(wt)}}ht=yt.pop()}return!1},D.prototype.load=function(K){if(!K||!K.length)return this;if(K.length<this._minEntries){for(var ht=0;ht<K.length;ht++)this.insert(K[ht]);return this}var yt=this._build(K.slice(),0,K.length-1,0);if(this.data.children.length)if(this.data.height===yt.height)this._splitRoot(this.data,yt);else{if(this.data.height<yt.height){var Bt=this.data;this.data=yt,yt=Bt}this._insert(yt,this.data.height-yt.height-1,!0)}else this.data=yt;return this},D.prototype.insert=function(K){return K&&this._insert(K,this.data.height-1),this},D.prototype.clear=function(){return this.data=Pt([]),this},D.prototype.remove=function(K,ht){if(!K)return this;for(var yt,Bt,wt,Et=this.data,U=this.toBBox(K),H=[],q=[];Et||H.length;){if(Et||(Et=H.pop(),Bt=H[H.length-1],yt=q.pop(),wt=!0),Et.leaf){var it=O(K,Et.children,ht);if(it!==-1)return Et.children.splice(it,1),H.push(Et),this._condense(H),this}wt||Et.leaf||!vt(Et,U)?Bt?(yt++,Et=Bt.children[yt],wt=!1):Et=null:(H.push(Et),q.push(yt),yt=0,Bt=Et,Et=Et.children[0])}return this},D.prototype.toBBox=function(K){return K},D.prototype.compareMinX=function(K,ht){return K.minX-ht.minX},D.prototype.compareMinY=function(K,ht){return K.minY-ht.minY},D.prototype.toJSON=function(){return this.data},D.prototype.fromJSON=function(K){return this.data=K,this},D.prototype._all=function(K,ht){for(var yt=[];K;)K.leaf?ht.push.apply(ht,K.children):yt.push.apply(yt,K.children),K=yt.pop();return ht},D.prototype._build=function(K,ht,yt,Bt){var wt,Et=yt-ht+1,U=this._maxEntries;if(Et<=U)return F(wt=Pt(K.slice(ht,yt+1)),this.toBBox),wt;Bt||(Bt=Math.ceil(Math.log(Et)/Math.log(U)),U=Math.ceil(Et/Math.pow(U,Bt-1))),(wt=Pt([])).leaf=!1,wt.height=Bt;var H=Math.ceil(Et/U),q=H*Math.ceil(Math.sqrt(U));At(K,ht,yt,q,this.compareMinX);for(var it=ht;it<=yt;it+=q){var tt=Math.min(it+q-1,yt);At(K,it,tt,H,this.compareMinY);for(var $=it;$<=tt;$+=H){var ct=Math.min($+H-1,tt);wt.children.push(this._build(K,$,ct,Bt-1))}}return F(wt,this.toBBox),wt},D.prototype._chooseSubtree=function(K,ht,yt,Bt){for(;Bt.push(ht),!ht.leaf&&Bt.length-1!==yt;){for(var wt=1/0,Et=1/0,U=void 0,H=0;H<ht.children.length;H++){var q=ht.children[H],it=rt(q),tt=($=K,ct=q,(Math.max(ct.maxX,$.maxX)-Math.min(ct.minX,$.minX))*(Math.max(ct.maxY,$.maxY)-Math.min(ct.minY,$.minY))-it);tt<Et?(Et=tt,wt=it<wt?it:wt,U=q):tt===Et&&it<wt&&(wt=it,U=q)}ht=U||ht.children[0]}var $,ct;return ht},D.prototype._insert=function(K,ht,yt){var Bt=yt?K:this.toBBox(K),wt=[],Et=this._chooseSubtree(Bt,this.data,ht,wt);for(Et.children.push(K),Z(Et,Bt);ht>=0&&wt[ht].children.length>this._maxEntries;)this._split(wt,ht),ht--;this._adjustParentBBoxes(Bt,wt,ht)},D.prototype._split=function(K,ht){var yt=K[ht],Bt=yt.children.length,wt=this._minEntries;this._chooseSplitAxis(yt,wt,Bt);var Et=this._chooseSplitIndex(yt,wt,Bt),U=Pt(yt.children.splice(Et,yt.children.length-Et));U.height=yt.height,U.leaf=yt.leaf,F(yt,this.toBBox),F(U,this.toBBox),ht?K[ht-1].children.push(U):this._splitRoot(yt,U)},D.prototype._splitRoot=function(K,ht){this.data=Pt([K,ht]),this.data.height=K.height+1,this.data.leaf=!1,F(this.data,this.toBBox)},D.prototype._chooseSplitIndex=function(K,ht,yt){for(var Bt,wt,Et,U,H,q,it,tt=1/0,$=1/0,ct=ht;ct<=yt-ht;ct++){var nt=G(K,0,ct,this.toBBox),ut=G(K,ct,yt,this.toBBox),_t=(wt=nt,Et=ut,U=void 0,H=void 0,q=void 0,it=void 0,U=Math.max(wt.minX,Et.minX),H=Math.max(wt.minY,Et.minY),q=Math.min(wt.maxX,Et.maxX),it=Math.min(wt.maxY,Et.maxY),Math.max(0,q-U)*Math.max(0,it-H)),pt=rt(nt)+rt(ut);_t<tt?(tt=_t,Bt=ct,$=pt<$?pt:$):_t===tt&&pt<$&&($=pt,Bt=ct)}return Bt||yt-ht},D.prototype._chooseSplitAxis=function(K,ht,yt){var Bt=K.leaf?this.compareMinX:W,wt=K.leaf?this.compareMinY:V;this._allDistMargin(K,ht,yt,Bt)<this._allDistMargin(K,ht,yt,wt)&&K.children.sort(Bt)},D.prototype._allDistMargin=function(K,ht,yt,Bt){K.children.sort(Bt);for(var wt=this.toBBox,Et=G(K,0,ht,wt),U=G(K,yt-ht,yt,wt),H=st(Et)+st(U),q=ht;q<yt-ht;q++){var it=K.children[q];Z(Et,K.leaf?wt(it):it),H+=st(Et)}for(var tt=yt-ht-1;tt>=ht;tt--){var $=K.children[tt];Z(U,K.leaf?wt($):$),H+=st(U)}return H},D.prototype._adjustParentBBoxes=function(K,ht,yt){for(var Bt=yt;Bt>=0;Bt--)Z(ht[Bt],K)},D.prototype._condense=function(K){for(var ht=K.length-1,yt=void 0;ht>=0;ht--)K[ht].children.length===0?ht>0?(yt=K[ht-1].children).splice(yt.indexOf(K[ht]),1):this.clear():F(K[ht],this.toBBox)},D})});Array.prototype.findIndex=Array.prototype.findIndex||function(C){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof C!="function")throw new TypeError("callback must be a function");for(var k=Object(this),B=k.length>>>0,P=arguments[1],A=0;A<B;A++)if(C.call(P,k[A],A,k))return A;return-1},Array.prototype.find=Array.prototype.find||function(C){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof C!="function")throw new TypeError("callback must be a function");for(var k=Object(this),B=k.length>>>0,P=arguments[1],A=0;A<B;A++){var D=k[A];if(C.call(P,D,A,k))return D}},typeof Object.assign!="function"&&(Object.assign=function(C){if(C==null)throw new TypeError("Cannot convert undefined or null to object");C=Object(C);for(var k=1;k<arguments.length;k++){var B=arguments[k];if(B!=null)for(var P in B)Object.prototype.hasOwnProperty.call(B,P)&&(C[P]=B[P])}return C}),(function(C){C.forEach(function(k){k.hasOwnProperty("remove")||Object.defineProperty(k,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})})([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(C,k){if(this==null)throw new TypeError('"this" is null or not defined');var B=Object(this),P=B.length>>>0;if(P===0)return!1;var A=k|0,D=Math.max(A>=0?A:P-Math.abs(A),0);function O(F,G){return F===G||typeof F=="number"&&typeof G=="number"&&isNaN(F)&&isNaN(G)}for(;D<P;){if(O(B[D],C))return!0;D++}return!1}});var re={version:"2.19.2"},Qi=et(mn()),Fi={tooltips:{placeMarker:"Click to place marker",placeMarkerTouch:"Tap the map to place a marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},Ri={tooltips:{placeMarker:"Platziere den Marker mit Klick",placeMarkerTouch:"Tippe auf die Karte, um einen Marker zu platzieren",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex lschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer lschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Lnge",segmentLength:"Segment Lnge",area:"Flche",radius:"Radius",perimeter:"Umfang",height:"Hhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},Jn={tooltips:{placeMarker:"Clicca per posizionare un Marker",placeMarkerTouch:"Tocca la mappa per posizionare un marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},Ht={tooltips:{placeMarker:"Klik untuk menempatkan marker",placeMarkerTouch:"Ketuk peta untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ae={tooltips:{placeMarker:"Adaug un punct",placeMarkerTouch:"Atingei harta pentru a plasa un punct",firstVertex:"Apas aici pentru a aduga primul Vertex",continueLine:"Apas aici pentru a continua desenul",finishLine:"Apas pe orice obiect pentru a finisa desenul",finishPoly:"Apas pe primul obiect pentru a finisa",finishRect:"Apas pentru a finisa",startCircle:"Apas pentru a desena un cerc",finishCircle:"Apas pentru a finisa un cerc",placeCircleMarker:"Adaug un punct"},actions:{finish:"Termin",cancel:"Anuleaz",removeLastVertex:"terge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaug o bulin",drawPolyButton:"Deseneaz un poligon",drawLineButton:"Deseneaz o linie",drawCircleButton:"Deseneaz un cerc",drawRectButton:"Deseneaz un dreptunghi",editButton:"Editeaz straturile",dragButton:"Mut straturile",cutButton:"Taie straturile",deleteButton:"terge straturile",drawCircleMarkerButton:"Deseneaz marcatorul cercului",snappingButton:"Fixai marcatorul glisat pe alte straturi i vrfuri",pinningButton:"Fixai vrfurile partajate mpreun",rotateButton:"Rotii stratul"}},Xn={tooltips:{placeMarker:",   ",placeMarkerTouch:" ,   ",firstVertex:",    ",continueLine:",   ",finishLine:"     ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" "}},yn={tooltips:{placeMarker:"Presiona para colocar un marcador",placeMarkerTouch:"Toca el mapa para colocar un marcador",firstVertex:"Presiona para colocar el primer vrtice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del crculo",finishCircle:"Presiona para finalizar el crculo",placeCircleMarker:"Presiona para colocar un marcador de crculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar ltimo vrtice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polgono",drawLineButton:"Dibujar Lnea",drawCircleButton:"Dibujar Crculo",drawRectButton:"Dibujar Rectngulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Crculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vrtices",pinningButton:"Fijar juntos los vrtices compartidos",rotateButton:"Rotar capa"}},Re={tooltips:{placeMarker:"Klik om een marker te plaatsen",placeMarkerTouch:"Tik op de kaart om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beindigen",finishPoly:"Klik op het eerst punt om te beindigen",finishRect:"Klik om te beindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},fa={tooltips:{placeMarker:"Cliquez pour placer un marqueur",placeMarkerTouch:"Appuyez sur la carte pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer  dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"diter des calques",dragButton:"Dplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"pingler ensemble les sommets partags",rotateButton:"Tourner des calques"}},vn={tooltips:{placeMarker:"",placeMarkerTouch:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},Ci={tooltips:{placeMarker:"",placeMarkerTouch:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},he={tooltips:{placeMarker:"Clique para posicionar o marcador",placeMarkerTouch:"Toque no mapa para posicionar um marcador",firstVertex:"Clique para posicionar o primeiro vrtice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do crculo",finishCircle:"Clique para finalizar o crculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover ltimo vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},ci={tooltips:{placeMarker:"Clique para colocar marcador",placeMarkerTouch:"Toque no mapa para colocar um marcador",firstVertex:"Clique para colocar primeiro vrtice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do crculo",finishCircle:"Clique para terminar o crculo",placeCircleMarker:"Clique para colocar marcador de crculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover ltimo Vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},tn={tooltips:{placeMarker:"Kliknij, aby umieci znacznik",placeMarkerTouch:"Dotknij map, aby umieci znacznik",firstVertex:"Kliknij, aby umieci pierwszy wierzchoek",continueLine:"Kliknij, aby kontynuowa rysowanie",finishLine:"Kliknij dowolny istniejcy znacznik, aby zakoczy",finishPoly:"Kliknij pierwszy znacznik, aby zakoczy",finishRect:"Kliknij, aby zakoczy",startCircle:"Kliknij, aby umieci rodek okrgu",finishCircle:"Kliknij, aby zakoczy okrg",placeCircleMarker:"Kliknij, aby umieci znacznik okrgu",placeText:"Kliknij, aby umieci tekst"},actions:{finish:"Zakocz",cancel:"Anuluj",removeLastVertex:"Usu ostatni wierzchoek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokt",drawLineButton:"Rysuj lini",drawCircleButton:"Rysuj okrg",drawRectButton:"Rysuj prostokt",editButton:"Edytuj warstwy",dragButton:"Przecignij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usu warstwy",drawCircleMarkerButton:"Rysuj znacznik okrgy",snappingButton:"Przycignij przenoszony znacznik do innych warstw i wierzchokw",pinningButton:"Przypnij wsplne wierzchoki razem",rotateButton:"Obr warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne ledzenie linii"},measurements:{totalLength:"Dugo",segmentLength:"Dugo odcinka",area:"Obszar",radius:"Promie",perimeter:"Obwd",height:"Wysoko",width:"Szeroko",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},en={tooltips:{placeMarker:"Klicka fr att placera markr",placeMarkerTouch:"Tryck p kartan fr att placera en markr",firstVertex:"Klicka fr att placera frsta hrnet",continueLine:"Klicka fr att fortstta rita",finishLine:"Klicka p en existerande punkt fr att slutfra",finishPoly:"Klicka p den frsta punkten fr att slutfra",finishRect:"Klicka fr att slutfra",startCircle:"Klicka fr att placera cirkelns centrum",finishCircle:"Klicka fr att slutfra cirkeln",placeCircleMarker:"Klicka fr att placera cirkelmarkr"},actions:{finish:"Slutfr",cancel:"Avbryt",removeLastVertex:"Ta bort sista hrnet"},buttonTitles:{drawMarkerButton:"Rita Markr",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkr",snappingButton:"Snpp dra markren till andra lager och hrn",pinningButton:"Fst delade hrn tillsammans",rotateButton:"Rotera lagret"}},$n={tooltips:{placeMarker:"     ",placeMarkerTouch:"      ",firstVertex:"       ",continueLine:"      ",finishLine:"        ",finishPoly:"       ",finishRect:"    ",startCircle:"      ",finishCircle:"      ",placeCircleMarker:"      "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"        ",pinningButton:"   ",rotateButton:"  "}},nn={tooltips:{placeMarker:"Kattintson a jell elhelyezshez",placeMarkerTouch:"rintse meg a trkpet a jell elhelyezshez",firstVertex:"Kattintson az els pont elhelyezshez",continueLine:"Kattintson a kvetkez pont elhelyezshez",finishLine:"A befejezshez kattintson egy meglv pontra",finishPoly:"A befejezshez kattintson az els pontra",finishRect:"Kattintson a befejezshez",startCircle:"Kattintson a kr kzppontjnak elhelyezshez",finishCircle:"Kattintson a kr befejezshez",placeCircleMarker:"Kattintson a krjell elhelyezshez"},actions:{finish:"Befejezs",cancel:"Mgse",removeLastVertex:"Utols pont eltvoltsa"},buttonTitles:{drawMarkerButton:"Jell rajzolsa",drawPolyButton:"Poligon rajzolsa",drawLineButton:"Vonal rajzolsa",drawCircleButton:"Kr rajzolsa",drawRectButton:"Ngyzet rajzolsa",editButton:"Elemek szerkesztse",dragButton:"Elemek mozgatsa",cutButton:"Elemek vgsa",deleteButton:"Elemek trlse",drawCircleMarkerButton:"Kr jell rajzolsa",snappingButton:"Kapcsolja a jelltt msik elemhez vagy ponthoz",pinningButton:"Kzs pontok sszektse",rotateButton:"Flia elforgatsa"}},Qn={tooltips:{placeMarker:"Tryk for at placere en markr",placeMarkerTouch:"Tryk p kortet for at placere en markr",firstVertex:"Tryk for at placere det frste punkt",continueLine:"Tryk for at fortstte linjen",finishLine:"Tryk p et eksisterende punkt for at afslutte",finishPoly:"Tryk p det frste punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkr"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markr",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Trk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkr",snappingButton:"Fastgr trukket markr til andre elementer",pinningButton:"Sammenlg delte elementer",rotateButton:"Roter laget"}},tr={tooltips:{placeMarker:"Klikk for  plassere punkt",placeMarkerTouch:"Trykk p kartet for  plassere et punkt",firstVertex:"Klikk for  plassere frste punkt",continueLine:"Klikk for  tegne videre",finishLine:"Klikk p et eksisterende punkt for  fullfre",finishPoly:"Klikk frste punkt for  fullfre",finishRect:"Klikk for  fullfre",startCircle:"Klikk for  sette sirkel midtpunkt",finishCircle:"Klikk for  fullfre sirkel",placeCircleMarker:"Klikk for  plassere sirkel",placeText:"Klikk for  plassere tekst"},actions:{finish:"Fullfr",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotr objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalr objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Omrde",radius:"Radius",perimeter:"Omriss",height:"Hyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkr"}},Ln={tooltips:{placeMarker:"   ",placeMarkerTouch:"      ",firstVertex:"    ",continueLine:"   ",finishLine:"      ",finishPoly:"     ",finishRect:"  ",startCircle:"    ",finishCircle:"    ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"      ",rotateButton:" ",drawTextButton:" ",scaleButton:"",autoTracingButton:" "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},er={tooltips:{placeMarker:",   ",placeMarkerTouch:" ,   ",firstVertex:",    ",continueLine:",   ",finishLine:" -    ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"'   ",rotateButton:" "}},ir={tooltips:{placeMarker:"areti yerletirmek iin tklayn",placeMarkerTouch:"areti yerletirmek iin haritaya dokunun",firstVertex:"lk tepe noktasn yerletirmek iin tklayn",continueLine:"izime devam etmek iin tklayn",finishLine:"Bitirmek iin mevcut herhangi bir iaretiyi tklayn",finishPoly:"Bitirmek iin ilk iaretiyi tklayn",finishRect:"Bitirmek iin tklayn",startCircle:"Daire merkezine yerletirmek iin tklayn",finishCircle:"Daireyi bitirmek iin tklayn",placeCircleMarker:"Daire iaretisi yerletirmek iin tklayn"},actions:{finish:"Bitir",cancel:"ptal",removeLastVertex:"Son keyi kaldr"},buttonTitles:{drawMarkerButton:"izim aretisi",drawPolyButton:"okgenler iz",drawLineButton:"oklu izgi iz",drawCircleButton:"ember iz",drawRectButton:"Dikdrtgen iz",editButton:"Katmanlar dzenle",dragButton:"Katmanlar srkle",cutButton:"Katmanlar kes",deleteButton:"Katmanlar kaldr",drawCircleMarkerButton:"Daire iaretisi iz",snappingButton:"Srklenen iaretiyi dier katmanlara ve kelere yaptr",pinningButton:"Paylalan keleri birbirine sabitle",rotateButton:"Katman dndr"}},Cn={tooltips:{placeMarker:"Kliknutm vytvote znaku",placeMarkerTouch:"Klepnutm na mapu umstte znaku",firstVertex:"Kliknutm vytvote prvn objekt",continueLine:"Kliknutm pokraujte v kreslen",finishLine:"Kliknut na libovolnou existujc znaku pro dokonen",finishPoly:"Vyberte prvn bod pro dokonen",finishRect:"Kliknte pro dokonen",startCircle:"Kliknutm pidejte sted kruhu",finishCircle:",   ",placeCircleMarker:"Kliknutm nastavte polomr"},actions:{finish:"Dokonit",cancel:"Zruit",removeLastVertex:"Zruit posledn akci"},buttonTitles:{drawMarkerButton:"Pidat znaku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit kivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdlnk",editButton:"Upravit vrstvu",dragButton:"Peneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Pidat kruhovou znaku",snappingButton:"Navzat tanou znaku k dalm vrstvm a vrcholm",pinningButton:"Spojit spolen body dohromady",rotateButton:"Otote vrstvu"}},es={tooltips:{placeMarker:"",placeMarkerTouch:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:"",placeText:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:"",drawTextButton:""}},nr={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",placeMarkerTouch:"Napauta karttaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtmist",finishLine:"Klikkaa olemassa olevaa merkki lopettaaksesi",finishPoly:"Klikkaa ensimmist merkki lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrn keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrn",placeCircleMarker:"Klikkaa asettaaksesi ympyrmerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirr merkkej",drawPolyButton:"Piirr monikulmioita",drawLineButton:"Piirr viivoja",drawCircleButton:"Piirr ympyr",drawRectButton:"Piirr neliskulmioita",editButton:"Muokkaa",dragButton:"Siirr",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirr ympyrmerkki",snappingButton:"Kiinnit siirrettv merkki toisiin muotoihin",pinningButton:"Kiinnit jaetut muodot yhteen",rotateButton:"Knn",drawTextButton:"Piirr teksti"}},_a={tooltips:{placeMarker:"  ",placeMarkerTouch:"   ",firstVertex:"   ",continueLine:"  ",finishLine:"   ",finishPoly:"   ",finishRect:" ",startCircle:"    ",finishCircle:"  ",placeCircleMarker:"   ",placeText:"  "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" ",drawTextButton:" "}},Zt={tooltips:{placeMarker:"   ",placeMarkerTouch:"    ",firstVertex:"    ",continueLine:"    ",finishLine:"    ",finishPoly:"    ",finishRect:"  ",startCircle:"    ",finishCircle:"   ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:" ",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:"  ",cutButton:"  ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"     ",pinningButton:"   ",rotateButton:" ",drawTextButton:" ",scaleButton:"  ",autoTracingButton:"  "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},qe=ci,Jt={en:Fi,de:Ri,it:Jn,id:Ht,ro:ae,ru:Xn,es:yn,nl:Re,fr:fa,pt:qe,pt_br:he,pt_pt:ci,zh:vn,zh_tw:Ci,pl:tn,sv:en,el:$n,hu:nn,da:Qn,no:tr,fa:Ln,ua:er,tr:ir,cz:Cn,ja:es,fi:nr,ko:_a,ky:Zt},is={_globalEditModeEnabled:!1,enableGlobalEditMode(C){let k={...C};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(B=>{this._isRelevantForEdit(B)&&B.pm.enable(k)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(C=>{C.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(C=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(C)},handleLayerAdditionInGlobalEditMode(){let C=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let k in C){let B=C[k];this._isRelevantForEdit(B)&&B.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:C}){this._addedLayersEdit[L.stamp(C)]=C},_isRelevantForEdit(C){return C.pm&&!(C instanceof L.LayerGroup)&&(!L.PM.optIn&&!C.options.pmIgnore||L.PM.optIn&&C.options.pmIgnore===!1)&&!C._pmTempLayer&&C.pm.options.allowEditing}},rr=is,sr={_globalDragModeEnabled:!1,enableGlobalDragMode(){let C=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},C.forEach(k=>{this._isRelevantForDrag(k)&&k.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let C=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,C.forEach(k=>{k.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let C=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let k in C){let B=C[k];this._isRelevantForDrag(B)&&B.pm.enableLayerDrag()}},_layerAddedDrag({layer:C}){this._addedLayersDrag[L.stamp(C)]=C},_isRelevantForDrag(C){return C.pm&&!(C instanceof L.LayerGroup)&&(!L.PM.optIn&&!C.options.pmIgnore||L.PM.optIn&&C.options.pmIgnore===!1)&&!C._pmTempLayer&&C.pm.options.draggable}},ar=sr,bi={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(C=>{this._isRelevantForRemoval(C)&&(C.pm.enabled()&&C.pm.disable(),C.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(C=>{C.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(C){let k=C.target;this._isRelevantForRemoval(k)&&!k.pm.dragging()&&(k.removeFrom(this.map.pm._getContainingLayer()),k.remove(),k instanceof L.LayerGroup?(this._fireRemoveLayerGroup(k),this._fireRemoveLayerGroup(this.map,k)):(k.pm._fireRemove(k),k.pm._fireRemove(this.map,k)))},_isRelevantForRemoval(C){return C.pm&&!(C instanceof L.LayerGroup)&&(!L.PM.optIn&&!C.options.pmIgnore||L.PM.optIn&&C.options.pmIgnore===!1)&&!C._pmTempLayer&&C.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let C=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let k in C){let B=C[k];this._isRelevantForRemoval(B)&&(B.pm.enabled()&&B.pm.disable(),B.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:C}){this._addedLayersRemoval[L.stamp(C)]=C}},or=bi,rn={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(C=>C instanceof L.Polyline).forEach(C=>{this._isRelevantForRotate(C)&&C.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(C=>C instanceof L.Polyline).forEach(C=>{C.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(C){return C.pm&&C instanceof L.Polyline&&!(C instanceof L.LayerGroup)&&(!L.PM.optIn&&!C.options.pmIgnore||L.PM.optIn&&C.options.pmIgnore===!1)&&!C._pmTempLayer&&C.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let C=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let k in C){let B=C[k];this._isRelevantForRemoval(B)&&B.pm.enableRotate()}},_layerAddedRotate({layer:C}){this._addedLayersRotate[L.stamp(C)]=C}},me=rn,xi=et(mn()),ns={_fireDrawStart(C="Draw",k={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},C,k)},_fireDrawEnd(C="Draw",k={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},C,k)},_fireCreate(C,k="Draw",B={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:C,layer:C},k,B)},_fireCenterPlaced(C="Draw",k={}){let B=C==="Draw"?this._layer:void 0,P=C!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:B,layer:P,latlng:this._layer.getLatLng()},C,k)},_fireCut(C,k,B,P="Draw",A={}){this.__fire(C,"pm:cut",{shape:this._shape,layer:k,originalLayer:B},P,A)},_fireEdit(C=this._layer,k="Edit",B={}){this.__fire(C,"pm:edit",{layer:this._layer,shape:this.getShape()},k,B)},_fireEnable(C="Edit",k={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},C,k)},_fireDisable(C="Edit",k={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},C,k)},_fireUpdate(C="Edit",k={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},C,k)},_fireMarkerDragStart(C,k=void 0,B="Edit",P={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:C,shape:this.getShape(),indexPath:k},B,P)},_fireMarkerDrag(C,k=void 0,B="Edit",P={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:C,shape:this.getShape(),indexPath:k},B,P)},_fireMarkerDragEnd(C,k=void 0,B=void 0,P="Edit",A={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:C,shape:this.getShape(),indexPath:k,intersectionReset:B},P,A)},_fireDragStart(C="Edit",k={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},C,k)},_fireDrag(C,k="Edit",B={}){this.__fire(this._layer,"pm:drag",{...C,shape:this.getShape()},k,B)},_fireDragEnd(C="Edit",k={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},C,k)},_fireDragEnable(C="Edit",k={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},C,k)},_fireDragDisable(C="Edit",k={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},C,k)},_fireRemove(C,k=C,B="Edit",P={}){this.__fire(C,"pm:remove",{layer:k,shape:this.getShape()},B,P)},_fireVertexAdded(C,k,B,P="Edit",A={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:C,indexPath:k,latlng:B,shape:this.getShape()},P,A)},_fireVertexRemoved(C,k,B="Edit",P={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:C,indexPath:k,shape:this.getShape()},B,P)},_fireVertexClick(C,k,B="Edit",P={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:C,indexPath:k,shape:this.getShape()},B,P)},_fireIntersect(C,k=this._layer,B="Edit",P={}){this.__fire(k,"pm:intersect",{layer:this._layer,intersection:C,shape:this.getShape()},B,P)},_fireLayerReset(C,k,B="Edit",P={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:C,indexPath:k,shape:this.getShape()},B,P)},_fireChange(C,k="Edit",B={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:C,shape:this.getShape()},k,B)},_fireTextChange(C,k="Edit",B={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:C,shape:this.getShape()},k,B)},_fireTextFocus(C="Edit",k={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},C,k)},_fireTextBlur(C="Edit",k={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},C,k)},_fireSnapDrag(C,k,B="Snapping",P={}){this.__fire(C,"pm:snapdrag",k,B,P)},_fireSnap(C,k,B="Snapping",P={}){this.__fire(C,"pm:snap",k,B,P)},_fireUnsnap(C,k,B="Snapping",P={}){this.__fire(C,"pm:unsnap",k,B,P)},_fireRotationEnable(C,k,B="Rotation",P={}){this.__fire(C,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},B,P)},_fireRotationDisable(C,k="Rotation",B={}){this.__fire(C,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},k,B)},_fireRotationStart(C,k,B="Rotation",P={}){this.__fire(C,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:k},B,P)},_fireRotation(C,k,B,P=this._rotationLayer,A="Rotation",D={}){this.__fire(C,"pm:rotate",{layer:P,helpLayer:this._layer,startAngle:this._startAngle,angle:P.pm.getAngle(),angleDiff:k,oldLatLngs:B,newLatLngs:P.getLatLngs()},A,D)},_fireRotationEnd(C,k,B,P="Rotation",A={}){this.__fire(C,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:k,angle:this._rotationLayer.pm.getAngle(),originLatLngs:B,newLatLngs:this._rotationLayer.getLatLngs()},P,A)},_fireActionClick(C,k,B,P="Toolbar",A={}){this.__fire(this._map,"pm:actionclick",{text:C.text,action:C,btnName:k,button:B},P,A)},_fireButtonClick(C,k,B="Toolbar",P={}){this.__fire(this._map,"pm:buttonclick",{btnName:C,button:k},B,P)},_fireLangChange(C,k,B,P,A="Global",D={}){this.__fire(this.map,"pm:langchange",{oldLang:C,activeLang:k,fallback:B,translations:P},A,D)},_fireGlobalDragModeToggled(C,k="Global",B={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:C,map:this.map},k,B)},_fireGlobalEditModeToggled(C,k="Global",B={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:C,map:this.map},k,B)},_fireGlobalRemovalModeToggled(C,k="Global",B={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:C,map:this.map},k,B)},_fireGlobalCutModeToggled(C="Global",k={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},C,k)},_fireGlobalDrawModeToggled(C="Global",k={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},C,k)},_fireGlobalRotateModeToggled(C="Global",k={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},C,k)},_fireRemoveLayerGroup(C,k=C,B="Edit",P={}){this.__fire(C,"pm:remove",{layer:k,shape:void 0},B,P)},_fireKeyeventEvent(C,k,B,P="Global",A={}){this.__fire(this.map,"pm:keyevent",{event:C,eventType:k,focusOn:B},P,A)},__fire(C,k,B,P,A={}){B=(0,xi.default)(B,A,{source:P}),L.PM.Utils._fireEvent(C,k,B)}},sn=ns,ma=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(C){this.map=C,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),C.once("unload",this._unbindKeyListenerEvents,this)},_handleEscapeKey(C){let k=this.map.pm;return!k.getGlobalOptions().exitModeOnEscape||!(k.globalDrawModeEnabled()||k.globalEditModeEnabled()||k.globalDragModeEnabled()||k.globalRemovalModeEnabled()||k.globalRotateModeEnabled()||k.globalCutModeEnabled())?!1:(C.preventDefault(),k.globalDrawModeEnabled()&&k.disableDraw(),k.globalEditModeEnabled()&&k.disableGlobalEditMode(),k.globalDragModeEnabled()&&k.disableGlobalDragMode(),k.globalRemovalModeEnabled()&&k.disableGlobalRemovalMode(),k.globalRotateModeEnabled()&&k.disableGlobalRotateMode(),k.globalCutModeEnabled()&&k.disableGlobalCutMode(),!0)},_handleEnterKey(C){let k=this.map.pm;if(!k.getGlobalOptions().finishOnEnter)return!1;let B=k.Draw.getActiveShape();if(!B)return!1;let P=k.Draw[B];return!P||!P._finishShape||!this._canFinishShape(P,B)?!1:(C.preventDefault(),P._finishShape(),!0)},_canFinishShape(C,k){if(["Marker","CircleMarker","Text"].includes(k))return!1;if(k==="Rectangle")return C._startMarker!==void 0;if(k==="Circle")return C._centerMarker&&C._layerGroup?.hasLayer(C._centerMarker);if(C._layer&&C._layer.getLatLngs){let B=C._layer.getLatLngs();if(k==="Line")return(B.flat?B.flat():B).length>=2;if(k==="Polygon"||k==="Cut")return B.length>=3}return!1},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(C){let k="document";this.map.getContainer().contains(C.target)&&(k="map");let B={event:C,eventType:C.type,focusOn:k};this._lastEvents[C.type]=B,this._lastEvents.current=B,this.map.pm._fireKeyeventEvent(C,C.type,k),C.type==="keydown"&&(C.key==="Escape"&&this._handleEscapeKey(C),C.key==="Enter"&&this._handleEnterKey(C))},_onBlur(C){C.altKey=!1;let k={event:C,eventType:C.type,focusOn:"document"};this._lastEvents[C.type]=k,this._lastEvents.current=k},getLastKeyEvent(C="current"){return this._lastEvents[C]},isShiftKeyPressed(){return this._lastEvents.current?.event.shiftKey},isAltKeyPressed(){return this._lastEvents.current?.event.altKey},isCtrlKeyPressed(){return this._lastEvents.current?.event.ctrlKey},isMetaKeyPressed(){return this._lastEvents.current?.event.metaKey},getPressedKey(){return this._lastEvents.current?.event.key}}),rs=ma,bn=et(hi());function Wt(C){let k=L.PM.activeLang;return(0,bn.default)(Jt[k],C)||(0,bn.default)(Jt.en,C)||C}function ss(){return window.matchMedia?!window.matchMedia("(pointer: coarse)").matches:!0}function qt(C){for(let k=0;k<C.length;k+=1){let B=C[k];if(Array.isArray(B)){if(qt(B))return!0}else if(B!=null&&B!=="")return!0}return!1}function xn(C){return C.reduce((k,B)=>{if(B.length!==0){let P=Array.isArray(B)?xn(B):B;Array.isArray(P)?P.length!==0&&k.push(P):k.push(P)}return k},[])}function Ue(C,k,B){let P={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:A,b:D,f:O}=P,F=C.lng,G=C.lat,Z=B,W=Math.PI,V=k*W/180,rt=Math.sin(V),st=Math.cos(V),vt=(1-O)*Math.tan(G*W/180),bt=1/Math.sqrt(1+vt*vt),Pt=vt*bt,At=Math.atan2(vt,st),K=bt*rt,ht=1-K*K,yt=ht*(A*A-D*D)/(D*D),Bt=1+yt/16384*(4096+yt*(-768+yt*(320-175*yt))),wt=yt/1024*(256+yt*(-128+yt*(74-47*yt))),Et=Z/(D*Bt),U=2*Math.PI,H,q,it;for(;Math.abs(Et-U)>1e-12;){H=Math.cos(2*At+Et),q=Math.sin(Et),it=Math.cos(Et);let xt=wt*q*(H+wt/4*(it*(-1+2*H*H)-wt/6*H*(-3+4*q*q)*(-3+4*H*H)));U=Et,Et=Z/(D*Bt)+xt}let tt=Pt*q-bt*it*st,$=Math.atan2(Pt*it+bt*q*st,(1-O)*Math.sqrt(K*K+tt*tt)),ct=Math.atan2(q*rt,bt*it-Pt*q*st),nt=O/16*ht*(4+O*(4-3*ht)),ut=ct-(1-nt)*O*K*(Et+nt*q*(H+nt*it*(-1+2*H*H))),_t=F+ut*180/W,pt=$*180/W;return L.latLng(_t,pt)}function Ii(C,k,B,P,A=!0){let D,O,F,G=[];for(let Z=0;Z<B;Z+=1){if(A)D=Z*360/B+P,O=Ue(C,D,k),F=L.latLng(O.lng,O.lat);else{let W=C.lat+Math.cos(2*Z*Math.PI/B)*k,V=C.lng+Math.sin(2*Z*Math.PI/B)*k;F=L.latLng(W,V)}G.push(F)}return G}function as(C,k,B){k=(k+360)%360;let P=Math.PI/180,A=180/Math.PI,{R:D}=L.CRS.Earth,O=C.lng*P,F=C.lat*P,G=k*P,Z=Math.sin(F),W=Math.cos(F),V=Math.cos(B/D),rt=Math.sin(B/D),st=Math.asin(Z*V+W*rt*Math.cos(G)),vt=O+Math.atan2(Math.sin(G)*rt*W,V-Z*Math.sin(st));vt*=A;let bt=vt-360,Pt=vt<-180?vt+360:vt;return vt=vt>180?bt:Pt,L.latLng([st*A,vt])}function ur(C,k,B){let P=C.latLngToContainerPoint(k),A=C.latLngToContainerPoint(B),D=Math.atan2(A.y-P.y,A.x-P.x)*180/Math.PI+90;return D+=D<0?360:0,D}function zi(C,k,B,P){let A=ur(C,k,B);return as(k,A,P)}function ga(C,k,B="asc"){if(!k||Object.keys(k).length===0)return(G,Z)=>G-Z;let P=Object.keys(k),A,D=P.length-1,O={};for(;D>=0;)A=P[D],O[A.toLowerCase()]=k[A],D-=1;function F(G){if(G instanceof L.Marker)return"Marker";if(G instanceof L.Circle)return"Circle";if(G instanceof L.CircleMarker)return"CircleMarker";if(G instanceof L.Rectangle)return"Rectangle";if(G instanceof L.Polygon)return"Polygon";if(G instanceof L.Polyline)return"Line"}return(G,Z)=>{let W,V;if(W=F(G.layer).toLowerCase(),V=F(Z.layer).toLowerCase(),!W||!V)return 0;let rt=W in O?O[W]:Number.MAX_SAFE_INTEGER,st=V in O?O[V]:Number.MAX_SAFE_INTEGER,vt=0;return rt<st?vt=-1:rt>st&&(vt=1),B==="desc"?vt*-1:vt}}function ri(C,k=C.getLatLngs()){return C instanceof L.Polygon?L.polygon(k).getLatLngs():L.polyline(k).getLatLngs()}function os(C,k){if(k.options.crs?.projection?.MAX_LATITUDE){let B=k.options.crs?.projection?.MAX_LATITUDE;C.lat=Math.max(Math.min(B,C.lat),-B)}return C}function Ni(C){return C.options.renderer||C._map&&(C._map._getPaneRenderer(C.options.pane)||C._map.options.renderer||C._map._renderer)||C._renderer}function lr(C,k){if(C=C.trim().toLowerCase(),k[C])return C;let B=C.replace(/[-_\s]/g,"_").match(/^([a-z]{2,3})(?:_([a-z]{2,3}))?$/);if(B){let P=[];B[2]&&P.push(`${B[1]}_${B[2]}`),P.push(B[1]);for(let A of P)if(k[A])return A}return C}var ya=L.Class.extend({includes:[rr,ar,or,me,sn],initialize(C){this.map=C,this.Draw=new L.PM.Draw(C),this.Toolbar=new L.PM.Toolbar(C),this.Keyboard=rs(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0,exitModeOnEscape:!1,finishOnEnter:!1},this.Keyboard._initKeyListener(C)},setLang(C="en",k,B="en"){C=lr(C,Jt);let P=L.PM.activeLang;k&&(Jt[C]=(0,Qi.default)(Jt[B],k)),L.PM.activeLang=C,this.map.pm.Toolbar.reinit(),this._fireLangChange(P,C,B,Jt[C])},addControls(C){this.Toolbar.addControls(C)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(C="Polygon",k){C==="Poly"&&(C="Polygon"),this.Draw.enable(C,k)},disableDraw(C="Polygon"){C==="Poly"&&(C="Polygon"),this.Draw.disable(C)},setPathOptions(C,k={}){let B=k.ignoreShapes||[],P=k.merge||!1;this.map.pm.Draw.shapes.forEach(A=>{B.indexOf(A)===-1&&this.map.pm.Draw[A].setPathOptions(C,P)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(C){let k=(0,Qi.default)(this.globalOptions,C);k.editable&&(k.resizeableCircleMarker=k.editable,delete k.editable);let B=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!k.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),B=!0);let P=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!k.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),P=!0),this.map.pm.Draw.shapes.forEach(A=>{this.map.pm.Draw[A].setOptions(k)}),B&&this.map.pm.Draw.CircleMarker.enable(),P&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(A=>{A.pm.setOptions(k)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=k,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(C=>{C.pm.enabled()&&C.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(C){return this.Draw.Cut.enable(C)},toggleGlobalCutMode(C){return this.Draw.Cut.toggle(C)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(C=!1){let k=L.PM.Utils.findLayers(this.map);if(!C)return k;let B=L.featureGroup();return B._pmTempLayer=!0,k.forEach(P=>{B.addLayer(P)}),B},getGeomanDrawLayers(C=!1){let k=L.PM.Utils.findLayers(this.map).filter(P=>P._drawnByGeoman===!0);if(!C)return k;let B=L.featureGroup();return B._pmTempLayer=!0,k.forEach(P=>{B.addLayer(P)}),B},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(C){this._touchEventCounter===0&&(L.DomEvent.on(C,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(C,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(C){this._touchEventCounter===1&&(L.DomEvent.off(C,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(C,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(C){Ni(this.map)._onMouseMove(this._createMouseEvent("mousemove",C))},_canvasTouchClick(C){let k="";C.type==="touchstart"||C.type==="pointerdown"?k="mousedown":(C.type==="touchend"||C.type==="pointerup"||C.type==="touchcancel"||C.type==="pointercancel")&&(k="mouseup"),k&&Ni(this.map)._onClick(this._createMouseEvent(k,C))},_createMouseEvent(C,k){let B,P=k.touches[0]||k.changedTouches[0];try{B=new MouseEvent(C,{bubbles:k.bubbles,cancelable:k.cancelable,view:k.view,detail:P.detail,screenX:P.screenX,screenY:P.screenY,clientX:P.clientX,clientY:P.clientY,ctrlKey:k.ctrlKey,altKey:k.altKey,shiftKey:k.shiftKey,metaKey:k.metaKey,button:k.button,relatedTarget:k.relatedTarget})}catch{B=document.createEvent("MouseEvents"),B.initMouseEvent(C,k.bubbles,k.cancelable,k.view,P.detail,P.screenX,P.screenY,P.clientX,P.clientY,k.ctrlKey,k.altKey,k.shiftKey,k.metaKey,k.button,k.relatedTarget)}return B}}),Ke=ya,va=L.Control.extend({includes:[sn],options:{position:"topleft",disableByOtherButtons:!0},initialize(C){this._button=L.Util.extend({},this.options,C)},onAdd(C){return this._map=C,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let C=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),C?C.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(C){return typeof C=="boolean"?this._button.toggleStatus=C:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(C){C&&C.preventDefault(),!this._button.disabled&&(this._button.onClick(C,{button:this,event:C}),this._clicked(C),this._button.afterClick(C,{button:this,event:C}))},_makeButton(C){let k=this.options.position.indexOf("right")>-1?"pos-right":"",B=L.DomUtil.create("div",`button-container  ${k}`,this._container);C.title&&B.setAttribute("title",C.title);let P=L.DomUtil.create("a","leaflet-buttons-control-button",B);P.setAttribute("role","button"),P.setAttribute("tabindex","0"),P.href="#";let A=L.DomUtil.create("div",`leaflet-pm-actions-container ${k}`,B),D=C.actions,O={cancel:{text:Wt("actions.cancel"),title:Wt("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:Wt("actions.finish"),title:Wt("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:Wt("actions.removeLastVertex"),title:Wt("actions.removeLastVertex"),onClick(){this._map.pm.Draw[C.jsClass]._removeLastVertex()}},finish:{text:Wt("actions.finish"),title:Wt("actions.finish"),onClick(G){this._map.pm.Draw[C.jsClass]._finishShape(G)}}};C._preparedActions=D.map(G=>{let Z=typeof G=="string"?G:G.name,W;if(O[Z])W=O[Z];else if(G.text)W=G;else return W;let V=L.DomUtil.create("a",`leaflet-pm-action ${k} action-${Z}`,A);if(V.setAttribute("role","button"),V.setAttribute("tabindex","0"),V.href="#",W.title&&(V.title=W.title),V.innerHTML=W.text,L.DomEvent.disableClickPropagation(V),L.DomEvent.on(V,"click",L.DomEvent.stop),W._node=V,!C.disabled&&W.onClick){let rt=st=>{st.preventDefault();let vt="",{buttons:bt}=this._map.pm.Toolbar;for(let Pt in bt)if(bt[Pt]._button===C){vt=Pt;break}this._fireActionClick(W,vt,C)};L.DomEvent.addListener(V,"click",rt,this),L.DomEvent.addListener(V,"click",W.onClick,this),L.DomEvent.addListener(V,"click",()=>this._updateActiveAction(C))}return W}),this._updateActiveAction(C),C.toggleStatus&&L.DomUtil.addClass(B,"active");let F=L.DomUtil.create("div","control-icon",P);return C.iconUrl&&F.setAttribute("src",C.iconUrl),C.className&&L.DomUtil.addClass(F,C.className),L.DomEvent.disableClickPropagation(P),L.DomEvent.on(P,"click",L.DomEvent.stop),C.disabled||(L.DomEvent.addListener(P,"click",this._onBtnClick,this),L.DomEvent.addListener(P,"click",this._triggerClick,this)),C.disabled&&(L.DomUtil.addClass(P,"pm-disabled"),P.setAttribute("aria-disabled","true")),B},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let C="",{buttons:k}=this._map.pm.Toolbar;for(let B in k)if(k[B]._button===this._button){C=B;break}this._fireButtonClick(C,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let C="pm-disabled",k=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(k,C),k.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(k,C),k.setAttribute("aria-disabled","false"))},_updateActiveAction(C){C._preparedActions?.forEach(k=>{k?._node&&(k.isActive&&k.isActive.call(this)?L.DomUtil.addClass(k._node,"active-action"):L.DomUtil.removeClass(k._node,"active-action"))})}}),us=va;L.Control.PMButton=us;var di=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(C){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(C)},reinit(){let C=this.isVisible;this.removeControls(),this._defineButtons(),C&&this.addControls()},init(C){this.map=C,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(C){let k=`${C}Container`;return this[k]||(this[k]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${C} leaflet-bar leaflet-control`)),this[k]},getButtons(){return this.buttons},addControls(C=this.options){typeof C.editPolygon<"u"&&(C.editMode=C.editPolygon),typeof C.deleteLayer<"u"&&(C.removalMode=C.deleteLayer),L.Util.setOptions(this,C),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let C=this.getButtons(),k={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let B in C){let P=C[B];L.Util.setOptions(P,{className:k.geomanIcons[B]})}},removeControls(){let C=this.getButtons();for(let k in C)C[k].remove();this.isVisible=!1},deleteControl(C){let k=this._btnNameMapping(C);this.buttons[k]&&(this.buttons[k].remove(),delete this.buttons[k])},toggleControls(C=this.options){this.isVisible?this.removeControls():this.addControls(C)},_addButton(C,k){return this.buttons[C]=k,this.options[C]=!!this.options[C]||!1,this.buttons[C]},triggerClickOnToggledButtons(C){for(let k in this.buttons){let B=this.buttons[k];B._button.disableByOtherButtons&&B!==C&&B.toggled()&&B._triggerClick()}},toggleButton(C,k,B=!0){C==="editPolygon"&&(C="editMode"),C==="deleteLayer"&&(C="removalMode");let P=C;return B&&this.triggerClickOnToggledButtons(this.buttons[P]),this.buttons[P]?this.buttons[P].toggle(k):!1},_defineButtons(){let C={className:"control-icon leaflet-pm-icon-marker",title:Wt("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},k={title:Wt("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},B={className:"control-icon leaflet-pm-icon-polyline",title:Wt("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},P={title:Wt("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},A={title:Wt("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},D={title:Wt("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},O={title:Wt("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},F={title:Wt("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},G={title:Wt("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},Z={title:Wt("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},W={title:Wt("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},V={className:"control-icon leaflet-pm-icon-text",title:Wt("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(rt,st)=>{this.map.pm.Draw[st.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(C)),this._addButton("drawPolyline",new L.Control.PMButton(B)),this._addButton("drawRectangle",new L.Control.PMButton(D)),this._addButton("drawPolygon",new L.Control.PMButton(k)),this._addButton("drawCircle",new L.Control.PMButton(P)),this._addButton("drawCircleMarker",new L.Control.PMButton(A)),this._addButton("drawText",new L.Control.PMButton(V)),this._addButton("editMode",new L.Control.PMButton(O)),this._addButton("dragMode",new L.Control.PMButton(F)),this._addButton("cutPolygon",new L.Control.PMButton(G)),this._addButton("removalMode",new L.Control.PMButton(Z)),this._addButton("rotateMode",new L.Control.PMButton(W))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let C=this.getButtons(),k=[];this.options.drawControls===!1&&(k=k.concat(Object.keys(C).filter(B=>!C[B]._button.tool))),this.options.editControls===!1&&(k=k.concat(Object.keys(C).filter(B=>C[B]._button.tool==="edit"))),this.options.optionsControls===!1&&(k=k.concat(Object.keys(C).filter(B=>C[B]._button.tool==="options"))),this.options.customControls===!1&&(k=k.concat(Object.keys(C).filter(B=>C[B]._button.tool==="custom")));for(let B in C)if(this.options[B]&&k.indexOf(B)===-1){let P=C[B]._button.tool;P||(P="draw"),C[B].setPosition(this._getBtnPosition(P)),C[B].addTo(this.map)}},_getBtnPosition(C){return this.options.positions&&this.options.positions[C]?this.options.positions[C]:this.options.position},setBlockPosition(C,k){this.options.positions[C]=k,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(C,k){if(k)typeof k!="object"&&(k={name:k});else throw new TypeError("Button has no name");let B=this._btnNameMapping(C);if(!k.name)throw new TypeError("Button has no name");if(this.buttons[k.name])throw new TypeError("Button with this name already exists");let P=this.map.pm.Draw.createNewDrawInstance(k.name,B);k={...this.buttons[B]._button,...k};let A=this.createCustomControl(k);return{drawInstance:P,control:A}},createCustomControl(C){if(!C.name)throw new TypeError("Button has no name");if(this.buttons[C.name])throw new TypeError("Button with this name already exists");C.onClick||(C.onClick=()=>{}),C.afterClick||(C.afterClick=()=>{}),C.toggle!==!1&&(C.toggle=!0),C.block&&(C.block=C.block.toLowerCase()),(!C.block||C.block==="draw")&&(C.block=""),C.className?C.className.indexOf("control-icon")===-1&&(C.className=`control-icon ${C.className}`):C.className="control-icon";let k={tool:C.block,className:C.className,title:C.title||"",jsClass:C.name,onClick:C.onClick,afterClick:C.afterClick,doToggle:C.toggle,toggleStatus:!1,disableOtherButtons:C.disableOtherButtons??!0,disableByOtherButtons:C.disableByOtherButtons??!0,cssToggle:C.toggle,position:this.options.position,actions:C.actions||[],disabled:!!C.disabled};this.options[C.name]!==!1&&(this.options[C.name]=!0);let B=this._addButton(C.name,new L.Control.PMButton(k));return this.changeControlOrder(),B},controlExists(C){return!!this.getButton(C)},getButton(C){return this.getButtons()[C]},getButtonsInBlock(C){let k={};if(C)for(let B in this.getButtons()){let P=this.getButtons()[B];(P._button.tool===C||C==="draw"&&!P._button.tool)&&(k[B]=P)}return k},changeControlOrder(C=[]){let k=this._shapeMapping(),B=[];C.forEach(D=>{k[D]?B.push(k[D]):B.push(D)});let P=this.getButtons(),A={};B.forEach(D=>{P[D]&&(A[D]=P[D])}),Object.keys(P).filter(D=>!P[D]._button.tool||P[D]._button.tool==="draw").forEach(D=>{B.indexOf(D)===-1&&(A[D]=P[D])}),Object.keys(P).filter(D=>P[D]._button.tool==="edit").forEach(D=>{B.indexOf(D)===-1&&(A[D]=P[D])}),Object.keys(P).filter(D=>P[D]._button.tool==="options").forEach(D=>{B.indexOf(D)===-1&&(A[D]=P[D])}),Object.keys(P).filter(D=>P[D]._button.tool==="custom").forEach(D=>{B.indexOf(D)===-1&&(A[D]=P[D])}),Object.keys(P).forEach(D=>{B.indexOf(D)===-1&&(A[D]=P[D])}),this.map.pm.Toolbar.buttons=A,this._showHideButtons()},getControlOrder(){let C=this.getButtons(),k=[];for(let B in C)k.push(B);return k},changeActionsOfControl(C,k){let B=this._btnNameMapping(C);if(!B)throw new TypeError("No name passed");if(!k)throw new TypeError("No actions passed");if(!this.buttons[B])throw new TypeError("Button with this name not exists");this.buttons[B]._button.actions=k,this.changeControlOrder()},setButtonDisabled(C,k){let B=this._btnNameMapping(C);k?this.buttons[B].disable():this.buttons[B].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(C){let k=this._shapeMapping();return k[C]?k[C]:C}}),ls=di,hs=et(mn()),hr={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(C){C.forEach(k=>{if(Array.isArray(k)){this._assignEvents(k);return}k.off("drag",this._handleSnapping,this),k.on("drag",this._handleSnapping,this),k.off("dragend",this._cleanupSnapping,this),k.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(C){if(C){let k=C.target;k._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(k=>{k.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(C,k=!1){let B=C.target;if(B._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),C?.originalEvent?.altKey||this._map?.pm?.Keyboard.isAltKeyPressed())return!1;let P;if(k){if(!this._otherSnapLayers||this._otherSnapLayers.length===0)return!1;P=this._otherSnapLayers}else this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),P=this._snapList;if(P.length<=0)return!1;let A=this._calcClosestLayer(B.getLatLng(),P);if(Object.keys(A).length===0)return!1;let D=A.layer instanceof L.Marker||A.layer instanceof L.CircleMarker||!this.options.snapSegment,O;D?O=A.latlng:O=this._checkPrioritiySnapping(A);let F=this.options.snapDistance,G={marker:B,shape:this._shape,snapLatLng:O,segment:A.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:A.layer,distance:A.distance};if(this._fireSnapDrag(G.marker,G),this._fireSnapDrag(this._layer,G),A.distance<F){B._orgLatLng=B.getLatLng(),B.setLatLng(O),B._snapped=!0,B._snapInfo=G;let Z=()=>{this._snapLatLng=O,this._fireSnap(B,G),this._fireSnap(this._layer,G)},W=this._snapLatLng||{},V=O||{};(W.lat!==V.lat||W.lng!==V.lng)&&Z()}else this._snapLatLng&&(this._unsnap(G),B._snapped=!1,B._snapInfo=void 0,this._fireUnsnap(G.marker,G),this._fireUnsnap(this._layer,G));return!0},_createSnapList(){let C=[],k=[],B=this._map;B.off("layerremove",this._handleSnapLayerRemoval,this),B.on("layerremove",this._handleSnapLayerRemoval,this),B.eachLayer(P=>{if((P instanceof L.Polyline||P instanceof L.Marker||P instanceof L.CircleMarker||P instanceof L.ImageOverlay)&&P.options.snapIgnore!==!0){if(P.options.snapIgnore===void 0&&(!L.PM.optIn&&P.options.pmIgnore===!0||L.PM.optIn&&P.options.pmIgnore!==!1))return;(P instanceof L.Circle||P instanceof L.CircleMarker)&&P.pm&&P.pm._hiddenPolyCircle?C.push(P.pm._hiddenPolyCircle):P instanceof L.ImageOverlay&&(P=L.rectangle(P.getBounds())),C.push(P);let A=L.polyline([],{color:"red",pmIgnore:!0});A._pmTempLayer=!0,k.push(A),(P instanceof L.Circle||P instanceof L.CircleMarker)&&k.push(A)}}),C=C.filter(P=>this._layer!==P),C=C.filter(P=>P._latlng||P._latlngs&&qt(P._latlngs)),C=C.filter(P=>!P._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let P=L.polyline([],{color:"red",pmIgnore:!0});P._pmTempLayer=!0,k.push(P)}),this._snapList=C.concat(this._otherSnapLayers)):this._snapList=C,this.debugIndicatorLines=k},_handleSnapLayerRemoval({layer:C}){if(!C._leaflet_id)return;let k=this._snapList.findIndex(B=>B._leaflet_id===C._leaflet_id);k>-1&&this._snapList.splice(k,1)},_calcClosestLayer(C,k){return this._calcClosestLayers(C,k,1)[0]},_calcClosestLayers(C,k,B=1){let P=[],A={};k.forEach((O,F)=>{if(O._parentCopy&&O._parentCopy===this._layer||O.getLatLngs?.().flat(5).length<2)return;let G=this._calcLayerDistances(C,O);if(G.distance=Math.floor(G.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[F]){let Z=L.polyline([],{color:"red",pmIgnore:!0});Z._pmTempLayer=!0,this.debugIndicatorLines[F]=Z}this.debugIndicatorLines[F].setLatLngs([C,G.latlng])}B===1&&(A.distance===void 0||G.distance-5<=A.distance)?(G.distance+5<A.distance&&(P=[]),A=G,A.layer=O,P.push(A)):B!==1&&(A={},A=G,A.layer=O,P.push(A))}),B!==1&&(P=P.sort((O,F)=>O.distance-F.distance)),B===-1&&(B=P.length);let D=this._getClosestLayerByPriority(P,B);return L.Util.isArray(D)?D:[D]},_calcLayerDistances(C,k){let B=this._map,P=k instanceof L.Marker||k instanceof L.CircleMarker,A=k instanceof L.Polygon,D=C;if(P){let O=k.getLatLng();return{latlng:{...O},distance:this._getDistance(B,O,D)}}return this._calcLatLngDistances(D,k.getLatLngs(),B,A)},_calcLatLngDistances(C,k,B,P=!1){let A,D,O,F=G=>{G.forEach((Z,W)=>{if(Array.isArray(Z)){F(Z);return}if(this.options.snapSegment){let V=Z,rt;P?rt=W+1===G.length?0:W+1:rt=W+1===G.length?void 0:W+1;let st=G[rt];if(st){let vt=this._getDistanceToSegment(B,C,V,st);(D===void 0||vt<D)&&(D=vt,O=[V,st])}}else{let V=this._getDistance(B,C,Z);(D===void 0||V<D)&&(D=V,A=Z)}})};return F(k),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(B,C,O[0],O[1])},segment:O,distance:D}:{latlng:A,distance:D}},_getClosestLayerByPriority(C,k=1){C=C.sort((O,F)=>O._leaflet_id-F._leaflet_id);let B=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],P=this._map.pm.globalOptions.snappingOrder||[],A=0,D={};return P.concat(B).forEach(O=>{D[O]||(A+=1,D[O]=A)}),C.sort(ga("instanceofShape",D)),k===1?C[0]||{}:C.slice(0,k)},_checkPrioritiySnapping(C){let k=this._map,B=C.segment[0],P=C.segment[1],A=C.latlng,D=A;if(this.options.snapVertex){let O=this._getDistance(k,B,A),F=this._getDistance(k,P,A),G=O<F?B:P,Z=O<F?O:F;if(this.options.snapMiddle){let V=L.PM.Utils.calcMiddleLatLng(k,B,P),rt=this._getDistance(k,V,A);rt<O&&rt<F&&(G=V,Z=rt)}let W=this.options.snapDistance;Z<W&&(D=G)}return{...D}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(C,k,B,P){let A=C.getMaxZoom();A===1/0&&(A=C.getZoom());let D=C.project(k,A),O=C.project(B,A),F=C.project(P,A),G=L.LineUtil.closestPointOnSegment(D,O,F);return C.unproject(G,A)},_getDistanceToSegment(C,k,B,P){let A=C.latLngToContainerPoint(k),D=C.latLngToContainerPoint(B),O=C.latLngToContainerPoint(P);return L.LineUtil.pointToSegmentDistance(A,D,O)},_getDistance(C,k,B){return C.latLngToContainerPoint(k).distanceTo(C.latLngToContainerPoint(B))}},cs=hr,ds=L.Class.extend({includes:[cs,sn],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(C){L.Util.setOptions(this,C),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(C){let k=new L.Icon.Default;k.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=k,this._map=C,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(B=>{this[B]=new L.PM.Draw[B](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(C,k=!1){k?this.options.pathOptions=(0,hs.default)(this.options.pathOptions,C):this.options.pathOptions=C},getShapes(){return this.shapes},getShape(){return this._shape},enable(C,k){if(!C)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[C].enable(k)},disable(){this.shapes.forEach(C=>{this[C].disable()})},addControls(){this.shapes.forEach(C=>{this[C].addButton()})},getActiveShape(){let C;return this.shapes.forEach(k=>{this[k]._enabled&&(C=k)}),C},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let C=[];this._map.eachLayer(k=>{(k instanceof L.Polyline||k instanceof L.Marker||k instanceof L.Circle||k instanceof L.CircleMarker||k instanceof L.ImageOverlay)&&(k._pmTempLayer||C.push(k))}),this._enabled?C.forEach(k=>{L.PM.Utils.disablePopup(k)}):C.forEach(k=>{L.PM.Utils.enablePopup(k)})},createNewDrawInstance(C,k){let B=this._getShapeFromBtnName(k);if(this[C])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[B])throw new TypeError(`There is no class L.PM.Draw.${B}`);return this[C]=new L.PM.Draw[B](this._map),this[C].toolbarButtonName=C,this[C]._shape=C,this.shapes.push(C),this[k]&&this[C].setOptions(this[k].options),this[C].setOptions(this[C].options),this[C]},_getShapeFromBtnName(C){let k={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return k[C]?k[C]:this[C]?this[C]._shape:C},_finishLayer(C){C.pm&&(C.pm.setOptions(this.options),C.pm._shape=this._shape,C.pm._map=this._map),this._addDrawnLayerProp(C)},_addDrawnLayerProp(C){C._drawnByGeoman=!0},_setPane(C,k){k==="layerPane"?C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":k==="vertexPane"?C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":k==="markerPane"&&(C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),fe=ds;fe.Marker=fe.extend({initialize(C){this._map=C,this._shape="Marker",this.toolbarButtonName="drawMarker",this._layerIsDragging=!1},enable(C){L.Util.setOptions(this,C),this._enabled=!0,this._isTouchDevice=!ss(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._isTouchDevice?(this._createTouchHint(),this._hintMarker=L.marker(this._map.getCenter(),{...this.options.markerStyle,opacity:0,interactive:!1}),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0):(this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.on("mousemove",this._syncHintMarker,this)),this._layer=this._hintMarker,this.options.markerEditable&&this._map.eachLayer(k=>{this.isRelevantMarker(k)&&k.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._isTouchDevice?(this._removeTouchHint(),this._hintMarker=null):(this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this)),this._map.eachLayer(C=>{this.isRelevantMarker(C)&&C.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(C){this.enabled()?this.disable():this.enable(C)},isRelevantMarker(C){return C instanceof L.Marker&&C.pm&&!C._pmTempLayer&&!C.pm._initTextMarker},_syncHintMarker(C){if(this._hintMarker.setLatLng(C.latlng),this.options.snappable){let k=C;k.target=this._hintMarker,this._handleSnapping(k)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(C){if(!C.latlng||this._layerIsDragging||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng(),B=new L.Marker(k,this.options.markerStyle);this._setPane(B,"markerPane"),this._finishLayer(B),B.pm||(B.options.draggable=!1),B.addTo(this._map.pm._getContainingLayer()),B.pm&&this.options.markerEditable?B.pm.enable():B.dragging&&B.dragging.disable(),this._fireCreate(B),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){this.options.markerStyle?.icon&&this._hintMarker?.setIcon(this.options.markerStyle.icon)},_createTouchHint(){this.options.tooltips&&(this._touchHint=L.DomUtil.create("div","leaflet-pm-touch-hint"),this._touchHint.textContent=Wt("tooltips.placeMarkerTouch"),this._map.getContainer().appendChild(this._touchHint))},_removeTouchHint(){this._touchHint&&this._touchHint.parentNode&&(this._touchHint.parentNode.removeChild(this._touchHint),this._touchHint=null)}});var Te=63710088e-1,La={centimeters:Te*100,centimetres:Te*100,degrees:360/(2*Math.PI),feet:Te*3.28084,inches:Te*39.37,kilometers:Te/1e3,kilometres:Te/1e3,meters:Te,metres:Te,miles:Te/1609.344,millimeters:Te*1e3,millimetres:Te*1e3,nauticalmiles:Te/1852,radians:1,yards:Te*1.0936};function We(C,k,B={}){let P={type:"Feature"};return(B.id===0||B.id)&&(P.id=B.id),B.bbox&&(P.bbox=B.bbox),P.properties=k||{},P.geometry=C,P}function Gi(C,k,B={}){if(!C)throw new Error("coordinates is required");if(!Array.isArray(C))throw new Error("coordinates must be an Array");if(C.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ji(C[0])||!ji(C[1]))throw new Error("coordinates must contain numbers");return We({type:"Point",coordinates:C},k,B)}function an(C,k,B={}){if(C.length<2)throw new Error("coordinates must be an array of two or more positions");return We({type:"LineString",coordinates:C},k,B)}function Ie(C,k={}){let B={type:"FeatureCollection"};return k.id&&(B.id=k.id),k.bbox&&(B.bbox=k.bbox),B.features=C,B}function kn(C,k="kilometers"){let B=La[k];if(!B)throw new Error(k+" units is invalid");return C*B}function pi(C){return C%(2*Math.PI)*180/Math.PI}function Zi(C){return C%360*Math.PI/180}function ji(C){return!isNaN(C)&&C!==null&&!Array.isArray(C)}function ze(C){return C!==null&&typeof C=="object"&&!Array.isArray(C)}function ps(C){let k,B,P={type:"FeatureCollection",features:[]};if(C.type==="Feature"?B=C.geometry:B=C,B.type==="LineString")k=[B.coordinates];else if(B.type==="MultiLineString")k=B.coordinates;else if(B.type==="MultiPolygon")k=[].concat(...B.coordinates);else if(B.type==="Polygon")k=B.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return k.forEach(A=>{k.forEach(D=>{for(let O=0;O<A.length-1;O++)for(let F=O;F<D.length-1;F++){if(A===D&&(Math.abs(O-F)===1||O===0&&F===A.length-2&&A[O][0]===A[A.length-1][0]&&A[O][1]===A[A.length-1][1]))continue;let G=fs(A[O][0],A[O][1],A[O+1][0],A[O+1][1],D[F][0],D[F][1],D[F+1][0],D[F+1][1]);G&&P.features.push(Gi([G[0],G[1]]))}})}),P}function fs(C,k,B,P,A,D,O,F){let G,Z,W,V,rt,st={x:null,y:null,onLine1:!1,onLine2:!1};return G=(F-D)*(B-C)-(O-A)*(P-k),G===0?st.x!==null&&st.y!==null?st:!1:(Z=k-D,W=C-A,V=(O-A)*Z-(F-D)*W,rt=(B-C)*Z-(P-k)*W,Z=V/G,W=rt/G,st.x=C+Z*(B-C),st.y=k+Z*(P-k),Z>=0&&Z<=1&&(st.onLine1=!0),W>=0&&W<=1&&(st.onLine2=!0),st.onLine1&&st.onLine2?[st.x,st.y]:!1)}var Mn=ps;fe.Line=fe.extend({initialize(C){this._map=C,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(C){L.Util.setOptions(this,C),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(C){this.enabled()?this.disable():this.enable(C)},_syncHintLine(){let C=this._layer.getLatLngs();if(C.length>0){let k=C[C.length-1];this._hintline.setLatLngs([k,this._hintMarker.getLatLng()])}},_syncHintMarker(C){if(this._hintMarker.setLatLng(C.latlng),this.options.snappable){let B=C;B.target=this._hintMarker,this._handleSnapping(B)}else if(this._otherSnapLayers&&this._otherSnapLayers.length>0){let B=C;B.target=this._hintMarker,this._handleSnapping(B,!0)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let k=this._layer._defaultShape().slice();k.push(this._hintMarker.getLatLng()),this._change(k)},hasSelfIntersection(){return Mn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(C,k){let B=L.polyline(this._layer.getLatLngs());C&&(k||(k=this._hintMarker.getLatLng()),B.addLatLng(k));let P=Mn(B.toGeoJSON(15));this._doesSelfIntersect=P.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(P,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(C){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,C.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng(),B=this._layer.getLatLngs(),P=B[B.length-1];if(k.equals(B[0])||B.length>0&&k.equals(P)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:k,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(k);let A=this._createMarker(k);this._setTooltipText(),this._setHintLineAfterNewVertex(k),this._fireVertexAdded(A,void 0,k,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(C)},_setHintLineAfterNewVertex(C){this._hintline.setLatLngs([C,C])},_removeLastVertex(){let C=this._markers;if(C.length<=1){this.disable();return}let k=this._layer.getLatLngs(),B=C[C.length-1],{indexPath:P}=L.PM.Utils.findDeepMarkerIndex(C,B);C.pop(),this._layerGroup.removeLayer(B);let A=C[C.length-1],D=k.indexOf(A.getLatLng());k=k.slice(0,D+1),this._layer.setLatLngs(k),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(B,P,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let C=this._layer.getLatLngs();if(C.length<=1)return;let k=L.polyline(C,this.options.pathOptions);this._setPane(k,"layerPane"),this._finishLayer(k),k.addTo(this._map.pm._getContainingLayer()),this._fireCreate(k),this.options.snappable&&this._cleanupSnapping();let B=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(B))},_createMarker(C){let k=new L.Marker(C,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(k,"vertexPane"),k._pmTempLayer=!0,this._layerGroup.addLayer(k),this._markers.push(k),k.on("click",this._finishShape,this),k},_setTooltipText(){let{length:C}=this._layer.getLatLngs().flat(),k="";C<=1?k=Wt("tooltips.continueLine"):k=Wt("tooltips.finishLine"),this._hintMarker.setTooltipContent(k)},_change(C){this._fireChange(C,"Draw")},setStyle(){this._layer?.setStyle(this.options.templineStyle),this._hintline?.setStyle(this.options.hintlineStyle)}}),fe.Polygon=fe.Line.extend({initialize(C){this._map=C,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(C){L.PM.Draw.Line.prototype.enable.call(this,C),this._layer.pm._shape="Polygon"},_createMarker(C){let k=new L.Marker(C,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(k,"vertexPane"),k._pmTempLayer=!0,this._layerGroup.addLayer(k),this._markers.push(k),this._layer.getLatLngs().flat().length===1?(k.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(k)-1,this.options.snappable&&this._cleanupSnapping()):k.on("click",()=>1),k},_setTooltipText(){let{length:C}=this._layer.getLatLngs().flat(),k="";C<=2?k=Wt("tooltips.continueLine"):k=Wt("tooltips.finishPoly"),this._hintMarker.setTooltipContent(k)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let C=this._layer.getLatLngs();if(C.length<=2)return;let k=L.polygon(C,this.options.pathOptions);this._setPane(k,"layerPane"),this._finishLayer(k),k.addTo(this._map.pm._getContainingLayer()),this._fireCreate(k),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let B=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(B))}}),fe.Rectangle=fe.extend({initialize(C){this._map=C,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(C){if(L.Util.setOptions(this,C),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let k=0;k<2;k+=1){let B=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(B,"vertexPane"),B._pmTempLayer=!0,this._layerGroup.addLayer(B),this._styleMarkers.push(B)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(C){this.enabled()?this.disable():this.enable(C)},_placeStartingMarkers(C){this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(k),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(B=>{L.DomUtil.addClass(B._icon,"visible"),B.setLatLng(k)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(Wt("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let C=this._startMarker.getLatLng();C&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([C,C]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(C){if(this._hintMarker.setLatLng(C.latlng),this.options.snappable){let B=C;B.target=this._hintMarker,this._handleSnapping(B)}let k=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(k,"Draw")},_syncRectangleSize(){let C=os(this._startMarker.getLatLng(),this._map),k=os(this._hintMarker.getLatLng(),this._map),B=L.PM.Utils._getRotatedRectangle(C,k,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(B),this.options.cursorMarker&&this._styleMarkers){let P=[];B.forEach(A=>{!A.equals(C,1e-8)&&!A.equals(k,1e-8)&&P.push(A)}),P.forEach((A,D)=>{try{this._styleMarkers[D].setLatLng(A)}catch{}})}},_findCorners(){let C=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(C[0],C[2],this.options.rectangleAngle||0,this._map)},_finishShape(C){C?.latlng&&!this._hintMarker._snapped&&this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng(),B=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||B.equals(k))return;let P=L.rectangle([B,k],this.options.pathOptions);if(this.options.rectangleAngle){let D=L.PM.Utils._getRotatedRectangle(B,k,this.options.rectangleAngle||0,this._map);P.setLatLngs(D),P.pm&&P.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(P,"layerPane"),this._finishLayer(P),P.addTo(this._map.pm._getContainingLayer()),this._fireCreate(P);let A=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(A))},setStyle(){this._layer?.setStyle(this.options.pathOptions)}}),fe.CircleMarker=fe.extend({initialize(C){this._map=C,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(C){if(L.Util.setOptions(this,C),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let k={};L.extend(k,this.options.templineStyle),k.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),k),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(C=>{this.isRelevantMarker(C)&&C.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(C=>{this.isRelevantMarker(C)&&C.pm.disable()})},enabled(){return this._enabled},toggle(C){this.enabled()?this.disable():this.enable(C)},_placeCenterMarker(C){this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let k=this._hintMarker.getLatLng();this._centerMarker.setLatLng(k),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let C=this._centerMarker.getLatLng();C&&(this._layer.setLatLng(C),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(Wt("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let C=this._centerMarker.getLatLng(),k=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([C,k])},_syncCircleRadius(){let C=this._centerMarker.getLatLng(),k=this._hintMarker.getLatLng(),B=this._distanceCalculation(C,k);this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(B)},_syncHintMarker(C){if(this._hintMarker.setLatLng(C.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let B=C;B.target=this._hintMarker,this._handleSnapping(B)}this._handleHintMarkerSnapping();let k=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(k,"Draw")},isRelevantMarker(C){return C instanceof L.CircleMarker&&!(C instanceof L.Circle)&&C.pm&&!C._pmTempLayer},_createMarker(C){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!C.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng(),B=new this._BaseCircleClass(k,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(B,"layerPane"),this._finishLayer(B),B.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(B),this._fireCreate(B),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(C){C.pm&&this.options.markerEditable&&C.pm.enable()},_finishShape(C){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;C?.latlng&&!this._hintMarker._snapped&&this._hintMarker.setLatLng(C.latlng);let k=this._centerMarker.getLatLng(),B=this._defaultRadius;if(this.options[this._editableOption]){let O=this._hintMarker.getLatLng();B=this._distanceCalculation(k,O),this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?B=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]&&(B=this.options[this._maxRadiusOption])}let P={...this.options.pathOptions,radius:B},A=new this._BaseCircleClass(k,P);this._setPane(A,"layerPane"),this._finishLayer(A),A.addTo(this._map.pm._getContainingLayer()),A.pm&&A.pm._updateHiddenPolyCircle(),this._fireCreate(A);let D=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(D))},_getNewDestinationOfHintMarker(){let C=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return C;let k=this._centerMarker.getLatLng(),B=this._distanceCalculation(k,C);this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?C=zi(this._map,k,C,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]&&(C=zi(this._map,k,C,this._getMaxDistanceInMeter()))}return C},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let C=this._centerMarker.getLatLng(),k=this._hintMarker.getLatLng(),B=this._distanceCalculation(C,k);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){let C={};L.extend(C,this.options.templineStyle),this.options[this._editableOption]&&(C.radius=0),this._layer?.setStyle(C),this._hintline?.setStyle(this.options.hintlineStyle)},_distanceCalculation(C,k){return this._map.project(C).distanceTo(this._map.project(k))}}),fe.Circle=fe.CircleMarker.extend({initialize(C){this._map=C,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(C,k){return this._map.distance(C,k)}});var wn=class{constructor(C=[],k=cr){if(this.data=C,this.length=this.data.length,this.compare=k,this.length>0)for(let B=(this.length>>1)-1;B>=0;B--)this._down(B)}push(C){this.data.push(C),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let C=this.data[0],k=this.data.pop();return this.length--,this.length>0&&(this.data[0]=k,this._down(0)),C}peek(){return this.data[0]}_up(C){let{data:k,compare:B}=this,P=k[C];for(;C>0;){let A=C-1>>1,D=k[A];if(B(P,D)>=0)break;k[C]=D,C=A}k[C]=P}_down(C){let{data:k,compare:B}=this,P=this.length>>1,A=k[C];for(;C<P;){let D=(C<<1)+1,O=k[D],F=D+1;if(F<this.length&&B(k[F],O)<0&&(D=F,O=k[F]),B(O,A)>=0)break;k[C]=O,C=D}k[C]=A}};function cr(C,k){return C<k?-1:C>k?1:0}function _s(C,k){return C.p.x>k.p.x?1:C.p.x<k.p.x?-1:C.p.y!==k.p.y?C.p.y>k.p.y?1:-1:1}function Ca(C,k){return C.rightSweepEvent.p.x>k.rightSweepEvent.p.x?1:C.rightSweepEvent.p.x<k.rightSweepEvent.p.x?-1:C.rightSweepEvent.p.y!==k.rightSweepEvent.p.y?C.rightSweepEvent.p.y<k.rightSweepEvent.p.y?1:-1:1}var dr=class{constructor(C,k,B,P){this.p={x:C[0],y:C[1]},this.featureId=k,this.ringId=B,this.eventId=P,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(C){return this.p.x===C.p.x&&this.p.y===C.p.y}};function ba(C,k){if(C.type==="FeatureCollection"){let B=C.features;for(let P=0;P<B.length;P++)Ye(B[P],k)}else Ye(C,k)}var Be=0,si=0,En=0;function Ye(C,k){let B=C.type==="Feature"?C.geometry:C,P=B.coordinates;(B.type==="Polygon"||B.type==="MultiLineString")&&(P=[P]),B.type==="LineString"&&(P=[[P]]);for(let A=0;A<P.length;A++)for(let D=0;D<P[A].length;D++){let O=P[A][D][0],F=null;si=si+1;for(let G=0;G<P[A][D].length-1;G++){F=P[A][D][G+1];let Z=new dr(O,Be,si,En),W=new dr(F,Be,si,En+1);Z.otherEvent=W,W.otherEvent=Z,_s(Z,W)>0?(W.isLeftEndpoint=!0,Z.isLeftEndpoint=!1):(Z.isLeftEndpoint=!0,W.isLeftEndpoint=!1),k.push(Z),k.push(W),O=F,En=En+1}}Be=Be+1}var xa=class{constructor(C){this.leftSweepEvent=C,this.rightSweepEvent=C.otherEvent}};function Ui(C,k){if(C===null||k===null||C.leftSweepEvent.ringId===k.leftSweepEvent.ringId&&(C.rightSweepEvent.isSamePoint(k.leftSweepEvent)||C.rightSweepEvent.isSamePoint(k.leftSweepEvent)||C.rightSweepEvent.isSamePoint(k.rightSweepEvent)||C.leftSweepEvent.isSamePoint(k.leftSweepEvent)||C.leftSweepEvent.isSamePoint(k.rightSweepEvent)))return!1;let B=C.leftSweepEvent.p.x,P=C.leftSweepEvent.p.y,A=C.rightSweepEvent.p.x,D=C.rightSweepEvent.p.y,O=k.leftSweepEvent.p.x,F=k.leftSweepEvent.p.y,G=k.rightSweepEvent.p.x,Z=k.rightSweepEvent.p.y,W=(Z-F)*(A-B)-(G-O)*(D-P),V=(G-O)*(P-F)-(Z-F)*(B-O),rt=(A-B)*(P-F)-(D-P)*(B-O);if(W===0)return!1;let st=V/W,vt=rt/W;if(st>=0&&st<=1&&vt>=0&&vt<=1){let bt=B+st*(A-B),Pt=P+st*(D-P);return[bt,Pt]}return!1}function ka(C,k){k=k||!1;let B=[],P=new wn([],Ca);for(;C.length;){let A=C.pop();if(A.isLeftEndpoint){let D=new xa(A);for(let O=0;O<P.data.length;O++){let F=P.data[O];if(k&&F.leftSweepEvent.featureId===A.featureId)continue;let G=Ui(D,F);G!==!1&&B.push(G)}P.push(D)}else A.isLeftEndpoint===!1&&P.pop()}return B}function on(C,k){let B=new wn([],_s);return ba(C,B),ka(B,k)}var ms=on,Bn=ms;function gs(C,k,B={}){let{removeDuplicates:P=!0,ignoreSelfIntersections:A=!0}=B,D=[];C.type==="FeatureCollection"?D=D.concat(C.features):C.type==="Feature"?D.push(C):(C.type==="LineString"||C.type==="Polygon"||C.type==="MultiLineString"||C.type==="MultiPolygon")&&D.push(We(C)),k.type==="FeatureCollection"?D=D.concat(k.features):k.type==="Feature"?D.push(k):(k.type==="LineString"||k.type==="Polygon"||k.type==="MultiLineString"||k.type==="MultiPolygon")&&D.push(We(k));let O=Bn(Ie(D),A),F=[];if(P){let G={};O.forEach(Z=>{let W=Z.join(",");G[W]||(G[W]=!0,F.push(Z))})}else F=O;return Ie(F.map(G=>Gi(G)))}var Ne=gs,Pn=et(Yt(),1);function pr(C,k,B){if(C!==null)for(var P,A,D,O,F,G,Z,W=0,V=0,rt,st=C.type,vt=st==="FeatureCollection",bt=st==="Feature",Pt=vt?C.features.length:1,At=0;At<Pt;At++){Z=vt?C.features[At].geometry:bt?C.geometry:C,rt=Z?Z.type==="GeometryCollection":!1,F=rt?Z.geometries.length:1;for(var K=0;K<F;K++){var ht=0,yt=0;if(O=rt?Z.geometries[K]:Z,O!==null){G=O.coordinates;var Bt=O.type;switch(W=0,Bt){case null:break;case"Point":if(k(G,V,At,ht,yt)===!1)return!1;V++,ht++;break;case"LineString":case"MultiPoint":for(P=0;P<G.length;P++){if(k(G[P],V,At,ht,yt)===!1)return!1;V++,Bt==="MultiPoint"&&ht++}Bt==="LineString"&&ht++;break;case"Polygon":case"MultiLineString":for(P=0;P<G.length;P++){for(A=0;A<G[P].length-W;A++){if(k(G[P][A],V,At,ht,yt)===!1)return!1;V++}Bt==="MultiLineString"&&ht++,Bt==="Polygon"&&yt++}Bt==="Polygon"&&ht++;break;case"MultiPolygon":for(P=0;P<G.length;P++){for(yt=0,A=0;A<G[P].length;A++){for(D=0;D<G[P][A].length-W;D++){if(k(G[P][A][D],V,At,ht,yt)===!1)return!1;V++}yt++}ht++}break;case"GeometryCollection":for(P=0;P<O.geometries.length;P++)if(pr(O.geometries[P],k)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hi(C,k){if(C.type==="Feature")k(C,0);else if(C.type==="FeatureCollection")for(var B=0;B<C.features.length&&k(C.features[B],B)!==!1;B++);}function Ma(C,k,B){var P=B;return Hi(C,function(A,D){D===0&&B===void 0?P=A:P=k(P,A,D)}),P}function ai(C,k){var B,P,A,D,O,F,G,Z,W,V,rt=0,st=C.type==="FeatureCollection",vt=C.type==="Feature",bt=st?C.features.length:1;for(B=0;B<bt;B++){for(F=st?C.features[B].geometry:vt?C.geometry:C,Z=st?C.features[B].properties:vt?C.properties:{},W=st?C.features[B].bbox:vt?C.bbox:void 0,V=st?C.features[B].id:vt?C.id:void 0,G=F?F.type==="GeometryCollection":!1,O=G?F.geometries.length:1,A=0;A<O;A++){if(D=G?F.geometries[A]:F,D===null){if(k(null,rt,Z,W,V)===!1)return!1;continue}switch(D.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(k(D,rt,Z,W,V)===!1)return!1;break}case"GeometryCollection":{for(P=0;P<D.geometries.length;P++)if(k(D.geometries[P],rt,Z,W,V)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}rt++}}function fr(C,k){ai(C,function(B,P,A,D,O){var F=B===null?null:B.type;switch(F){case null:case"Point":case"LineString":case"Polygon":return k(We(B,A,{bbox:D,id:O}),P,0)===!1?!1:void 0}var G;switch(F){case"MultiPoint":G="Point";break;case"MultiLineString":G="LineString";break;case"MultiPolygon":G="Polygon";break}for(var Z=0;Z<B.coordinates.length;Z++){var W=B.coordinates[Z],V={type:G,coordinates:W};if(k(We(V,A),P,Z)===!1)return!1}})}function Le(C,k={}){if(C.bbox!=null&&k.recompute!==!0)return C.bbox;let B=[1/0,1/0,-1/0,-1/0];return pr(C,P=>{B[0]>P[0]&&(B[0]=P[0]),B[1]>P[1]&&(B[1]=P[1]),B[2]<P[0]&&(B[2]=P[0]),B[3]<P[1]&&(B[3]=P[1])}),B}function _r(C){var k;if(C.bbox)k=C.bbox;else if(Array.isArray(C)&&C.length===4)k=C;else if(Array.isArray(C)&&C.length===6)k=[C[0],C[1],C[3],C[4]];else if(C.type==="Feature")k=Le(C);else if(C.type==="FeatureCollection")k=Le(C);else throw new Error("invalid geojson");return{minX:k[0],minY:k[1],maxX:k[2],maxY:k[3]}}var oi=class{constructor(C=9){this.tree=new Pn.default(C),this.tree.toBBox=_r}insert(C){if(C.type!=="Feature")throw new Error("invalid feature");return C.bbox=C.bbox?C.bbox:Le(C),this.tree.insert(C),this}load(C){var k=[];return Array.isArray(C)?C.forEach(function(B){if(B.type!=="Feature")throw new Error("invalid features");B.bbox=B.bbox?B.bbox:Le(B),k.push(B)}):Hi(C,function(B){if(B.type!=="Feature")throw new Error("invalid features");B.bbox=B.bbox?B.bbox:Le(B),k.push(B)}),this.tree.load(k),this}remove(C,k){if(C.type!=="Feature")throw new Error("invalid feature");return C.bbox=C.bbox?C.bbox:Le(C),this.tree.remove(C,k),this}clear(){return this.tree.clear(),this}search(C){var k=this.tree.search(_r(C));return Ie(k)}collides(C){return this.tree.collides(_r(C))}all(){let C=this.tree.all();return Ie(C)}toJSON(){return this.tree.toJSON()}fromJSON(C){return this.tree.fromJSON(C),this}};function un(C){return new oi(C)}function ys(C,k){if(k=k??{},!ze(k))throw new Error("options is invalid");var B=k.precision,P=k.coordinates,A=k.mutate;if(B=B==null||isNaN(B)?6:B,P=P==null||isNaN(P)?3:P,!C)throw new Error("<geojson> is required");if(typeof B!="number")throw new Error("<precision> must be a number");if(typeof P!="number")throw new Error("<coordinates> must be a number");(A===!1||A===void 0)&&(C=JSON.parse(JSON.stringify(C)));var D=Math.pow(10,B);return pr(C,function(O){mr(O,D,P)}),C}function mr(C,k,B){C.length>B&&C.splice(B,C.length);for(var P=0;P<C.length;P++)C[P]=Math.round(C[P]*k)/k;return C}function Oe(C){if(!C)throw new Error("coord is required");if(!Array.isArray(C)){if(C.type==="Feature"&&C.geometry!==null&&C.geometry.type==="Point")return[...C.geometry.coordinates];if(C.type==="Point")return[...C.coordinates]}if(Array.isArray(C)&&C.length>=2&&!Array.isArray(C[0])&&!Array.isArray(C[1]))return[...C];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ui(C){if(Array.isArray(C))return C;if(C.type==="Feature"){if(C.geometry!==null)return C.geometry.coordinates}else if(C.coordinates)return C.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ki(C){return C.type==="Feature"?C.geometry:C}function Mi(C,k){return C.type==="FeatureCollection"?"FeatureCollection":C.type==="GeometryCollection"?"GeometryCollection":C.type==="Feature"&&C.geometry!==null?C.geometry.type:C.type}function Sn(C){if(!C)throw new Error("geojson is required");let k=[];return fr(C,B=>{gr(B,k)}),Ie(k)}function gr(C,k){let B=[],P=C.geometry;if(P!==null){switch(P.type){case"Polygon":B=ui(P);break;case"LineString":B=[ui(P)]}B.forEach(A=>{vs(A,C.properties).forEach(D=>{D.id=k.length,k.push(D)})})}}function vs(C,k){let B=[];return C.reduce((P,A)=>{let D=an([P,A],k);return D.bbox=wa(P,A),B.push(D),A}),B}function wa(C,k){let B=C[0],P=C[1],A=k[0],D=k[1],O=B<A?B:A,F=P<D?P:D,G=B>A?B:A,Z=P>D?P:D;return[O,F,G,Z]}function Vi(C,k,B={}){var P=Oe(C),A=Oe(k),D=Zi(A[1]-P[1]),O=Zi(A[0]-P[0]),F=Zi(P[1]),G=Zi(A[1]),Z=Math.pow(Math.sin(D/2),2)+Math.pow(Math.sin(O/2),2)*Math.cos(F)*Math.cos(G);return kn(2*Math.atan2(Math.sqrt(Z),Math.sqrt(1-Z)),B.units)}var Ea=Object.defineProperty,Ls=Object.defineProperties,Ba=Object.getOwnPropertyDescriptors,yr=Object.getOwnPropertySymbols,Pa=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,ln=(C,k,B)=>k in C?Ea(C,k,{enumerable:!0,configurable:!0,writable:!0,value:B}):C[k]=B,Sa=(C,k)=>{for(var B in k||(k={}))Pa.call(k,B)&&ln(C,B,k[B]);if(yr)for(var B of yr(k))Je.call(k,B)&&ln(C,B,k[B]);return C},An=(C,k)=>Ls(C,Ba(k));function Aa(C,k,B={}){if(!C||!k)throw new Error("lines and inputPoint are required arguments");let P=Oe(k),A=Gi([1/0,1/0],{lineStringIndex:-1,segmentIndex:-1,totalDistance:-1,lineDistance:-1,segmentDistance:-1,pointDistance:1/0,multiFeatureIndex:-1,index:-1,location:-1,dist:1/0}),D=0,O=0,F=-1;return fr(C,function(G,Z,W){F!==W&&(F=W,O=0);let V=ui(G),rt=V.length-2;for(let st=0;st<V.length-1;st++){let vt=Gi(V[st]),bt=Oe(vt),Pt=Gi(V[st+1]),At=Oe(Pt),K=Vi(vt,Pt,B),ht,yt;At[0]===P[0]&&At[1]===P[1]?[ht,yt]=[At,!0]:bt[0]===P[0]&&bt[1]===P[1]?[ht,yt]=[bt,!1]:[ht,yt]=xs(bt,At,P);let Bt=Vi(k,ht,B);if(Bt<A.properties.pointDistance){let wt=Vi(vt,ht,B);A=Gi(ht,{lineStringIndex:W,segmentIndex:yt&&st+1<=rt?st+1:st,totalDistance:D+wt,lineDistance:O+wt,segmentDistance:wt,pointDistance:Bt,multiFeatureIndex:-1,index:-1,location:-1,dist:1/0}),A.properties=An(Sa({},A.properties),{multiFeatureIndex:A.properties.lineStringIndex,index:A.properties.segmentIndex,location:A.properties.totalDistance,dist:A.properties.pointDistance})}D+=K,O+=K}}),A}function fi(C,k){let[B,P,A]=C,[D,O,F]=k;return B*D+P*O+A*F}function hn(C,k){let[B,P,A]=C,[D,O,F]=k;return[P*F-A*O,A*D-B*F,B*O-P*D]}function cn(C){return Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2)+Math.pow(C[2],2))}function Cs(C){let k=cn(C);return[C[0]/k,C[1]/k,C[2]/k]}function _i(C){let k=Zi(C[1]),B=Zi(C[0]);return[Math.cos(k)*Math.cos(B),Math.cos(k)*Math.sin(B),Math.sin(k)]}function bs(C){let[k,B,P]=C,A=Math.min(Math.max(P,-1),1),D=pi(Math.asin(A));return[pi(Math.atan2(B,k)),D]}function xs(C,k,B){let P=_i(C),A=_i(k),D=_i(B),O=hn(P,A);if(O[0]===0&&O[1]===0&&O[2]===0)return fi(P,A)>0?[[...k],!0]:[[...B],!1];let F=hn(O,D);if(F[0]===0&&F[1]===0&&F[2]===0)return[[...k],!0];let G=hn(F,O),Z=Cs(G),W=[-Z[0],-Z[1],-Z[2]],V=fi(D,Z)>fi(D,W)?Z:W,rt=Cs(O),st=fi(hn(P,V),rt),vt=fi(hn(V,A),rt);return st>=0&&vt>=0?[bs(V),!1]:fi(P,D)>fi(A,D)?[[...C],!1]:[[...k],!0]}function ks(C,k){if(!C)throw new Error("line is required");if(!k)throw new Error("splitter is required");let B=Mi(C),P=Mi(k);if(B!=="LineString")throw new Error("line must be LineString");if(P==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(P==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var A=ys(k,{precision:7});switch(C.type!=="Feature"&&(C=We(C)),P){case"Point":return Dn(C,A);case"MultiPoint":return Xe(C,A);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Xe(C,gs(C,A,{ignoreSelfIntersections:!0}))}}function Xe(C,k){var B=[],P=un();return fr(k,function(A){if(B.forEach(function(F,G){F.id=G}),!B.length)B=Dn(C,A).features,P.load(Ie(B));else{var D=P.search(A);if(D.features.length){var O=vr(A,D);B=B.filter(function(F){return F.id!==O.id}),P.remove(O),Hi(Dn(O,A),function(F){B.push(F),P.insert(F)})}}}),Ie(B)}function Dn(C,k){var B=[],P=ui(C)[0],A=ui(C)[C.geometry.coordinates.length-1];if(wi(P,Oe(k))||wi(A,Oe(k)))return Ie([C]);var D=un(),O=Sn(C);D.load(O);var F=D.search(k);if(!F.features.length)return Ie([C]);var G=vr(k,F),Z=[P],W=Ma(O,function(V,rt,st){var vt=ui(rt)[1],bt=Oe(k);return st===G.id?(V.push(bt),B.push(an(V)),wi(bt,vt)?[bt]:[bt,vt]):(V.push(vt),V)},Z);return W.length>1&&B.push(an(W)),Ie(B)}function vr(C,k){if(!k.features.length)throw new Error("lines must contain features");if(k.features.length===1)return k.features[0];var B,P=1/0;return Hi(k,function(A){var D=Aa(A,C),O=D.properties.dist;O<P&&(B=A,P=O)}),B}function wi(C,k){return C[0]===k[0]&&C[1]===k[1]}var Da=ks,Ge=11102230246251565e-32,ce=134217729,Ms=(3+8*Ge)*Ge;function Tn(C,k,B,P,A){let D,O,F,G,Z=k[0],W=P[0],V=0,rt=0;W>Z==W>-Z?(D=Z,Z=k[++V]):(D=W,W=P[++rt]);let st=0;if(V<C&&rt<B)for(W>Z==W>-Z?(O=Z+D,F=D-(O-Z),Z=k[++V]):(O=W+D,F=D-(O-W),W=P[++rt]),D=O,F!==0&&(A[st++]=F);V<C&&rt<B;)W>Z==W>-Z?(O=D+Z,G=O-D,F=D-(O-G)+(Z-G),Z=k[++V]):(O=D+W,G=O-D,F=D-(O-G)+(W-G),W=P[++rt]),D=O,F!==0&&(A[st++]=F);for(;V<C;)O=D+Z,G=O-D,F=D-(O-G)+(Z-G),Z=k[++V],D=O,F!==0&&(A[st++]=F);for(;rt<B;)O=D+W,G=O-D,F=D-(O-G)+(W-G),W=P[++rt],D=O,F!==0&&(A[st++]=F);return(D!==0||st===0)&&(A[st++]=D),st}function Ta(C,k){let B=k[0];for(let P=1;P<C;P++)B+=k[P];return B}function qi(C){return new Float64Array(C)}var ws=(3+16*Ge)*Ge,Es=(2+12*Ge)*Ge,Bs=(9+64*Ge)*Ge*Ge,Ei=qi(4),Ps=qi(8),Lr=qi(12),Cr=qi(16),Ce=qi(4);function _(C,k,B,P,A,D,O){let F,G,Z,W,V,rt,st,vt,bt,Pt,At,K,ht,yt,Bt,wt,Et,U,H=C-A,q=B-A,it=k-D,tt=P-D;yt=H*tt,rt=ce*H,st=rt-(rt-H),vt=H-st,rt=ce*tt,bt=rt-(rt-tt),Pt=tt-bt,Bt=vt*Pt-(yt-st*bt-vt*bt-st*Pt),wt=it*q,rt=ce*it,st=rt-(rt-it),vt=it-st,rt=ce*q,bt=rt-(rt-q),Pt=q-bt,Et=vt*Pt-(wt-st*bt-vt*bt-st*Pt),At=Bt-Et,V=Bt-At,Ei[0]=Bt-(At+V)+(V-Et),K=yt+At,V=K-yt,ht=yt-(K-V)+(At-V),At=ht-wt,V=ht-At,Ei[1]=ht-(At+V)+(V-wt),U=K+At,V=U-K,Ei[2]=K-(U-V)+(At-V),Ei[3]=U;let $=Ta(4,Ei),ct=Es*O;if($>=ct||-$>=ct||(V=C-H,F=C-(H+V)+(V-A),V=B-q,Z=B-(q+V)+(V-A),V=k-it,G=k-(it+V)+(V-D),V=P-tt,W=P-(tt+V)+(V-D),F===0&&G===0&&Z===0&&W===0)||(ct=Bs*O+Ms*Math.abs($),$+=H*W+tt*F-(it*Z+q*G),$>=ct||-$>=ct))return $;yt=F*tt,rt=ce*F,st=rt-(rt-F),vt=F-st,rt=ce*tt,bt=rt-(rt-tt),Pt=tt-bt,Bt=vt*Pt-(yt-st*bt-vt*bt-st*Pt),wt=G*q,rt=ce*G,st=rt-(rt-G),vt=G-st,rt=ce*q,bt=rt-(rt-q),Pt=q-bt,Et=vt*Pt-(wt-st*bt-vt*bt-st*Pt),At=Bt-Et,V=Bt-At,Ce[0]=Bt-(At+V)+(V-Et),K=yt+At,V=K-yt,ht=yt-(K-V)+(At-V),At=ht-wt,V=ht-At,Ce[1]=ht-(At+V)+(V-wt),U=K+At,V=U-K,Ce[2]=K-(U-V)+(At-V),Ce[3]=U;let nt=Tn(4,Ei,4,Ce,Ps);yt=H*W,rt=ce*H,st=rt-(rt-H),vt=H-st,rt=ce*W,bt=rt-(rt-W),Pt=W-bt,Bt=vt*Pt-(yt-st*bt-vt*bt-st*Pt),wt=it*Z,rt=ce*it,st=rt-(rt-it),vt=it-st,rt=ce*Z,bt=rt-(rt-Z),Pt=Z-bt,Et=vt*Pt-(wt-st*bt-vt*bt-st*Pt),At=Bt-Et,V=Bt-At,Ce[0]=Bt-(At+V)+(V-Et),K=yt+At,V=K-yt,ht=yt-(K-V)+(At-V),At=ht-wt,V=ht-At,Ce[1]=ht-(At+V)+(V-wt),U=K+At,V=U-K,Ce[2]=K-(U-V)+(At-V),Ce[3]=U;let ut=Tn(nt,Ps,4,Ce,Lr);yt=F*W,rt=ce*F,st=rt-(rt-F),vt=F-st,rt=ce*W,bt=rt-(rt-W),Pt=W-bt,Bt=vt*Pt-(yt-st*bt-vt*bt-st*Pt),wt=G*Z,rt=ce*G,st=rt-(rt-G),vt=G-st,rt=ce*Z,bt=rt-(rt-Z),Pt=Z-bt,Et=vt*Pt-(wt-st*bt-vt*bt-st*Pt),At=Bt-Et,V=Bt-At,Ce[0]=Bt-(At+V)+(V-Et),K=yt+At,V=K-yt,ht=yt-(K-V)+(At-V),At=ht-wt,V=ht-At,Ce[1]=ht-(At+V)+(V-wt),U=K+At,V=U-K,Ce[2]=K-(U-V)+(At-V),Ce[3]=U;let _t=Tn(ut,Lr,4,Ce,Cr);return Cr[_t-1]}function M(C,k,B,P,A,D){let O=(k-D)*(B-A),F=(C-A)*(P-D),G=O-F,Z=Math.abs(O+F);return Math.abs(G)>=ws*Z?G:-_(C,k,B,P,A,D,Z)}function S(C,k){var B,P,A=0,D,O,F,G,Z,W,V,rt=C[0],st=C[1],vt=k.length;for(B=0;B<vt;B++){P=0;var bt=k[B],Pt=bt.length-1;if(W=bt[0],W[0]!==bt[Pt][0]&&W[1]!==bt[Pt][1])throw new Error("First and last coordinates in a ring must be the same");for(O=W[0]-rt,F=W[1]-st,P;P<Pt;P++){if(V=bt[P+1],G=V[0]-rt,Z=V[1]-st,F===0&&Z===0){if(G<=0&&O>=0||O<=0&&G>=0)return 0}else if(Z>=0&&F<=0||Z<=0&&F>=0){if(D=M(O,G,F,Z,0,0),D===0)return 0;(D>0&&Z>0&&F<=0||D<0&&Z<=0&&F>0)&&A++}W=V,F=Z,O=G}}return A%2!==0}function T(C,k,B={}){if(!C)throw new Error("point is required");if(!k)throw new Error("polygon is required");let P=Oe(C),A=ki(k),D=A.type,O=k.bbox,F=A.coordinates;if(O&&R(P,O)===!1)return!1;D==="Polygon"&&(F=[F]);let G=!1;for(var Z=0;Z<F.length;++Z){let W=S(P,F[Z]);if(W===0)return!B.ignoreBoundary;W&&(G=!0)}return G}function R(C,k){return k[0]<=C[0]&&k[1]<=C[1]&&k[2]>=C[0]&&k[3]>=C[1]}function j(C,k,B={}){let P=Oe(C),A=ui(k);for(let D=0;D<A.length-1;D++){let O=!1;if(B.ignoreEndVertices&&(D===0&&(O="start"),D===A.length-2&&(O="end"),D===0&&D+1===A.length-1&&(O="both")),Q(A[D],A[D+1],P,O,typeof B.epsilon>"u"?null:B.epsilon))return!0}return!1}function Q(C,k,B,P,A){let D=B[0],O=B[1],F=C[0],G=C[1],Z=k[0],W=k[1],V=B[0]-F,rt=B[1]-G,st=Z-F,vt=W-G,bt=V*vt-rt*st;if(A!==null){if(Math.abs(bt)>A)return!1}else if(bt!==0)return!1;if(Math.abs(st)===Math.abs(vt)&&Math.abs(st)===0)return P?!1:B[0]===C[0]&&B[1]===C[1];if(P){if(P==="start")return Math.abs(st)>=Math.abs(vt)?st>0?F<D&&D<=Z:Z<=D&&D<F:vt>0?G<O&&O<=W:W<=O&&O<G;if(P==="end")return Math.abs(st)>=Math.abs(vt)?st>0?F<=D&&D<Z:Z<D&&D<=F:vt>0?G<=O&&O<W:W<O&&O<=G;if(P==="both")return Math.abs(st)>=Math.abs(vt)?st>0?F<D&&D<Z:Z<D&&D<F:vt>0?G<O&&O<W:W<O&&O<G}else return Math.abs(st)>=Math.abs(vt)?st>0?F<=D&&D<=Z:Z<=D&&D<=F:vt>0?G<=O&&O<=W:W<=O&&O<=G;return!1}function dt(C,k){let B=ki(C),P=ki(k),A=B.type,D=P.type,O=B.coordinates,F=P.coordinates;switch(A){case"Point":if(D==="Point")return br(O,F);throw new Error("feature2 "+D+" geometry not supported");case"MultiPoint":switch(D){case"Point":return Dt(B,P);case"MultiPoint":return It(B,P);default:throw new Error("feature2 "+D+" geometry not supported")}case"LineString":switch(D){case"Point":return j(P,B,{ignoreEndVertices:!0});case"LineString":return _e(B,P);case"MultiPoint":return Vt(B,P);default:throw new Error("feature2 "+D+" geometry not supported")}case"Polygon":switch(D){case"Point":return T(P,B,{ignoreBoundary:!0});case"LineString":return Pe(B,P);case"Polygon":return mi(B,P);case"MultiPoint":return be(B,P);case"MultiPolygon":return Mt(B,P);default:throw new Error("feature2 "+D+" geometry not supported")}case"MultiPolygon":if(D==="Polygon")return gt(B,P);throw new Error("feature2 "+D+" geometry not supported");default:throw new Error("feature1 "+A+" geometry not supported")}}function gt(C,k){return C.coordinates.some(B=>mi({type:"Polygon",coordinates:B},k))}function Mt(C,k){return k.coordinates.every(B=>mi(C,{type:"Polygon",coordinates:B}))}function Dt(C,k){let B,P=!1;for(B=0;B<C.coordinates.length;B++)if(br(C.coordinates[B],k.coordinates)){P=!0;break}return P}function It(C,k){for(let B of k.coordinates){let P=!1;for(let A of C.coordinates)if(br(B,A)){P=!0;break}if(!P)return!1}return!0}function Vt(C,k){let B=!1;for(let P of k.coordinates)if(j(P,C,{ignoreEndVertices:!0})&&(B=!0),!j(P,C))return!1;return!!B}function be(C,k){for(let B of k.coordinates)if(!T(B,C,{ignoreBoundary:!0}))return!1;return!0}function _e(C,k){let B=!1;for(let P of k.coordinates)if(j({type:"Point",coordinates:P},C,{ignoreEndVertices:!0})&&(B=!0),!j({type:"Point",coordinates:P},C,{ignoreEndVertices:!1}))return!1;return B}function Ze(C,k){let B=C.coordinates,P=[];for(let A=0;A<B.length-1;A++){let D=an([B[A],B[A+1]]),O=ks(D,We(k));O.features.length===0?P.push(D):P.push(...O.features)}return Ie(P)}function Pe(C,k){let B=Le(C),P=Le(k);if(!Ss(B,P))return!1;for(let O of k.coordinates)if(!T(O,C))return!1;let A=!1,D=Ze(k,C);for(let O of D.features){let F=Oa(O.geometry.coordinates[0],O.geometry.coordinates[1]);if(!T(F,C))return!1;!A&&T(F,C,{ignoreBoundary:!0})&&(A=!0)}return A}function mi(C,k){if(C.type==="Feature"&&C.geometry===null||k.type==="Feature"&&k.geometry===null)return!1;let B=Le(C),P=Le(k);if(!Ss(B,P))return!1;let A=ki(k).coordinates;for(let D of A)for(let O of D)if(!T(O,C))return!1;return!0}function Ss(C,k){return!(C[0]>k[0]||C[2]<k[2]||C[1]>k[1]||C[3]<k[3])}function br(C,k){return C[0]===k[0]&&C[1]===k[1]}function Oa(C,k){return[(C[0]+k[0])/2,(C[1]+k[1])/2]}var As=dt,Fa=et(hi()),Ds=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,se=Math.ceil,xe=Math.floor,Se="[BigNumber Error] ",Ts=Se+"Number primitive has more than 15 significant digits: ",He=1e14,Nt=14,On=9007199254740991,xr=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ki=1e7,ye=1e9;function Ua(C){var k,B,P,A=K.prototype={constructor:K,toString:null,valueOf:null},D=new K(1),O=20,F=4,G=-7,Z=21,W=-1e7,V=1e7,rt=!1,st=1,vt=0,bt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Pt="0123456789abcdefghijklmnopqrstuvwxyz",At=!0;function K(U,H){var q,it,tt,$,ct,nt,ut,_t,pt=this;if(!(pt instanceof K))return new K(U,H);if(H==null){if(U&&U._isBigNumber===!0){pt.s=U.s,!U.c||U.e>V?pt.c=pt.e=null:U.e<W?pt.c=[pt.e=0]:(pt.e=U.e,pt.c=U.c.slice());return}if((nt=typeof U=="number")&&U*0==0){if(pt.s=1/U<0?(U=-U,-1):1,U===~~U){for($=0,ct=U;ct>=10;ct/=10,$++);$>V?pt.c=pt.e=null:(pt.e=$,pt.c=[U]);return}_t=String(U)}else{if(!Ds.test(_t=String(U)))return P(pt,_t,nt);pt.s=_t.charCodeAt(0)==45?(_t=_t.slice(1),-1):1}($=_t.indexOf("."))>-1&&(_t=_t.replace(".","")),(ct=_t.search(/e/i))>0?($<0&&($=ct),$+=+_t.slice(ct+1),_t=_t.substring(0,ct)):$<0&&($=_t.length)}else{if(oe(H,2,Pt.length,"Base"),H==10&&At)return pt=new K(U),wt(pt,O+pt.e+1,F);if(_t=String(U),nt=typeof U=="number"){if(U*0!=0)return P(pt,_t,nt,H);if(pt.s=1/U<0?(_t=_t.slice(1),-1):1,K.DEBUG&&_t.replace(/^0\.0*|\./,"").length>15)throw Error(Ts+U)}else pt.s=_t.charCodeAt(0)===45?(_t=_t.slice(1),-1):1;for(q=Pt.slice(0,H),$=ct=0,ut=_t.length;ct<ut;ct++)if(q.indexOf(it=_t.charAt(ct))<0){if(it=="."){if(ct>$){$=ut;continue}}else if(!tt&&(_t==_t.toUpperCase()&&(_t=_t.toLowerCase())||_t==_t.toLowerCase()&&(_t=_t.toUpperCase()))){tt=!0,ct=-1,$=0;continue}return P(pt,String(U),nt,H)}nt=!1,_t=B(_t,H,10,pt.s),($=_t.indexOf("."))>-1?_t=_t.replace(".",""):$=_t.length}for(ct=0;_t.charCodeAt(ct)===48;ct++);for(ut=_t.length;_t.charCodeAt(--ut)===48;);if(_t=_t.slice(ct,++ut)){if(ut-=ct,nt&&K.DEBUG&&ut>15&&(U>On||U!==xe(U)))throw Error(Ts+pt.s*U);if(($=$-ct-1)>V)pt.c=pt.e=null;else if($<W)pt.c=[pt.e=0];else{if(pt.e=$,pt.c=[],ct=($+1)%Nt,$<0&&(ct+=Nt),ct<ut){for(ct&&pt.c.push(+_t.slice(0,ct)),ut-=Nt;ct<ut;)pt.c.push(+_t.slice(ct,ct+=Nt));ct=Nt-(_t=_t.slice(ct)).length}else ct-=ut;for(;ct--;_t+="0");pt.c.push(+_t)}}else pt.c=[pt.e=0]}K.clone=Ua,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(U){var H,q;if(U!=null)if(typeof U=="object"){if(U.hasOwnProperty(H="DECIMAL_PLACES")&&(q=U[H],oe(q,0,ye,H),O=q),U.hasOwnProperty(H="ROUNDING_MODE")&&(q=U[H],oe(q,0,8,H),F=q),U.hasOwnProperty(H="EXPONENTIAL_AT")&&(q=U[H],q&&q.pop?(oe(q[0],-ye,0,H),oe(q[1],0,ye,H),G=q[0],Z=q[1]):(oe(q,-ye,ye,H),G=-(Z=q<0?-q:q))),U.hasOwnProperty(H="RANGE"))if(q=U[H],q&&q.pop)oe(q[0],-ye,-1,H),oe(q[1],1,ye,H),W=q[0],V=q[1];else if(oe(q,-ye,ye,H),q)W=-(V=q<0?-q:q);else throw Error(Se+H+" cannot be zero: "+q);if(U.hasOwnProperty(H="CRYPTO"))if(q=U[H],q===!!q)if(q)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))rt=q;else throw rt=!q,Error(Se+"crypto unavailable");else rt=q;else throw Error(Se+H+" not true or false: "+q);if(U.hasOwnProperty(H="MODULO_MODE")&&(q=U[H],oe(q,0,9,H),st=q),U.hasOwnProperty(H="POW_PRECISION")&&(q=U[H],oe(q,0,ye,H),vt=q),U.hasOwnProperty(H="FORMAT"))if(q=U[H],typeof q=="object")bt=q;else throw Error(Se+H+" not an object: "+q);if(U.hasOwnProperty(H="ALPHABET"))if(q=U[H],typeof q=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(q))At=q.slice(0,10)=="0123456789",Pt=q;else throw Error(Se+H+" invalid: "+q)}else throw Error(Se+"Object expected: "+U);return{DECIMAL_PLACES:O,ROUNDING_MODE:F,EXPONENTIAL_AT:[G,Z],RANGE:[W,V],CRYPTO:rt,MODULO_MODE:st,POW_PRECISION:vt,FORMAT:bt,ALPHABET:Pt}},K.isBigNumber=function(U){if(!U||U._isBigNumber!==!0)return!1;if(!K.DEBUG)return!0;var H,q,it=U.c,tt=U.e,$=U.s;t:if({}.toString.call(it)=="[object Array]"){if(($===1||$===-1)&&tt>=-ye&&tt<=ye&&tt===xe(tt)){if(it[0]===0){if(tt===0&&it.length===1)return!0;break t}if(H=(tt+1)%Nt,H<1&&(H+=Nt),String(it[0]).length==H){for(H=0;H<it.length;H++)if(q=it[H],q<0||q>=He||q!==xe(q))break t;if(q!==0)return!0}}}else if(it===null&&tt===null&&($===null||$===1||$===-1))return!0;throw Error(Se+"Invalid BigNumber: "+U)},K.maximum=K.max=function(){return yt(arguments,-1)},K.minimum=K.min=function(){return yt(arguments,1)},K.random=(function(){var U=9007199254740992,H=Math.random()*U&2097151?function(){return xe(Math.random()*U)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(q){var it,tt,$,ct,nt,ut=0,_t=[],pt=new K(D);if(q==null?q=O:oe(q,0,ye),ct=se(q/Nt),rt)if(crypto.getRandomValues){for(it=crypto.getRandomValues(new Uint32Array(ct*=2));ut<ct;)nt=it[ut]*131072+(it[ut+1]>>>11),nt>=9e15?(tt=crypto.getRandomValues(new Uint32Array(2)),it[ut]=tt[0],it[ut+1]=tt[1]):(_t.push(nt%1e14),ut+=2);ut=ct/2}else if(crypto.randomBytes){for(it=crypto.randomBytes(ct*=7);ut<ct;)nt=(it[ut]&31)*281474976710656+it[ut+1]*1099511627776+it[ut+2]*4294967296+it[ut+3]*16777216+(it[ut+4]<<16)+(it[ut+5]<<8)+it[ut+6],nt>=9e15?crypto.randomBytes(7).copy(it,ut):(_t.push(nt%1e14),ut+=7);ut=ct/7}else throw rt=!1,Error(Se+"crypto unavailable");if(!rt)for(;ut<ct;)nt=H(),nt<9e15&&(_t[ut++]=nt%1e14);for(ct=_t[--ut],q%=Nt,ct&&q&&(nt=xr[Nt-q],_t[ut]=xe(ct/nt)*nt);_t[ut]===0;_t.pop(),ut--);if(ut<0)_t=[$=0];else{for($=-1;_t[0]===0;_t.splice(0,1),$-=Nt);for(ut=1,nt=_t[0];nt>=10;nt/=10,ut++);ut<Nt&&($-=Nt-ut)}return pt.e=$,pt.c=_t,pt}})(),K.sum=function(){for(var U=1,H=arguments,q=new K(H[0]);U<H.length;)q=q.plus(H[U++]);return q},B=(function(){var U="0123456789";function H(q,it,tt,$){for(var ct,nt=[0],ut,_t=0,pt=q.length;_t<pt;){for(ut=nt.length;ut--;nt[ut]*=it);for(nt[0]+=$.indexOf(q.charAt(_t++)),ct=0;ct<nt.length;ct++)nt[ct]>tt-1&&(nt[ct+1]==null&&(nt[ct+1]=0),nt[ct+1]+=nt[ct]/tt|0,nt[ct]%=tt)}return nt.reverse()}return function(q,it,tt,$,ct){var nt,ut,_t,pt,xt,Ot,Ft,jt,de=q.indexOf("."),ge=O,Xt=F;for(de>=0&&(pt=vt,vt=0,q=q.replace(".",""),jt=new K(it),Ot=jt.pow(q.length-de),vt=pt,jt.c=H(Bi(Qe(Ot.c),Ot.e,"0"),10,tt,U),jt.e=jt.c.length),Ft=H(q,it,tt,ct?(nt=Pt,U):(nt=U,Pt)),_t=pt=Ft.length;Ft[--pt]==0;Ft.pop());if(!Ft[0])return nt.charAt(0);if(de<0?--_t:(Ot.c=Ft,Ot.e=_t,Ot.s=$,Ot=k(Ot,jt,ge,Xt,tt),Ft=Ot.c,xt=Ot.r,_t=Ot.e),ut=_t+ge+1,de=Ft[ut],pt=tt/2,xt=xt||ut<0||Ft[ut+1]!=null,xt=Xt<4?(de!=null||xt)&&(Xt==0||Xt==(Ot.s<0?3:2)):de>pt||de==pt&&(Xt==4||xt||Xt==6&&Ft[ut-1]&1||Xt==(Ot.s<0?8:7)),ut<1||!Ft[0])q=xt?Bi(nt.charAt(1),-ge,nt.charAt(0)):nt.charAt(0);else{if(Ft.length=ut,xt)for(--tt;++Ft[--ut]>tt;)Ft[ut]=0,ut||(++_t,Ft=[1].concat(Ft));for(pt=Ft.length;!Ft[--pt];);for(de=0,q="";de<=pt;q+=nt.charAt(Ft[de++]));q=Bi(q,_t,nt.charAt(0))}return q}})(),k=(function(){function U(it,tt,$){var ct,nt,ut,_t,pt=0,xt=it.length,Ot=tt%Ki,Ft=tt/Ki|0;for(it=it.slice();xt--;)ut=it[xt]%Ki,_t=it[xt]/Ki|0,ct=Ft*ut+_t*Ot,nt=Ot*ut+ct%Ki*Ki+pt,pt=(nt/$|0)+(ct/Ki|0)+Ft*_t,it[xt]=nt%$;return pt&&(it=[pt].concat(it)),it}function H(it,tt,$,ct){var nt,ut;if($!=ct)ut=$>ct?1:-1;else for(nt=ut=0;nt<$;nt++)if(it[nt]!=tt[nt]){ut=it[nt]>tt[nt]?1:-1;break}return ut}function q(it,tt,$,ct){for(var nt=0;$--;)it[$]-=nt,nt=it[$]<tt[$]?1:0,it[$]=nt*ct+it[$]-tt[$];for(;!it[0]&&it.length>1;it.splice(0,1));}return function(it,tt,$,ct,nt){var ut,_t,pt,xt,Ot,Ft,jt,de,ge,Xt,te,Ae,Hs,Ga,Za,vi,Er,ti=it.s==tt.s?1:-1,Fe=it.c,pe=tt.c;if(!Fe||!Fe[0]||!pe||!pe[0])return new K(!it.s||!tt.s||(Fe?pe&&Fe[0]==pe[0]:!pe)?NaN:Fe&&Fe[0]==0||!pe?ti*0:ti/0);for(de=new K(ti),ge=de.c=[],_t=it.e-tt.e,ti=$+_t+1,nt||(nt=He,_t=$e(it.e/Nt)-$e(tt.e/Nt),ti=ti/Nt|0),pt=0;pe[pt]==(Fe[pt]||0);pt++);if(pe[pt]>(Fe[pt]||0)&&_t--,ti<0)ge.push(1),xt=!0;else{for(Ga=Fe.length,vi=pe.length,pt=0,ti+=2,Ot=xe(nt/(pe[0]+1)),Ot>1&&(pe=U(pe,Ot,nt),Fe=U(Fe,Ot,nt),vi=pe.length,Ga=Fe.length),Hs=vi,Xt=Fe.slice(0,vi),te=Xt.length;te<vi;Xt[te++]=0);Er=pe.slice(),Er=[0].concat(Er),Za=pe[0],pe[1]>=nt/2&&Za++;do{if(Ot=0,ut=H(pe,Xt,vi,te),ut<0){if(Ae=Xt[0],vi!=te&&(Ae=Ae*nt+(Xt[1]||0)),Ot=xe(Ae/Za),Ot>1)for(Ot>=nt&&(Ot=nt-1),Ft=U(pe,Ot,nt),jt=Ft.length,te=Xt.length;H(Ft,Xt,jt,te)==1;)Ot--,q(Ft,vi<jt?Er:pe,jt,nt),jt=Ft.length,ut=1;else Ot==0&&(ut=Ot=1),Ft=pe.slice(),jt=Ft.length;if(jt<te&&(Ft=[0].concat(Ft)),q(Xt,Ft,te,nt),te=Xt.length,ut==-1)for(;H(pe,Xt,vi,te)<1;)Ot++,q(Xt,vi<te?Er:pe,te,nt),te=Xt.length}else ut===0&&(Ot++,Xt=[0]);ge[pt++]=Ot,Xt[0]?Xt[te++]=Fe[Hs]||0:(Xt=[Fe[Hs]],te=1)}while((Hs++<Ga||Xt[0]!=null)&&ti--);xt=Xt[0]!=null,ge[0]||ge.splice(0,1)}if(nt==He){for(pt=1,ti=ge[0];ti>=10;ti/=10,pt++);wt(de,$+(de.e=pt+_t*Nt-1)+1,ct,xt)}else de.e=_t,de.r=+xt;return de}})();function ht(U,H,q,it){var tt,$,ct,nt,ut;if(q==null?q=F:oe(q,0,8),!U.c)return U.toString();if(tt=U.c[0],ct=U.e,H==null)ut=Qe(U.c),ut=it==1||it==2&&(ct<=G||ct>=Z)?Fs(ut,ct):Bi(ut,ct,"0");else if(U=wt(new K(U),H,q),$=U.e,ut=Qe(U.c),nt=ut.length,it==1||it==2&&(H<=$||$<=G)){for(;nt<H;ut+="0",nt++);ut=Fs(ut,$)}else if(H-=ct+(it===2&&$>ct),ut=Bi(ut,$,"0"),$+1>nt){if(--H>0)for(ut+=".";H--;ut+="0");}else if(H+=$-nt,H>0)for($+1==nt&&(ut+=".");H--;ut+="0");return U.s<0&&tt?"-"+ut:ut}function yt(U,H){for(var q,it,tt=1,$=new K(U[0]);tt<U.length;tt++)it=new K(U[tt]),(!it.s||(q=dn($,it))===H||q===0&&$.s===H)&&($=it);return $}function Bt(U,H,q){for(var it=1,tt=H.length;!H[--tt];H.pop());for(tt=H[0];tt>=10;tt/=10,it++);return(q=it+q*Nt-1)>V?U.c=U.e=null:q<W?U.c=[U.e=0]:(U.e=q,U.c=H),U}P=(function(){var U=/^(-?)0([xbo])(?=\w[\w.]*$)/i,H=/^([^.]+)\.$/,q=/^\.([^.]+)$/,it=/^-?(Infinity|NaN)$/,tt=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function($,ct,nt,ut){var _t,pt=nt?ct:ct.replace(tt,"");if(it.test(pt))$.s=isNaN(pt)?null:pt<0?-1:1;else{if(!nt&&(pt=pt.replace(U,function(xt,Ot,Ft){return _t=(Ft=Ft.toLowerCase())=="x"?16:Ft=="b"?2:8,!ut||ut==_t?Ot:xt}),ut&&(_t=ut,pt=pt.replace(H,"$1").replace(q,"0.$1")),ct!=pt))return new K(pt,_t);if(K.DEBUG)throw Error(Se+"Not a"+(ut?" base "+ut:"")+" number: "+ct);$.s=null}$.c=$.e=null}})();function wt(U,H,q,it){var tt,$,ct,nt,ut,_t,pt,xt=U.c,Ot=xr;if(xt){t:{for(tt=1,nt=xt[0];nt>=10;nt/=10,tt++);if($=H-tt,$<0)$+=Nt,ct=H,ut=xt[_t=0],pt=xe(ut/Ot[tt-ct-1]%10);else if(_t=se(($+1)/Nt),_t>=xt.length)if(it){for(;xt.length<=_t;xt.push(0));ut=pt=0,tt=1,$%=Nt,ct=$-Nt+1}else break t;else{for(ut=nt=xt[_t],tt=1;nt>=10;nt/=10,tt++);$%=Nt,ct=$-Nt+tt,pt=ct<0?0:xe(ut/Ot[tt-ct-1]%10)}if(it=it||H<0||xt[_t+1]!=null||(ct<0?ut:ut%Ot[tt-ct-1]),it=q<4?(pt||it)&&(q==0||q==(U.s<0?3:2)):pt>5||pt==5&&(q==4||it||q==6&&($>0?ct>0?ut/Ot[tt-ct]:0:xt[_t-1])%10&1||q==(U.s<0?8:7)),H<1||!xt[0])return xt.length=0,it?(H-=U.e+1,xt[0]=Ot[(Nt-H%Nt)%Nt],U.e=-H||0):xt[0]=U.e=0,U;if($==0?(xt.length=_t,nt=1,_t--):(xt.length=_t+1,nt=Ot[Nt-$],xt[_t]=ct>0?xe(ut/Ot[tt-ct]%Ot[ct])*nt:0),it)for(;;)if(_t==0){for($=1,ct=xt[0];ct>=10;ct/=10,$++);for(ct=xt[0]+=nt,nt=1;ct>=10;ct/=10,nt++);$!=nt&&(U.e++,xt[0]==He&&(xt[0]=1));break}else{if(xt[_t]+=nt,xt[_t]!=He)break;xt[_t--]=0,nt=1}for($=xt.length;xt[--$]===0;xt.pop());}U.e>V?U.c=U.e=null:U.e<W&&(U.c=[U.e=0])}return U}function Et(U){var H,q=U.e;return q===null?U.toString():(H=Qe(U.c),H=q<=G||q>=Z?Fs(H,q):Bi(H,q,"0"),U.s<0?"-"+H:H)}return A.absoluteValue=A.abs=function(){var U=new K(this);return U.s<0&&(U.s=1),U},A.comparedTo=function(U,H){return dn(this,new K(U,H))},A.decimalPlaces=A.dp=function(U,H){var q,it,tt,$=this;if(U!=null)return oe(U,0,ye),H==null?H=F:oe(H,0,8),wt(new K($),U+$.e+1,H);if(!(q=$.c))return null;if(it=((tt=q.length-1)-$e(this.e/Nt))*Nt,tt=q[tt])for(;tt%10==0;tt/=10,it--);return it<0&&(it=0),it},A.dividedBy=A.div=function(U,H){return k(this,new K(U,H),O,F)},A.dividedToIntegerBy=A.idiv=function(U,H){return k(this,new K(U,H),0,1)},A.exponentiatedBy=A.pow=function(U,H){var q,it,tt,$,ct,nt,ut,_t,pt,xt=this;if(U=new K(U),U.c&&!U.isInteger())throw Error(Se+"Exponent not an integer: "+Et(U));if(H!=null&&(H=new K(H)),nt=U.e>14,!xt.c||!xt.c[0]||xt.c[0]==1&&!xt.e&&xt.c.length==1||!U.c||!U.c[0])return pt=new K(Math.pow(+Et(xt),nt?U.s*(2-Os(U)):+Et(U))),H?pt.mod(H):pt;if(ut=U.s<0,H){if(H.c?!H.c[0]:!H.s)return new K(NaN);it=!ut&&xt.isInteger()&&H.isInteger(),it&&(xt=xt.mod(H))}else{if(U.e>9&&(xt.e>0||xt.e<-1||(xt.e==0?xt.c[0]>1||nt&&xt.c[1]>=24e7:xt.c[0]<8e13||nt&&xt.c[0]<=9999975e7)))return $=xt.s<0&&Os(U)?-0:0,xt.e>-1&&($=1/$),new K(ut?1/$:$);vt&&($=se(vt/Nt+2))}for(nt?(q=new K(.5),ut&&(U.s=1),_t=Os(U)):(tt=Math.abs(+Et(U)),_t=tt%2),pt=new K(D);;){if(_t){if(pt=pt.times(xt),!pt.c)break;$?pt.c.length>$&&(pt.c.length=$):it&&(pt=pt.mod(H))}if(tt){if(tt=xe(tt/2),tt===0)break;_t=tt%2}else if(U=U.times(q),wt(U,U.e+1,1),U.e>14)_t=Os(U);else{if(tt=+Et(U),tt===0)break;_t=tt%2}xt=xt.times(xt),$?xt.c&&xt.c.length>$&&(xt.c.length=$):it&&(xt=xt.mod(H))}return it?pt:(ut&&(pt=D.div(pt)),H?pt.mod(H):$?wt(pt,vt,F,ct):pt)},A.integerValue=function(U){var H=new K(this);return U==null?U=F:oe(U,0,8),wt(H,H.e+1,U)},A.isEqualTo=A.eq=function(U,H){return dn(this,new K(U,H))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(U,H){return dn(this,new K(U,H))>0},A.isGreaterThanOrEqualTo=A.gte=function(U,H){return(H=dn(this,new K(U,H)))===1||H===0},A.isInteger=function(){return!!this.c&&$e(this.e/Nt)>this.c.length-2},A.isLessThan=A.lt=function(U,H){return dn(this,new K(U,H))<0},A.isLessThanOrEqualTo=A.lte=function(U,H){return(H=dn(this,new K(U,H)))===-1||H===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(U,H){var q,it,tt,$,ct=this,nt=ct.s;if(U=new K(U,H),H=U.s,!nt||!H)return new K(NaN);if(nt!=H)return U.s=-H,ct.plus(U);var ut=ct.e/Nt,_t=U.e/Nt,pt=ct.c,xt=U.c;if(!ut||!_t){if(!pt||!xt)return pt?(U.s=-H,U):new K(xt?ct:NaN);if(!pt[0]||!xt[0])return xt[0]?(U.s=-H,U):new K(pt[0]?ct:F==3?-0:0)}if(ut=$e(ut),_t=$e(_t),pt=pt.slice(),nt=ut-_t){for(($=nt<0)?(nt=-nt,tt=pt):(_t=ut,tt=xt),tt.reverse(),H=nt;H--;tt.push(0));tt.reverse()}else for(it=($=(nt=pt.length)<(H=xt.length))?nt:H,nt=H=0;H<it;H++)if(pt[H]!=xt[H]){$=pt[H]<xt[H];break}if($&&(tt=pt,pt=xt,xt=tt,U.s=-U.s),H=(it=xt.length)-(q=pt.length),H>0)for(;H--;pt[q++]=0);for(H=He-1;it>nt;){if(pt[--it]<xt[it]){for(q=it;q&&!pt[--q];pt[q]=H);--pt[q],pt[it]+=He}pt[it]-=xt[it]}for(;pt[0]==0;pt.splice(0,1),--_t);return pt[0]?Bt(U,pt,_t):(U.s=F==3?-1:1,U.c=[U.e=0],U)},A.modulo=A.mod=function(U,H){var q,it,tt=this;return U=new K(U,H),!tt.c||!U.s||U.c&&!U.c[0]?new K(NaN):!U.c||tt.c&&!tt.c[0]?new K(tt):(st==9?(it=U.s,U.s=1,q=k(tt,U,0,3),U.s=it,q.s*=it):q=k(tt,U,0,st),U=tt.minus(q.times(U)),!U.c[0]&&st==1&&(U.s=tt.s),U)},A.multipliedBy=A.times=function(U,H){var q,it,tt,$,ct,nt,ut,_t,pt,xt,Ot,Ft,jt,de,ge,Xt=this,te=Xt.c,Ae=(U=new K(U,H)).c;if(!te||!Ae||!te[0]||!Ae[0])return!Xt.s||!U.s||te&&!te[0]&&!Ae||Ae&&!Ae[0]&&!te?U.c=U.e=U.s=null:(U.s*=Xt.s,!te||!Ae?U.c=U.e=null:(U.c=[0],U.e=0)),U;for(it=$e(Xt.e/Nt)+$e(U.e/Nt),U.s*=Xt.s,ut=te.length,xt=Ae.length,ut<xt&&(jt=te,te=Ae,Ae=jt,tt=ut,ut=xt,xt=tt),tt=ut+xt,jt=[];tt--;jt.push(0));for(de=He,ge=Ki,tt=xt;--tt>=0;){for(q=0,Ot=Ae[tt]%ge,Ft=Ae[tt]/ge|0,ct=ut,$=tt+ct;$>tt;)_t=te[--ct]%ge,pt=te[ct]/ge|0,nt=Ft*_t+pt*Ot,_t=Ot*_t+nt%ge*ge+jt[$]+q,q=(_t/de|0)+(nt/ge|0)+Ft*pt,jt[$--]=_t%de;jt[$]=q}return q?++it:jt.splice(0,1),Bt(U,jt,it)},A.negated=function(){var U=new K(this);return U.s=-U.s||null,U},A.plus=function(U,H){var q,it=this,tt=it.s;if(U=new K(U,H),H=U.s,!tt||!H)return new K(NaN);if(tt!=H)return U.s=-H,it.minus(U);var $=it.e/Nt,ct=U.e/Nt,nt=it.c,ut=U.c;if(!$||!ct){if(!nt||!ut)return new K(tt/0);if(!nt[0]||!ut[0])return ut[0]?U:new K(nt[0]?it:tt*0)}if($=$e($),ct=$e(ct),nt=nt.slice(),tt=$-ct){for(tt>0?(ct=$,q=ut):(tt=-tt,q=nt),q.reverse();tt--;q.push(0));q.reverse()}for(tt=nt.length,H=ut.length,tt-H<0&&(q=ut,ut=nt,nt=q,H=tt),tt=0;H;)tt=(nt[--H]=nt[H]+ut[H]+tt)/He|0,nt[H]=He===nt[H]?0:nt[H]%He;return tt&&(nt=[tt].concat(nt),++ct),Bt(U,nt,ct)},A.precision=A.sd=function(U,H){var q,it,tt,$=this;if(U!=null&&U!==!!U)return oe(U,1,ye),H==null?H=F:oe(H,0,8),wt(new K($),U,H);if(!(q=$.c))return null;if(tt=q.length-1,it=tt*Nt+1,tt=q[tt]){for(;tt%10==0;tt/=10,it--);for(tt=q[0];tt>=10;tt/=10,it++);}return U&&$.e+1>it&&(it=$.e+1),it},A.shiftedBy=function(U){return oe(U,-On,On),this.times("1e"+U)},A.squareRoot=A.sqrt=function(){var U,H,q,it,tt,$=this,ct=$.c,nt=$.s,ut=$.e,_t=O+4,pt=new K("0.5");if(nt!==1||!ct||!ct[0])return new K(!nt||nt<0&&(!ct||ct[0])?NaN:ct?$:1/0);if(nt=Math.sqrt(+Et($)),nt==0||nt==1/0?(H=Qe(ct),(H.length+ut)%2==0&&(H+="0"),nt=Math.sqrt(+H),ut=$e((ut+1)/2)-(ut<0||ut%2),nt==1/0?H="5e"+ut:(H=nt.toExponential(),H=H.slice(0,H.indexOf("e")+1)+ut),q=new K(H)):q=new K(nt+""),q.c[0]){for(ut=q.e,nt=ut+_t,nt<3&&(nt=0);;)if(tt=q,q=pt.times(tt.plus(k($,tt,_t,1))),Qe(tt.c).slice(0,nt)===(H=Qe(q.c)).slice(0,nt))if(q.e<ut&&--nt,H=H.slice(nt-3,nt+1),H=="9999"||!it&&H=="4999"){if(!it&&(wt(tt,tt.e+O+2,0),tt.times(tt).eq($))){q=tt;break}_t+=4,nt+=4,it=1}else{(!+H||!+H.slice(1)&&H.charAt(0)=="5")&&(wt(q,q.e+O+2,1),U=!q.times(q).eq($));break}}return wt(q,q.e+O+1,F,U)},A.toExponential=function(U,H){return U!=null&&(oe(U,0,ye),U++),ht(this,U,H,1)},A.toFixed=function(U,H){return U!=null&&(oe(U,0,ye),U=U+this.e+1),ht(this,U,H)},A.toFormat=function(U,H,q){var it,tt=this;if(q==null)U!=null&&H&&typeof H=="object"?(q=H,H=null):U&&typeof U=="object"?(q=U,U=H=null):q=bt;else if(typeof q!="object")throw Error(Se+"Argument not an object: "+q);if(it=tt.toFixed(U,H),tt.c){var $,ct=it.split("."),nt=+q.groupSize,ut=+q.secondaryGroupSize,_t=q.groupSeparator||"",pt=ct[0],xt=ct[1],Ot=tt.s<0,Ft=Ot?pt.slice(1):pt,jt=Ft.length;if(ut&&($=nt,nt=ut,ut=$,jt-=$),nt>0&&jt>0){for($=jt%nt||nt,pt=Ft.substr(0,$);$<jt;$+=nt)pt+=_t+Ft.substr($,nt);ut>0&&(pt+=_t+Ft.slice($)),Ot&&(pt="-"+pt)}it=xt?pt+(q.decimalSeparator||"")+((ut=+q.fractionGroupSize)?xt.replace(new RegExp("\\d{"+ut+"}\\B","g"),"$&"+(q.fractionGroupSeparator||"")):xt):pt}return(q.prefix||"")+it+(q.suffix||"")},A.toFraction=function(U){var H,q,it,tt,$,ct,nt,ut,_t,pt,xt,Ot,Ft=this,jt=Ft.c;if(U!=null&&(nt=new K(U),!nt.isInteger()&&(nt.c||nt.s!==1)||nt.lt(D)))throw Error(Se+"Argument "+(nt.isInteger()?"out of range: ":"not an integer: ")+Et(nt));if(!jt)return new K(Ft);for(H=new K(D),_t=q=new K(D),it=ut=new K(D),Ot=Qe(jt),$=H.e=Ot.length-Ft.e-1,H.c[0]=xr[(ct=$%Nt)<0?Nt+ct:ct],U=!U||nt.comparedTo(H)>0?$>0?H:_t:nt,ct=V,V=1/0,nt=new K(Ot),ut.c[0]=0;pt=k(nt,H,0,1),tt=q.plus(pt.times(it)),tt.comparedTo(U)!=1;)q=it,it=tt,_t=ut.plus(pt.times(tt=_t)),ut=tt,H=nt.minus(pt.times(tt=H)),nt=tt;return tt=k(U.minus(q),it,0,1),ut=ut.plus(tt.times(_t)),q=q.plus(tt.times(it)),ut.s=_t.s=Ft.s,$=$*2,xt=k(_t,it,$,F).minus(Ft).abs().comparedTo(k(ut,q,$,F).minus(Ft).abs())<1?[_t,it]:[ut,q],V=ct,xt},A.toNumber=function(){return+Et(this)},A.toPrecision=function(U,H){return U!=null&&oe(U,1,ye),ht(this,U,H,2)},A.toString=function(U){var H,q=this,it=q.s,tt=q.e;return tt===null?it?(H="Infinity",it<0&&(H="-"+H)):H="NaN":(U==null?H=tt<=G||tt>=Z?Fs(Qe(q.c),tt):Bi(Qe(q.c),tt,"0"):U===10&&At?(q=wt(new K(q),O+tt+1,F),H=Bi(Qe(q.c),q.e,"0")):(oe(U,2,Pt.length,"Base"),H=B(Bi(Qe(q.c),tt,"0"),10,U,it,!0)),it<0&&q.c[0]&&(H="-"+H)),H},A.valueOf=A.toJSON=function(){return Et(this)},A._isBigNumber=!0,A[Symbol.toStringTag]="BigNumber",A[Symbol.for("nodejs.util.inspect.custom")]=A.valueOf,C!=null&&K.set(C),K}function $e(C){var k=C|0;return C>0||C===k?k:k-1}function Qe(C){for(var k,B,P=1,A=C.length,D=C[0]+"";P<A;){for(k=C[P++]+"",B=Nt-k.length;B--;k="0"+k);D+=k}for(A=D.length;D.charCodeAt(--A)===48;);return D.slice(0,A+1||1)}function dn(C,k){var B,P,A=C.c,D=k.c,O=C.s,F=k.s,G=C.e,Z=k.e;if(!O||!F)return null;if(B=A&&!A[0],P=D&&!D[0],B||P)return B?P?0:-F:O;if(O!=F)return O;if(B=O<0,P=G==Z,!A||!D)return P?0:!A^B?1:-1;if(!P)return G>Z^B?1:-1;for(F=(G=A.length)<(Z=D.length)?G:Z,O=0;O<F;O++)if(A[O]!=D[O])return A[O]>D[O]^B?1:-1;return G==Z?0:G>Z^B?1:-1}function oe(C,k,B,P){if(C<k||C>B||C!==xe(C))throw Error(Se+(P||"Argument")+(typeof C=="number"?C<k||C>B?" out of range: ":" not an integer: ":" not a primitive number: ")+String(C))}function Os(C){var k=C.c.length-1;return $e(C.e/Nt)==k&&C.c[k]%2!=0}function Fs(C,k){return(C.length>1?C.charAt(0)+"."+C.slice(1):C)+(k<0?"e":"e+")+k}function Bi(C,k,B){var P,A;if(k<0){for(A=B+".";++k;A+=B);C=A+C}else if(P=C.length,++k>P){for(A=B,k-=P;--k;A+=B);C+=A}else k<P&&(C=C.slice(0,k)+"."+C.slice(k));return C}var ro=Ua(),gi=ro,so=class{key;left=null;right=null;constructor(C){this.key=C}},kr=class extends so{constructor(C){super(C)}},ao=class{size=0;modificationCount=0;splayCount=0;splay(C){let k=this.root;if(k==null)return this.compare(C,C),-1;let B=null,P=null,A=null,D=null,O=k,F=this.compare,G;for(;;)if(G=F(O.key,C),G>0){let Z=O.left;if(Z==null||(G=F(Z.key,C),G>0&&(O.left=Z.right,Z.right=O,O=Z,Z=O.left,Z==null)))break;B==null?P=O:B.left=O,B=O,O=Z}else if(G<0){let Z=O.right;if(Z==null||(G=F(Z.key,C),G<0&&(O.right=Z.left,Z.left=O,O=Z,Z=O.right,Z==null)))break;A==null?D=O:A.right=O,A=O,O=Z}else break;return A!=null&&(A.right=O.left,O.left=D),B!=null&&(B.left=O.right,O.right=P),this.root!==O&&(this.root=O,this.splayCount++),G}splayMin(C){let k=C,B=k.left;for(;B!=null;){let P=B;k.left=P.right,P.right=k,k=P,B=k.left}return k}splayMax(C){let k=C,B=k.right;for(;B!=null;){let P=B;k.right=P.left,P.left=k,k=P,B=k.right}return k}_delete(C){if(this.root==null||this.splay(C)!=0)return null;let k=this.root,B=k,P=k.left;if(this.size--,P==null)this.root=k.right;else{let A=k.right;k=this.splayMax(P),k.right=A,this.root=k}return this.modificationCount++,B}addNewRoot(C,k){this.size++,this.modificationCount++;let B=this.root;if(B==null){this.root=C;return}k<0?(C.left=B,C.right=B.right,B.right=null):(C.right=B,C.left=B.left,B.left=null),this.root=C}_first(){let C=this.root;return C==null?null:(this.root=this.splayMin(C),this.root)}_last(){let C=this.root;return C==null?null:(this.root=this.splayMax(C),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(C){return this.validKey(C)&&this.splay(C)==0}defaultCompare(){return(C,k)=>C<k?-1:C>k?1:0}wrap(){return{getRoot:()=>this.root,setRoot:C=>{this.root=C},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:C=>{this.splayCount=C},splay:C=>this.splay(C),has:C=>this.has(C)}}},Rs=class Br extends ao{root=null;compare;validKey;constructor(k,B){super(),this.compare=k??this.defaultCompare(),this.validKey=B??(P=>P!=null&&P!=null)}delete(k){return this.validKey(k)?this._delete(k)!=null:!1}deleteAll(k){for(let B of k)this.delete(B)}forEach(k){let B=this[Symbol.iterator](),P;for(;P=B.next(),!P.done;)k(P.value,P.value,this)}add(k){let B=this.splay(k);return B!=0&&this.addNewRoot(new kr(k),B),this}addAndReturn(k){let B=this.splay(k);return B!=0&&this.addNewRoot(new kr(k),B),this.root.key}addAll(k){for(let B of k)this.add(B)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(k){if(k==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(k)<0)return this.root.key;let B=this.root.left;if(B==null)return null;let P=B.right;for(;P!=null;)B=P,P=B.right;return B.key}firstAfter(k){if(k==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(k)>0)return this.root.key;let B=this.root.right;if(B==null)return null;let P=B.left;for(;P!=null;)B=P,P=B.left;return B.key}retainAll(k){let B=new Br(this.compare,this.validKey),P=this.modificationCount;for(let A of k){if(P!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(A)&&this.splay(A)==0&&B.add(this.root.key)}B.size!=this.size&&(this.root=B.root,this.size=B.size,this.modificationCount++)}lookup(k){return!this.validKey(k)||this.splay(k)!=0?null:this.root.key}intersection(k){let B=new Br(this.compare,this.validKey);for(let P of this)k.has(P)&&B.add(P);return B}difference(k){let B=new Br(this.compare,this.validKey);for(let P of this)k.has(P)||B.add(P);return B}union(k){let B=this.clone();return B.addAll(k),B}clone(){let k=new Br(this.compare,this.validKey);return k.size=this.size,k.root=this.copyNode(this.root),k}copyNode(k){if(k==null)return null;function B(A,D){let O,F;do{if(O=A.left,F=A.right,O!=null){let G=new kr(O.key);D.left=G,B(O,G)}if(F!=null){let G=new kr(F.key);D.right=G,A=F,D=G}}while(F!=null)}let P=new kr(k.key);return B(k,P),P}toSet(){return this.clone()}entries(){return new uo(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new oo(this.wrap())}[Symbol.toStringTag]="[object Set]"},Ha=class{tree;path=new Array;modificationCount=null;splayCount;constructor(C){this.tree=C,this.splayCount=C.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let C=this.path[this.path.length-1];return this.getValue(C)}rebuildPath(C){this.path.splice(0,this.path.length),this.tree.splay(C),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(C){for(;C!=null;)this.path.push(C),C=C.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let B=this.tree.getRoot();for(;B!=null;)this.path.push(B),B=B.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let C=this.path[this.path.length-1],k=C.right;if(k!=null){for(;k!=null;)this.path.push(k),k=k.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===C;)C=this.path.pop();return this.path.length>0}},oo=class extends Ha{getValue(C){return C.key}},uo=class extends Ha{getValue(C){return[C.key,C.key]}},Va=C=>()=>C,Ra=C=>{let k=C?(B,P)=>P.minus(B).abs().isLessThanOrEqualTo(C):Va(!1);return(B,P)=>k(B,P)?0:B.comparedTo(P)};function lo(C){let k=C?(B,P,A,D,O)=>B.exponentiatedBy(2).isLessThanOrEqualTo(D.minus(P).exponentiatedBy(2).plus(O.minus(A).exponentiatedBy(2)).times(C)):Va(!1);return(B,P,A)=>{let D=B.x,O=B.y,F=A.x,G=A.y,Z=O.minus(G).times(P.x.minus(F)).minus(D.minus(F).times(P.y.minus(G)));return k(Z,D,O,F,G)?0:Z.comparedTo(0)}}var ho=C=>C,co=C=>{if(C){let k=new Rs(Ra(C)),B=new Rs(Ra(C)),P=(D,O)=>O.addAndReturn(D),A=D=>({x:P(D.x,k),y:P(D.y,B)});return A({x:new gi(0),y:new gi(0)}),A}return ho},Ia=C=>({set:k=>{Pi=Ia(k)},reset:()=>Ia(C),compare:Ra(C),snap:co(C),orient:lo(C)}),Pi=Ia(),Mr=(C,k)=>C.ll.x.isLessThanOrEqualTo(k.x)&&k.x.isLessThanOrEqualTo(C.ur.x)&&C.ll.y.isLessThanOrEqualTo(k.y)&&k.y.isLessThanOrEqualTo(C.ur.y),za=(C,k)=>{if(k.ur.x.isLessThan(C.ll.x)||C.ur.x.isLessThan(k.ll.x)||k.ur.y.isLessThan(C.ll.y)||C.ur.y.isLessThan(k.ll.y))return null;let B=C.ll.x.isLessThan(k.ll.x)?k.ll.x:C.ll.x,P=C.ur.x.isLessThan(k.ur.x)?C.ur.x:k.ur.x,A=C.ll.y.isLessThan(k.ll.y)?k.ll.y:C.ll.y,D=C.ur.y.isLessThan(k.ur.y)?C.ur.y:k.ur.y;return{ll:{x:B,y:A},ur:{x:P,y:D}}},Is=(C,k)=>C.x.times(k.y).minus(C.y.times(k.x)),qa=(C,k)=>C.x.times(k.x).plus(C.y.times(k.y)),zs=C=>qa(C,C).sqrt(),po=(C,k,B)=>{let P={x:k.x.minus(C.x),y:k.y.minus(C.y)},A={x:B.x.minus(C.x),y:B.y.minus(C.y)};return Is(A,P).div(zs(A)).div(zs(P))},fo=(C,k,B)=>{let P={x:k.x.minus(C.x),y:k.y.minus(C.y)},A={x:B.x.minus(C.x),y:B.y.minus(C.y)};return qa(A,P).div(zs(A)).div(zs(P))},Ka=(C,k,B)=>k.y.isZero()?null:{x:C.x.plus(k.x.div(k.y).times(B.minus(C.y))),y:B},Wa=(C,k,B)=>k.x.isZero()?null:{x:B,y:C.y.plus(k.y.div(k.x).times(B.minus(C.x)))},_o=(C,k,B,P)=>{if(k.x.isZero())return Wa(B,P,C.x);if(P.x.isZero())return Wa(C,k,B.x);if(k.y.isZero())return Ka(B,P,C.y);if(P.y.isZero())return Ka(C,k,B.y);let A=Is(k,P);if(A.isZero())return null;let D={x:B.x.minus(C.x),y:B.y.minus(C.y)},O=Is(D,k).div(A),F=Is(D,P).div(A),G=C.x.plus(F.times(k.x)),Z=B.x.plus(O.times(P.x)),W=C.y.plus(F.times(k.y)),V=B.y.plus(O.times(P.y)),rt=G.plus(Z).div(2),st=W.plus(V).div(2);return{x:rt,y:st}},yi=class no{point;isLeft;segment;otherSE;consumedBy;static compare(k,B){let P=no.comparePoints(k.point,B.point);return P!==0?P:(k.point!==B.point&&k.link(B),k.isLeft!==B.isLeft?k.isLeft?1:-1:Gs.compare(k.segment,B.segment))}static comparePoints(k,B){return k.x.isLessThan(B.x)?-1:k.x.isGreaterThan(B.x)?1:k.y.isLessThan(B.y)?-1:k.y.isGreaterThan(B.y)?1:0}constructor(k,B){k.events===void 0?k.events=[this]:k.events.push(this),this.point=k,this.isLeft=B}link(k){if(k.point===this.point)throw new Error("Tried to link already linked events");let B=k.point.events;for(let P=0,A=B.length;P<A;P++){let D=B[P];this.point.events.push(D),D.point=this.point}this.checkForConsuming()}checkForConsuming(){let k=this.point.events.length;for(let B=0;B<k;B++){let P=this.point.events[B];if(P.segment.consumedBy===void 0)for(let A=B+1;A<k;A++){let D=this.point.events[A];D.consumedBy===void 0&&P.otherSE.point.events===D.otherSE.point.events&&P.segment.consume(D.segment)}}}getAvailableLinkedEvents(){let k=[];for(let B=0,P=this.point.events.length;B<P;B++){let A=this.point.events[B];A!==this&&!A.segment.ringOut&&A.segment.isInResult()&&k.push(A)}return k}getLeftmostComparator(k){let B=new Map,P=A=>{let D=A.otherSE;B.set(A,{sine:po(this.point,k.point,D.point),cosine:fo(this.point,k.point,D.point)})};return(A,D)=>{B.has(A)||P(A),B.has(D)||P(D);let{sine:O,cosine:F}=B.get(A),{sine:G,cosine:Z}=B.get(D);return O.isGreaterThanOrEqualTo(0)&&G.isGreaterThanOrEqualTo(0)?F.isLessThan(Z)?1:F.isGreaterThan(Z)?-1:0:O.isLessThan(0)&&G.isLessThan(0)?F.isLessThan(Z)?-1:F.isGreaterThan(Z)?1:0:G.isLessThan(O)?-1:G.isGreaterThan(O)?1:0}}},mo=class ja{events;poly;_isExteriorRing;_enclosingRing;static factory(k){let B=[];for(let P=0,A=k.length;P<A;P++){let D=k[P];if(!D.isInResult()||D.ringOut)continue;let O=null,F=D.leftSE,G=D.rightSE,Z=[F],W=F.point,V=[];for(;O=F,F=G,Z.push(F),F.point!==W;)for(;;){let rt=F.getAvailableLinkedEvents();if(rt.length===0){let bt=Z[0].point,Pt=Z[Z.length-1].point;throw new Error(`Unable to complete output ring starting at [${bt.x}, ${bt.y}]. Last matching segment found ends at [${Pt.x}, ${Pt.y}].`)}if(rt.length===1){G=rt[0].otherSE;break}let st=null;for(let bt=0,Pt=V.length;bt<Pt;bt++)if(V[bt].point===F.point){st=bt;break}if(st!==null){let bt=V.splice(st)[0],Pt=Z.splice(bt.index);Pt.unshift(Pt[0].otherSE),B.push(new ja(Pt.reverse()));continue}V.push({index:Z.length,point:F.point});let vt=F.getLeftmostComparator(O);G=rt.sort(vt)[0].otherSE;break}B.push(new ja(Z))}return B}constructor(k){this.events=k;for(let B=0,P=k.length;B<P;B++)k[B].segment.ringOut=this;this.poly=null}getGeom(){let k=this.events[0].point,B=[k];for(let Z=1,W=this.events.length-1;Z<W;Z++){let V=this.events[Z].point,rt=this.events[Z+1].point;Pi.orient(V,k,rt)!==0&&(B.push(V),k=V)}if(B.length===1)return null;let P=B[0],A=B[1];Pi.orient(P,k,A)===0&&B.shift(),B.push(B[0]);let D=this.isExteriorRing()?1:-1,O=this.isExteriorRing()?0:B.length-1,F=this.isExteriorRing()?B.length:-1,G=[];for(let Z=O;Z!=F;Z+=D)G.push([B[Z].x.toNumber(),B[Z].y.toNumber()]);return G}isExteriorRing(){if(this._isExteriorRing===void 0){let k=this.enclosingRing();this._isExteriorRing=k?!k.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let k=this.events[0];for(let A=1,D=this.events.length;A<D;A++){let O=this.events[A];yi.compare(k,O)>0&&(k=O)}let B=k.segment.prevInResult(),P=B?B.prevInResult():null;for(;;){if(!B)return null;if(!P)return B.ringOut;if(P.ringOut!==B.ringOut)return P.ringOut?.enclosingRing()!==B.ringOut?B.ringOut:B.ringOut?.enclosingRing();B=P.prevInResult(),P=B?B.prevInResult():null}}},Ya=class{exteriorRing;interiorRings;constructor(C){this.exteriorRing=C,C.poly=this,this.interiorRings=[]}addInterior(C){this.interiorRings.push(C),C.poly=this}getGeom(){let C=this.exteriorRing.getGeom();if(C===null)return null;let k=[C];for(let B=0,P=this.interiorRings.length;B<P;B++){let A=this.interiorRings[B].getGeom();A!==null&&k.push(A)}return k}},go=class{rings;polys;constructor(C){this.rings=C,this.polys=this._composePolys(C)}getGeom(){let C=[];for(let k=0,B=this.polys.length;k<B;k++){let P=this.polys[k].getGeom();P!==null&&C.push(P)}return C}_composePolys(C){let k=[];for(let B=0,P=C.length;B<P;B++){let A=C[B];if(!A.poly)if(A.isExteriorRing())k.push(new Ya(A));else{let D=A.enclosingRing();D?.poly||k.push(new Ya(D)),D?.poly?.addInterior(A)}}return k}},yo=class{queue;tree;segments;constructor(C,k=Gs.compare){this.queue=C,this.tree=new Rs(k),this.segments=[]}process(C){let k=C.segment,B=[];if(C.consumedBy)return C.isLeft?this.queue.delete(C.otherSE):this.tree.delete(k),B;C.isLeft&&this.tree.add(k);let P=k,A=k;do P=this.tree.lastBefore(P);while(P!=null&&P.consumedBy!=null);do A=this.tree.firstAfter(A);while(A!=null&&A.consumedBy!=null);if(C.isLeft){let D=null;if(P){let F=P.getIntersection(k);if(F!==null&&(k.isAnEndpoint(F)||(D=F),!P.isAnEndpoint(F))){let G=this._splitSafely(P,F);for(let Z=0,W=G.length;Z<W;Z++)B.push(G[Z])}}let O=null;if(A){let F=A.getIntersection(k);if(F!==null&&(k.isAnEndpoint(F)||(O=F),!A.isAnEndpoint(F))){let G=this._splitSafely(A,F);for(let Z=0,W=G.length;Z<W;Z++)B.push(G[Z])}}if(D!==null||O!==null){let F=null;D===null?F=O:O===null?F=D:F=yi.comparePoints(D,O)<=0?D:O,this.queue.delete(k.rightSE),B.push(k.rightSE);let G=k.split(F);for(let Z=0,W=G.length;Z<W;Z++)B.push(G[Z])}B.length>0?(this.tree.delete(k),B.push(C)):(this.segments.push(k),k.prev=P)}else{if(P&&A){let D=P.getIntersection(A);if(D!==null){if(!P.isAnEndpoint(D)){let O=this._splitSafely(P,D);for(let F=0,G=O.length;F<G;F++)B.push(O[F])}if(!A.isAnEndpoint(D)){let O=this._splitSafely(A,D);for(let F=0,G=O.length;F<G;F++)B.push(O[F])}}}this.tree.delete(k)}return B}_splitSafely(C,k){this.tree.delete(C);let B=C.rightSE;this.queue.delete(B);let P=C.split(k);return P.push(B),C.consumedBy===void 0&&this.tree.add(C),P}},vo=class{type;numMultiPolys;run(C,k,B){wr.type=C;let P=[new Xa(k,!0)];for(let G=0,Z=B.length;G<Z;G++)P.push(new Xa(B[G],!1));if(wr.numMultiPolys=P.length,wr.type==="difference"){let G=P[0],Z=1;for(;Z<P.length;)za(P[Z].bbox,G.bbox)!==null?Z++:P.splice(Z,1)}if(wr.type==="intersection")for(let G=0,Z=P.length;G<Z;G++){let W=P[G];for(let V=G+1,rt=P.length;V<rt;V++)if(za(W.bbox,P[V].bbox)===null)return[]}let A=new Rs(yi.compare);for(let G=0,Z=P.length;G<Z;G++){let W=P[G].getSweepEvents();for(let V=0,rt=W.length;V<rt;V++)A.add(W[V])}let D=new yo(A),O=null;for(A.size!=0&&(O=A.first(),A.delete(O));O;){let G=D.process(O);for(let Z=0,W=G.length;Z<W;Z++){let V=G[Z];V.consumedBy===void 0&&A.add(V)}A.size!=0?(O=A.first(),A.delete(O)):O=null}Pi.reset();let F=mo.factory(D.segments);return new go(F).getGeom()}},wr=new vo,Ns=wr,Lo=0,Gs=class Vs{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(k,B){let P=k.leftSE.point.x,A=B.leftSE.point.x,D=k.rightSE.point.x,O=B.rightSE.point.x;if(O.isLessThan(P))return 1;if(D.isLessThan(A))return-1;let F=k.leftSE.point.y,G=B.leftSE.point.y,Z=k.rightSE.point.y,W=B.rightSE.point.y;if(P.isLessThan(A)){if(G.isLessThan(F)&&G.isLessThan(Z))return 1;if(G.isGreaterThan(F)&&G.isGreaterThan(Z))return-1;let V=k.comparePoint(B.leftSE.point);if(V<0)return 1;if(V>0)return-1;let rt=B.comparePoint(k.rightSE.point);return rt!==0?rt:-1}if(P.isGreaterThan(A)){if(F.isLessThan(G)&&F.isLessThan(W))return-1;if(F.isGreaterThan(G)&&F.isGreaterThan(W))return 1;let V=B.comparePoint(k.leftSE.point);if(V!==0)return V;let rt=k.comparePoint(B.rightSE.point);return rt<0?1:rt>0?-1:1}if(F.isLessThan(G))return-1;if(F.isGreaterThan(G))return 1;if(D.isLessThan(O)){let V=B.comparePoint(k.rightSE.point);if(V!==0)return V}if(D.isGreaterThan(O)){let V=k.comparePoint(B.rightSE.point);if(V<0)return 1;if(V>0)return-1}if(!D.eq(O)){let V=Z.minus(F),rt=D.minus(P),st=W.minus(G),vt=O.minus(A);if(V.isGreaterThan(rt)&&st.isLessThan(vt))return 1;if(V.isLessThan(rt)&&st.isGreaterThan(vt))return-1}return D.isGreaterThan(O)?1:D.isLessThan(O)||Z.isLessThan(W)?-1:Z.isGreaterThan(W)?1:k.id<B.id?-1:k.id>B.id?1:0}constructor(k,B,P,A){this.id=++Lo,this.leftSE=k,k.segment=this,k.otherSE=B,this.rightSE=B,B.segment=this,B.otherSE=k,this.rings=P,this.windings=A}static fromRing(k,B,P){let A,D,O,F=yi.comparePoints(k,B);if(F<0)A=k,D=B,O=1;else if(F>0)A=B,D=k,O=-1;else throw new Error(`Tried to create degenerate segment at [${k.x}, ${k.y}]`);let G=new yi(A,!0),Z=new yi(D,!1);return new Vs(G,Z,[P],[O])}replaceRightSE(k){this.rightSE=k,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let k=this.leftSE.point.y,B=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:k.isLessThan(B)?k:B},ur:{x:this.rightSE.point.x,y:k.isGreaterThan(B)?k:B}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(k){return k.x.eq(this.leftSE.point.x)&&k.y.eq(this.leftSE.point.y)||k.x.eq(this.rightSE.point.x)&&k.y.eq(this.rightSE.point.y)}comparePoint(k){return Pi.orient(this.leftSE.point,k,this.rightSE.point)}getIntersection(k){let B=this.bbox(),P=k.bbox(),A=za(B,P);if(A===null)return null;let D=this.leftSE.point,O=this.rightSE.point,F=k.leftSE.point,G=k.rightSE.point,Z=Mr(B,F)&&this.comparePoint(F)===0,W=Mr(P,D)&&k.comparePoint(D)===0,V=Mr(B,G)&&this.comparePoint(G)===0,rt=Mr(P,O)&&k.comparePoint(O)===0;if(W&&Z)return rt&&!V?O:!rt&&V?G:null;if(W)return V&&D.x.eq(G.x)&&D.y.eq(G.y)?null:D;if(Z)return rt&&O.x.eq(F.x)&&O.y.eq(F.y)?null:F;if(rt&&V)return null;if(rt)return O;if(V)return G;let st=_o(D,this.vector(),F,k.vector());return st===null||!Mr(A,st)?null:Pi.snap(st)}split(k){let B=[],P=k.events!==void 0,A=new yi(k,!0),D=new yi(k,!1),O=this.rightSE;this.replaceRightSE(D),B.push(D),B.push(A);let F=new Vs(A,O,this.rings.slice(),this.windings.slice());return yi.comparePoints(F.leftSE.point,F.rightSE.point)>0&&F.swapEvents(),yi.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),P&&(A.checkForConsuming(),D.checkForConsuming()),B}swapEvents(){let k=this.rightSE;this.rightSE=this.leftSE,this.leftSE=k,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let B=0,P=this.windings.length;B<P;B++)this.windings[B]*=-1}consume(k){let B=this,P=k;for(;B.consumedBy;)B=B.consumedBy;for(;P.consumedBy;)P=P.consumedBy;let A=Vs.compare(B,P);if(A!==0){if(A>0){let D=B;B=P,P=D}if(B.prev===P){let D=B;B=P,P=D}for(let D=0,O=P.rings.length;D<O;D++){let F=P.rings[D],G=P.windings[D],Z=B.rings.indexOf(F);Z===-1?(B.rings.push(F),B.windings.push(G)):B.windings[Z]+=G}P.rings=null,P.windings=null,P.consumedBy=B,P.leftSE.consumedBy=B.leftSE,P.rightSE.consumedBy=B.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let k=this.prev.consumedBy||this.prev;this._beforeState=k.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let k=this.beforeState();this._afterState={rings:k.rings.slice(0),windings:k.windings.slice(0),multiPolys:[]};let B=this._afterState.rings,P=this._afterState.windings,A=this._afterState.multiPolys;for(let F=0,G=this.rings.length;F<G;F++){let Z=this.rings[F],W=this.windings[F],V=B.indexOf(Z);V===-1?(B.push(Z),P.push(W)):P[V]+=W}let D=[],O=[];for(let F=0,G=B.length;F<G;F++){if(P[F]===0)continue;let Z=B[F],W=Z.poly;if(O.indexOf(W)===-1)if(Z.isExterior)D.push(W);else{O.indexOf(W)===-1&&O.push(W);let V=D.indexOf(Z.poly);V!==-1&&D.splice(V,1)}}for(let F=0,G=D.length;F<G;F++){let Z=D[F].multiPoly;A.indexOf(Z)===-1&&A.push(Z)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let k=this.beforeState().multiPolys,B=this.afterState().multiPolys;switch(Ns.type){case"union":{let P=k.length===0,A=B.length===0;this._isInResult=P!==A;break}case"intersection":{let P,A;k.length<B.length?(P=k.length,A=B.length):(P=B.length,A=k.length),this._isInResult=A===Ns.numMultiPolys&&P<A;break}case"xor":{let P=Math.abs(k.length-B.length);this._isInResult=P%2===1;break}case"difference":{let P=A=>A.length===1&&A[0].isSubject;this._isInResult=P(k)!==P(B);break}}return this._isInResult}},Ja=class{poly;isExterior;segments;bbox;constructor(C,k,B){if(!Array.isArray(C)||C.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=k,this.isExterior=B,this.segments=[],typeof C[0][0]!="number"||typeof C[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let P=Pi.snap({x:new gi(C[0][0]),y:new gi(C[0][1])});this.bbox={ll:{x:P.x,y:P.y},ur:{x:P.x,y:P.y}};let A=P;for(let D=1,O=C.length;D<O;D++){if(typeof C[D][0]!="number"||typeof C[D][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let F=Pi.snap({x:new gi(C[D][0]),y:new gi(C[D][1])});F.x.eq(A.x)&&F.y.eq(A.y)||(this.segments.push(Gs.fromRing(A,F,this)),F.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=F.x),F.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=F.y),F.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=F.x),F.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=F.y),A=F)}(!P.x.eq(A.x)||!P.y.eq(A.y))&&this.segments.push(Gs.fromRing(A,P,this))}getSweepEvents(){let C=[];for(let k=0,B=this.segments.length;k<B;k++){let P=this.segments[k];C.push(P.leftSE),C.push(P.rightSE)}return C}},Co=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(C,k){if(!Array.isArray(C))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ja(C[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let B=1,P=C.length;B<P;B++){let A=new Ja(C[B],this,!1);A.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=A.bbox.ll.x),A.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=A.bbox.ll.y),A.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=A.bbox.ur.x),A.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=A.bbox.ur.y),this.interiorRings.push(A)}this.multiPoly=k}getSweepEvents(){let C=this.exteriorRing.getSweepEvents();for(let k=0,B=this.interiorRings.length;k<B;k++){let P=this.interiorRings[k].getSweepEvents();for(let A=0,D=P.length;A<D;A++)C.push(P[A])}return C}},Xa=class{isSubject;polys;bbox;constructor(C,k){if(!Array.isArray(C))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof C[0][0][0]=="number"&&(C=[C])}catch{}this.polys=[],this.bbox={ll:{x:new gi(Number.POSITIVE_INFINITY),y:new gi(Number.POSITIVE_INFINITY)},ur:{x:new gi(Number.NEGATIVE_INFINITY),y:new gi(Number.NEGATIVE_INFINITY)}};for(let B=0,P=C.length;B<P;B++){let A=new Co(C[B],this);A.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=A.bbox.ll.x),A.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=A.bbox.ll.y),A.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=A.bbox.ur.x),A.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=A.bbox.ur.y),this.polys.push(A)}this.isSubject=k}getSweepEvents(){let C=[];for(let k=0,B=this.polys.length;k<B;k++){let P=this.polys[k].getSweepEvents();for(let A=0,D=P.length;A<D;A++)C.push(P[A])}return C}},bo=(C,...k)=>Ns.run("intersection",C,k),xo=(C,...k)=>Ns.run("difference",C,k);Pi.set;function Zs(C){let k={type:"Feature"};return k.geometry=C,k}function js(C){return C.type==="Feature"?C.geometry:C}function $a(C){return C&&C.geometry&&C.geometry.coordinates?C.geometry.coordinates:C}function ko(C){return Zs({type:"LineString",coordinates:C})}function Mo(C){return Zs({type:"MultiLineString",coordinates:C})}function Qa(C){return Zs({type:"Polygon",coordinates:C})}function to(C){return Zs({type:"MultiPolygon",coordinates:C})}function wo(C,k){let B=js(C),P=js(k),A=bo(B.coordinates,P.coordinates);return A.length===0?null:A.length===1?Qa(A[0]):to(A)}function Eo(C,k){let B=js(C),P=js(k),A=xo(B.coordinates,P.coordinates);return A.length===0?null:A.length===1?Qa(A[0]):to(A)}function eo(C){return Array.isArray(C)?1+eo(C[0]):-1}function Bo(C){C instanceof L.Polyline&&(C=C.toGeoJSON(15));let k=$a(C),B=eo(k),P=[];return B>1?k.forEach(A=>{P.push(ko(A))}):P.push(C),P}function Po(C){let k=[];return C.eachLayer(B=>{k.push($a(B.toGeoJSON(15)))}),Mo(k)}fe.Cut=fe.Polygon.extend({initialize(C){this._map=C,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let C=this._layer.getLatLngs();if(C.length<=2)return;let k=L.polygon(C,this.options.pathOptions);k._latlngInfos=this._layer._latlngInfo,this.cut(k),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:P,originalLayer:A})=>{this._fireCut(A,P,A),this._fireCut(this._map,P,A),A.pm._fireEdit()}),this._editedLayers=[];let B=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(B))},cut(C){let k=this._map._layers,B=C._latlngInfos||[];Object.keys(k).map(P=>k[P]).filter(P=>P.pm).filter(P=>!P._pmTempLayer).filter(P=>!L.PM.optIn&&!P.options.pmIgnore||L.PM.optIn&&P.options.pmIgnore===!1).filter(P=>P instanceof L.Polyline).filter(P=>P!==C).filter(P=>P.pm.options.allowCutting).filter(P=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(P)>-1:!0).filter(P=>!this._layerGroup.hasLayer(P)).filter(P=>{try{let A=!!Ne(C.toGeoJSON(15),P.toGeoJSON(15)).features.length>0;return A||P instanceof L.Polyline&&!(P instanceof L.Polygon)?A:!!wo(C.toGeoJSON(15),P.toGeoJSON(15))}catch{return P instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(P=>{let A;if(P instanceof L.Polygon){A=L.polygon(P.getLatLngs());let G=A.getLatLngs();B.forEach(Z=>{if(Z&&Z.snapInfo){let{latlng:W}=Z,V=this._calcClosestLayer(W,[A]);if(V&&V.segment&&V.distance<this.options.snapDistance){let{segment:rt}=V;if(rt&&rt.length===2){let{indexPath:st,parentPath:vt,newIndex:bt}=L.PM.Utils._getIndexFromSegment(G,rt);(st.length>1?(0,Fa.default)(G,vt):G).splice(bt,0,W)}}}})}else A=P;let D=this._cutLayer(C,A),O=L.geoJSON(D,P.options);O.getLayers().length===1&&([O]=O.getLayers()),this._setPane(O,"layerPane");let F=O.addTo(this._map.pm._getContainingLayer());if(F.pm.enable(P.pm.options),F.pm.disable(),P._pmTempLayer=!0,C._pmTempLayer=!0,P.remove(),P.removeFrom(this._map.pm._getContainingLayer()),C.remove(),C.removeFrom(this._map.pm._getContainingLayer()),F.getLayers&&F.getLayers().length===0&&this._map.pm.removeLayer({target:F}),F instanceof L.LayerGroup?(F.eachLayer(G=>{this._addDrawnLayerProp(G)}),this._addDrawnLayerProp(F)):this._addDrawnLayerProp(F),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let G=this.options.layersToCut.indexOf(P);G>-1&&this.options.layersToCut.splice(G,1)}this._editedLayers.push({layer:F,originalLayer:P})})},_cutLayer(C,k){let B=L.geoJSON(),P;if(k instanceof L.Polygon)P=Eo(k.toGeoJSON(15),C.toGeoJSON(15));else{let A=Bo(k);A.forEach(D=>{let O=Da(D,C.toGeoJSON(15)),F;O&&O.features.length>0?F=L.geoJSON(O):F=L.geoJSON(D),F.getLayers().forEach(G=>{As(C.toGeoJSON(15),G.toGeoJSON(15))||G.addTo(B)})}),A.length>1?P=Po(B):P=B.toGeoJSON(15)}return P},_change:L.Util.falseFn}),fe.Text=fe.extend({initialize(C){this._map=C,this._shape="Text",this.toolbarButtonName="drawText"},enable(C){L.Util.setOptions(this,C),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wt("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker?.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarkerAfterMoving,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(C){this.enabled()?this.disable():this.enable(C)},_syncHintMarker(C){if(this._hintMarker.setLatLng(C.latlng),this.options.snappable){let k=C;k.target=this._hintMarker,this._handleSnapping(k)}},_createMarker(C){if(!C.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(C.latlng);let k=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),this.options.textOptions?.className){let A=this.options.textOptions.className.split(" ");this.textArea.classList.add(...A)}let B=this._createTextIcon(this.textArea),P=new L.Marker(k,{textMarker:!0,_textMarkerOverPM:!0,icon:B});if(this._setPane(P,"markerPane"),this._finishLayer(P),P.pm||(P.options.draggable=!1),P.addTo(this._map.pm._getContainingLayer()),P.pm){P.pm.textArea=this.textArea,L.setOptions(P.pm,{removeIfEmpty:this.options.textOptions?.removeIfEmpty??!0});let A=this.options.textOptions?.focusAfterDraw??!0;P.pm._createTextMarker(A),this.options.textOptions?.text&&P.pm.setText(this.options.textOptions.text)}this._fireCreate(P),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(C){this.enable(),this._hintMarker.setLatLng(C.latlng)},_createTextArea(){let C=document.createElement("textarea");return C.readOnly=!0,C.classList.add("pm-textarea","pm-disabled"),C},_createTextIcon(C){return L.divIcon({className:"pm-text-marker",html:C})}});var So={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,Ni(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let C=this._getDOMElem();C&&(Ni(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(C)):L.DomEvent.on(C,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,Ni(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let C=this._getDOMElem();C&&(Ni(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(C)):L.DomEvent.off(C,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(C){let k=C.touches?C.touches[0]:C,B={originalEvent:k,target:this._layer};return B.containerPoint=this._map.mouseEventToContainerPoint(k),B.latlng=this._map.containerPointToLatLng(B.containerPoint),this._dragMixinOnMouseDown(B),!1},_simulateMouseMoveEvent(C){let k=C.touches?C.touches[0]:C,B={originalEvent:k,target:this._layer};return B.containerPoint=this._map.mouseEventToContainerPoint(k),B.latlng=this._map.containerPointToLatLng(B.containerPoint),this._dragMixinOnMouseMove(B),!1},_simulateMouseUpEvent(C){let k={originalEvent:C.touches?C.touches[0]:C,target:this._layer};return C.type.indexOf("touch")===-1&&(k.containerPoint=this._map.mouseEventToContainerPoint(C),k.latlng=this._map.containerPointToLatLng(k.containerPoint)),this._dragMixinOnMouseUp(k),!1},_dragMixinOnMouseDown(C){if(C.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(C);let k=C._fromLayerSync,B=this._syncLayers("_dragMixinOnMouseDown",C);if(this._layer instanceof L.Marker&&(this.options.snappable&&!k&&!B?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let P="resizeableCircleMarker";this._layer instanceof L.Circle&&(P="resizeableCircle"),this.options.snappable&&!k&&!B?this._layer.pm.options[P]||this._initSnappableMarkersDrag():this._layer.pm.options[P]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=C.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(C){this._overwriteEventIfItComesFromMarker(C);let k=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",C),this._dragging||(this._dragging=!0,L.DomUtil.addClass(k,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=C.latlng),this._onLayerDrag(C),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(C){let k=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",C),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,k&&L.DomUtil.removeClass(k,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(C){let{latlng:k}=C,B={lat:k.lat-this._tempDragCoord.lat,lng:k.lng-this._tempDragCoord.lng},P=A=>A.map(D=>{if(Array.isArray(D))return P(D);let O={lat:D.lat+B.lat,lng:D.lng+B.lng};return(D.alt||D.alt===0)&&(O.alt=D.alt),O});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let A=P([this._layer.getLatLng()]);this._layer.setLatLng(A[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let A=this._layer.getLatLng();this._layer._snapped&&(A=this._layer._orgLatLng);let D=P([A]);this._layer.setLatLng(D[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let A=P([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(A),this._fireChange(this._layer.getBounds(),"Edit")}else{let A=P(this._layer.getLatLngs());this._layer.setLatLngs(A),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=k,C.layer=this._layer,this._fireDrag(C)},addDraggingClass(){let C=this._getDOMElem();C&&L.DomUtil.addClass(C,"leaflet-pm-draggable")},removeDraggingClass(){let C=this._getDOMElem();C&&L.DomUtil.removeClass(C,"leaflet-pm-draggable")},_getDOMElem(){let C=null;return this._layer._path?C=this._layer._path:this._layer._renderer&&this._layer._renderer._container?C=this._layer._renderer._container:this._layer._image?C=this._layer._image:this._layer._icon&&(C=this._layer._icon),C},_overwriteEventIfItComesFromMarker(C){C.target.getLatLng&&(!C.target._radius||C.target._radius<=10)&&(C.containerPoint=this._map.mouseEventToContainerPoint(C.originalEvent),C.latlng=this._map.containerPointToLatLng(C.containerPoint))},_syncLayers(C,k){if(this.enabled())return!1;if(!k._fromLayerSync&&this._layer===k.target&&this.options.syncLayersOnDrag){k._fromLayerSync=!0;let B=[];if(L.Util.isArray(this.options.syncLayersOnDrag))B=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(P=>{P instanceof L.LayerGroup&&(B=B.concat(P.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let P in this._parentLayerGroup){let A=this._parentLayerGroup[P];A.pm&&(B=A.pm.getLayers(!0))}return L.Util.isArray(B)&&B.length>0&&(B=B.filter(P=>!!P.pm).filter(P=>!!P.pm.options.draggable),B.forEach(P=>{P!==this._layer&&P.pm[C]&&(P._snapped=!1,P.pm[C](k))})),B.length>0}return!1},_stopDOMImageDrag(C){return C.preventDefault(),!1}},Ao=So,Do=et(hi());function To(C,k,B,P){return B.unproject(k.transform(B.project(C,P)),P)}function io(C,k,B){let P=B.getMaxZoom();if(P===1/0&&(P=B.getZoom()),L.Util.isArray(C)){let A=[];return C.forEach(D=>{A.push(io(D,k,B))}),A}return C instanceof L.LatLng?To(C,k,B,P):null}function Fn(C,k){k instanceof L.Layer&&(k=k.getLatLng());let B=C.getMaxZoom();return B===1/0&&(B=C.getZoom()),C.project(k,B)}function Us(C,k){let B=C.getMaxZoom();return B===1/0&&(B=C.getZoom()),C.unproject(k,B)}var Oo={_onRotateStart(C){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Fn(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Fn(this._map,C.target.getLatLng()),this._initialRotateLatLng=ri(this._layer),this._startAngle=this.getAngle();let k=ri(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,k),this._fireRotationStart(this._map,k)},_onRotate(C){let k=Fn(this._map,C.target.getLatLng()),B=this._rotationStartPoint,P=this._rotationOriginPoint,A=Math.atan2(k.y-P.y,k.x-P.x)-Math.atan2(B.y-P.y,B.x-P.x);this._layer.setLatLngs(this._rotateLayer(A,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let D=this;function O(W,V=[],rt=-1){if(rt>-1&&V.push(rt),L.Util.isArray(W[0]))W.forEach((st,vt)=>O(st,V.slice(),vt));else{let st=V.length>0?(0,Do.default)(D._markers,V):D._markers[0];W.forEach((vt,bt)=>{st[bt].setLatLng(vt)})}}O(this._layer.getLatLngs());let F=ri(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(A,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let G=A*180/Math.PI;G=G<0?G+360:G;let Z=G+this._startAngle;this._setAngle(Z),this._rotationLayer.pm._setAngle(Z),this._fireRotation(this._rotationLayer,G,F),this._fireRotation(this._map,G,F),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let C=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let k=ri(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=ri(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,C,k),this._fireRotationEnd(this._map,C,k),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(C,k,B,P,A){let D=Fn(A,B);return this._matrix=P.clone().rotate(C,D).flip(),io(k,this._matrix,A)},_setAngle(C){C=C<0?C+360:C,this._angle=C%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let C=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),k=C.getCenter();return C.removeFrom(this._layer._map),k},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(ur(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let C={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),C),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=ri(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(C){let k=this.getAngle(),B=this._layer.getLatLngs(),P=C*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(P,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+C),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(P,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let A=this.getAngle()-k;A=A<0?A+360:A,this._startAngle=k,this._fireRotation(this._layer,A,B,this._layer),this._fireRotation(this._map||this._layer._map,A,B,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(C){let k=C-this.getAngle();this.rotateLayer(k)},getAngle(){return this._angle||0},setInitAngle(C){this._setAngle(C)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(C){this._rotationCenter=C,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(C)}},Fo=Oo,Ro=L.Class.extend({includes:[Ao,cs,Fo,sn],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(C){L.Util.setOptions(this,C)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(C,k){k==="layerPane"?C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":k==="vertexPane"?C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":k==="markerPane"&&(C.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(C,k){let B=k.target,P={layer:this._layer,marker:B,event:k},A="";return C==="move"?A="moveVertexValidation":C==="add"?A="addVertexValidation":C==="remove"&&(A="removeVertexValidation"),this.options[A]&&typeof this.options[A]=="function"&&!this.options[A](P)?(C==="move"&&(B._cancelDragEventChain=B.getLatLng()),!1):(B._cancelDragEventChain=null,!0)},_vertexValidationDrag(C){return C._cancelDragEventChain?(C._latlng=C._cancelDragEventChain,C.update(),!1):!0},_vertexValidationDragEnd(C){return C._cancelDragEventChain?(C._cancelDragEventChain=null,!1):!0}}),ve=Ro;ve.LayerGroup=L.Class.extend({initialize(C){this._layerGroup=C,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(P=>this._initLayer(P));let k=P=>{if(P.layer._pmTempLayer)return;this._layers=this.getLayers();let A=this._layers.filter(D=>!D.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in D.pm._parentLayerGroup));A.forEach(D=>{this._initLayer(D)}),A.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(k,100,this),this),this._layerGroup.on("layerremove",P=>{this._removeLayerFromGroup(P.target)},this);let B=P=>{P.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(B,100,this),this)},enable(C,k=[]){k.length===0&&(this._layers=this.getLayers()),this._options=C,this._layers.forEach(B=>{B instanceof L.LayerGroup?k.indexOf(B._leaflet_id)===-1&&(k.push(B._leaflet_id),B.pm.enable(C,k)):B.pm.enable(C)})},disable(C=[]){C.length===0&&(this._layers=this.getLayers()),this._layers.forEach(k=>{k instanceof L.LayerGroup?C.indexOf(k._leaflet_id)===-1&&(C.push(k._leaflet_id),k.pm.disable(C)):k.pm.disable()})},enabled(C=[]){return C.length===0&&(this._layers=this.getLayers()),!!this._layers.find(k=>k instanceof L.LayerGroup?C.indexOf(k._leaflet_id)===-1?(C.push(k._leaflet_id),k.pm.enabled(C)):!1:k.pm.enabled())},toggleEdit(C,k=[]){k.length===0&&(this._layers=this.getLayers()),this._options=C,this._layers.forEach(B=>{B instanceof L.LayerGroup?k.indexOf(B._leaflet_id)===-1&&(k.push(B._leaflet_id),B.pm.toggleEdit(C,k)):B.pm.toggleEdit(C)})},_initLayer(C){let k=L.Util.stamp(this._layerGroup);C.pm._parentLayerGroup||(C.pm._parentLayerGroup={}),C.pm._parentLayerGroup[k]=this._layerGroup},_removeLayerFromGroup(C){if(C.pm&&C.pm._layerGroup){let k=L.Util.stamp(this._layerGroup);delete C.pm._layerGroup[k]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(C=>C.pm.dragging()):!1},getOptions(){return this.options},_getMap(){return this._map||this._layers.find(C=>!!C._map)?._map||null},getLayers(C=!1,k=!0,B=!0,P=[]){let A=[];return C?this._layerGroup.getLayers().forEach(D=>{A.push(D),D instanceof L.LayerGroup&&P.indexOf(D._leaflet_id)===-1&&(P.push(D._leaflet_id),A=A.concat(D.pm.getLayers(!0,!0,!0,P)))}):A=this._layerGroup.getLayers(),B&&(A=A.filter(D=>!(D instanceof L.LayerGroup))),k&&(A=A.filter(D=>!!D.pm),A=A.filter(D=>!D._pmTempLayer),A=A.filter(D=>!L.PM.optIn&&!D.options.pmIgnore||L.PM.optIn&&D.options.pmIgnore===!1)),A},setOptions(C,k=[]){k.length===0&&(this._layers=this.getLayers()),this.options=C,this._layers.forEach(B=>{B.pm&&(B instanceof L.LayerGroup?k.indexOf(B._leaflet_id)===-1&&(k.push(B._leaflet_id),B.pm.setOptions(C,k)):B.pm.setOptions(C))})}}),ve.Marker=ve.extend({_shape:"Marker",initialize(C){this._layer=C,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(C={draggable:!0}){if(L.Util.setOptions(this,C),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this),this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(C){this.enabled()?this.disable():this.enable(C)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(C){let k=C.target;k.remove(),this._fireRemove(k),this._fireRemove(this._map,k)},_onDragStart(){this._map.pm.Draw.Marker._layerIsDragging=!0},_onMarkerDragEnd(){this._map.pm.Draw.Marker._layerIsDragging=!1},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let C=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,C.off("pm:drag",this._handleSnapping,this),C.on("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.on("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this),C.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let C=this._layer;C.off("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this)}});var Wi=et(hi()),Io={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let C=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=C.filter((k,B,P)=>P.indexOf(k)===B)},_removeFromCache(C){let k=this.markerCache.indexOf(C);k>-1&&this.markerCache.splice(k,1)},renderLimits(C){this.markerCache.forEach(k=>{C.includes(k)?this._markerGroup.addLayer(k):this._markerGroup.removeLayer(k)})},applyLimitFilters({latlng:C={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let k=[...this._filterClosestMarkers(C)];this.renderLimits(k)},_filterClosestMarkers(C){let k=[...this.markerCache],B=this.options.limitMarkersToCount;return B===-1?k:(k.sort((P,A)=>{let D=P._latlng.distanceTo(C),O=A._latlng.distanceTo(C);return D-O}),k.filter((P,A)=>B>-1?A<B:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(C){this._preventRenderMarkers=!!C}},zo=Io;ve.Line=ve.extend({includes:[zo],_shape:"Line",initialize(C){this._layer=C,this._enabled=!1},enable(C){if(L.Util.setOptions(this,C),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let C=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(C,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(C){return this.enabled()?this.disable():this.enable(C),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let C=this._map,k=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(C),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let B=P=>{if(Array.isArray(P[0]))return P.map(B,this);let A=P.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&P.map((D,O)=>{let F=this.isPolygon()?(O+1)%P.length:O+1;return this._createMiddleMarker(A[O],A[F])}),A};this._markers=B(k),this.filterMarkerGroup(),C.addLayer(this._markerGroup)},_createMarker(C){let k=new L.Marker(C,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(k,"vertexPane"),k._pmTempLayer=!0,this.options.rotate?(k.on("dragstart",this._onRotateStart,this),k.on("drag",this._onRotate,this),k.on("dragend",this._onRotateEnd,this)):(k.on("click",this._onVertexClick,this),k.on("dragstart",this._onMarkerDragStart,this),k.on("move",this._onMarkerDrag,this),k.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||k.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(k),k},_createMiddleMarker(C,k){if(!C||!k)return!1;let B=L.PM.Utils.calcMiddleLatLng(this._map,C.getLatLng(),k.getLatLng()),P=this._createMarker(B),A=L.divIcon({className:"marker-icon marker-icon-middle"});return P.setIcon(A),P.leftM=C,P.rightM=k,C._middleMarkerNext=P,k._middleMarkerPrev=P,P.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),P.on("movestart",this._onMiddleMarkerMoveStart,this),P},_onMiddleMarkerClick(C){let k=C.target;if(!this._vertexValidation("add",C))return;let B=L.divIcon({className:"marker-icon"});k.setIcon(B),this._addMarker(k,k.leftM,k.rightM)},_onMiddleMarkerMoveStart(C){let k=C.target;if(k.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",C)){k.on("move",this._onMiddleMarkerMovePrevent,this);return}k._dragging=!0,this._addMarker(k,k.leftM,k.rightM)},_onMiddleMarkerMovePrevent(C){let k=C.target;this._vertexValidationDrag(k)},_onMiddleMarkerMoveEnd(C){let k=C.target;if(k.off("move",this._onMiddleMarkerMovePrevent,this),k.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(k))return;let B=L.divIcon({className:"marker-icon"});k.setIcon(B),setTimeout(()=>{delete k._dragging},100)},_addMarker(C,k,B){C.off("movestart",this._onMiddleMarkerMoveStart,this),C.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let P=C.getLatLng(),A=this._layer._latlngs;delete C.leftM,delete C.rightM;let{indexPath:D,index:O,parentPath:F}=L.PM.Utils.findDeepMarkerIndex(this._markers,k),G=D.length>1?(0,Wi.default)(A,F):A,Z=D.length>1?(0,Wi.default)(this._markers,F):this._markers;G.splice(O+1,0,P),Z.splice(O+1,0,C),this._layer.setLatLngs(A),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(k,C),this._createMiddleMarker(C,B)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(C,L.PM.Utils.findDeepMarkerIndex(this._markers,C).indexPath,P),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Mn(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(C){let k=this._layer,B,P;if(this.options.allowSelfIntersection?B=!1:(P=Mn(this._layer.toGeoJSON(15)),B=P.features.length>0),B){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return B;C?this._flashLayer():(k.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(P)}else k.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return B},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(C,k){C.forEach(B=>{Array.isArray(B)?this._updateDisabledMarkerStyle(B,k):B._icon&&(k&&!this._checkMarkerAllowedToDrag(B)?L.DomUtil.addClass(B._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(B._icon,"vertexmarker-disabled"))})},_removeMarker(C){let k=C.target;if(!this._vertexValidation("remove",C))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=ri(this._layer,this._layer.getLatLngs()));let B=this._layer.getLatLngs(),{indexPath:P,index:A,parentPath:D}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);if(!P)return;let O=P.length>1?(0,Wi.default)(B,D):B,F=P.length>1?(0,Wi.default)(this._markers,D):this._markers,G=D[D.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!G&&(O.length<=2||this.isPolygon()&&O.length<=3)){this._flashLayer();return}O.splice(A,1),this._layer.setLatLngs(B),this.isPolygon()&&O.length<=2&&O.splice(0,O.length);let Z=!1;if(O.length<=1&&(O.splice(0,O.length),D.length>1&&P.length>1&&(B=xn(B)),this._layer.setLatLngs(B),this._initMarkers(),Z=!0),qt(B)||this._layer.remove(),B=xn(B),this._layer.setLatLngs(B),this._markers=xn(this._markers),!Z&&(F=P.length>1?(0,Wi.default)(this._markers,D):this._markers,k._middleMarkerPrev&&(this._markerGroup.removeLayer(k._middleMarkerPrev),this._removeFromCache(k._middleMarkerPrev)),k._middleMarkerNext&&(this._markerGroup.removeLayer(k._middleMarkerNext),this._removeFromCache(k._middleMarkerNext)),this._markerGroup.removeLayer(k),this._removeFromCache(k),F)){let W,V;if(this.isPolygon()?(W=(A+1)%F.length,V=(A+(F.length-1))%F.length):(V=A-1<0?void 0:A-1,W=A+1>=F.length?void 0:A+1),W!==V){let rt=F[V],st=F[W];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(rt,st)}F.splice(A,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(k,P),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(C){let k=this._layer.getLatLngs(),B=C.getLatLng(),{indexPath:P,index:A,parentPath:D}=L.PM.Utils.findDeepMarkerIndex(this._markers,C),O=P.length>1?(0,Wi.default)(k,D):k;B.alt=O[A].alt,O.splice(A,1,B),this._layer.setLatLngs(k)},_getNeighborMarkers(C){let{indexPath:k,index:B,parentPath:P}=L.PM.Utils.findDeepMarkerIndex(this._markers,C),A=k.length>1?(0,Wi.default)(this._markers,P):this._markers,D=(B+1)%A.length,O=(B+(A.length-1))%A.length,F=A[O],G=A[D];return{prevMarker:F,nextMarker:G}},_checkMarkerAllowedToDrag(C){let{prevMarker:k,nextMarker:B}=this._getNeighborMarkers(C),P=L.polyline([k.getLatLng(),C.getLatLng()]),A=L.polyline([C.getLatLng(),B.getLatLng()]),D=Ne(this._layer.toGeoJSON(15),P.toGeoJSON(15)).features.filter(F=>{let G=F.geometry.coordinates,Z=L.latLng(G[1],G[0]);return!Z.equals(k.getLatLng())&&!Z.equals(C.getLatLng())}).length,O=Ne(this._layer.toGeoJSON(15),A.toGeoJSON(15)).features.filter(F=>{let G=F.geometry.coordinates,Z=L.latLng(G[1],G[0]);return!Z.equals(B.getLatLng())&&!Z.equals(C.getLatLng())}).length;return!(D<1&&O<1)},_onMarkerDragStart(C){let k=C.target;if(this._preventRenderingMarkers(!0),this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",C))return;let{indexPath:B}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);this._fireMarkerDragStart(C,B),this.options.allowSelfIntersection||(this._coordsBeforeEdit=ri(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(k):this._markerAllowedToDrag=null},_onMarkerDrag(C){let k=C.target;if(!this._vertexValidationDrag(k))return;let{indexPath:B,index:P,parentPath:A}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);if(!B)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(k);let D=B.length>1?(0,Wi.default)(this._markers,A):this._markers,O=(P+1)%D.length,F=(P+(D.length-1))%D.length,G=k.getLatLng(),Z=D[F].getLatLng(),W=D[O].getLatLng();if(k._middleMarkerNext){let V=L.PM.Utils.calcMiddleLatLng(this._map,G,W);k._middleMarkerNext.setLatLng(V)}if(k._middleMarkerPrev){let V=L.PM.Utils.calcMiddleLatLng(this._map,G,Z);k._middleMarkerPrev.setLatLng(V)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(C,B),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(C){let k=C.target;if(this._preventRenderingMarkers(!1),!this._vertexValidationDragEnd(k))return;let{indexPath:B}=L.PM.Utils.findDeepMarkerIndex(this._markers,k),P=!this.options.allowSelfIntersection&&this.hasSelfIntersection();P&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(P=!1);let A=!this.options.allowSelfIntersection&&P;if(this._fireMarkerDragEnd(C,B,A),A){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(C,B);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(C){let k=C.target;if(k._dragging)return;let{indexPath:B}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);this._fireVertexClick(C,B)}}),ve.Polygon=ve.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(C){let{prevMarker:k,nextMarker:B}=this._getNeighborMarkers(C),P=L.polyline([k.getLatLng(),C.getLatLng()]),A=L.polyline([C.getLatLng(),B.getLatLng()]),D=Ne(this._layer.toGeoJSON(15),P.toGeoJSON(15)).features.filter(F=>{let G=F.geometry.coordinates,Z=L.latLng(G[1],G[0]);return!Z.equals(k.getLatLng())&&!Z.equals(C.getLatLng())}).length,O=Ne(this._layer.toGeoJSON(15),A.toGeoJSON(15)).features.filter(F=>{let G=F.geometry.coordinates,Z=L.latLng(G[1],G[0]);return!Z.equals(B.getLatLng())&&!Z.equals(C.getLatLng())}).length;return!(D<1&&O<1)}}),ve.Rectangle=ve.Polygon.extend({_shape:"Rectangle",_initMarkers(){let C=this._map,k=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,C.addLayer(this._markerGroup),this._markers=[],this._markers[0]=k.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((B,P)=>{let A=this._cornerMarkers.find(D=>D._index===P);A&&A.setLatLng(B)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(C,k){let B=new L.Marker(C,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(B,"vertexPane"),B._origLatLng=C,B._index=k,B._pmTempLayer=!0,B.on("click",this._onVertexClick,this),this._markerGroup.addLayer(B),B},_addMarkerEvents(){this._markers[0].forEach(C=>{C.on("dragstart",this._onMarkerDragStart,this),C.on("drag",this._onMarkerDrag,this),C.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||C.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(C){if(!this._vertexValidation("move",C))return;let k=C.target,B=this._cornerMarkers;k._oppositeCornerLatLng=B.find(A=>A._index===(k._index+2)%4).getLatLng(),k._snapped=!1;let{indexPath:P}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);this._fireMarkerDragStart(C,P)},_onMarkerDrag(C){let k=C.target;if(!this._vertexValidationDrag(k)||k._index===void 0)return;this._adjustRectangleForMarkerMove(k);let{indexPath:B}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);this._fireMarkerDrag(C,B),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(C){let k=C.target;if(!this._vertexValidationDragEnd(k))return;this._cornerMarkers.forEach(P=>{delete P._oppositeCornerLatLng});let{indexPath:B}=L.PM.Utils.findDeepMarkerIndex(this._markers,k);this._fireMarkerDragEnd(C,B),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(C){L.extend(C._origLatLng,C._latlng);let k=L.PM.Utils._getRotatedRectangle(C.getLatLng(),C._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(k),this._adjustAllMarkers(C),this._layer.redraw()},_adjustAllMarkers(C){let k=this._layer.getLatLngs()[0];if(k&&k.length!==4&&k.length>0)k.forEach((B,P)=>{this._cornerMarkers[P].setLatLng(B)}),this._cornerMarkers.slice(k.length).forEach(B=>{B.setLatLng(k[0])});else if(!k||!k.length)console.error("The layer has no LatLngs");else{let B=k.findIndex(P=>C.getLatLng().equals(P));B>-1?(this._cornerMarkers[(C._index+1)%4].setLatLng(k[(B+1)%4]),this._cornerMarkers[(C._index+2)%4].setLatLng(k[(B+2)%4]),this._cornerMarkers[(C._index+3)%4].setLatLng(k[(B+3)%4])):this._cornerMarkers.forEach(P=>{P.setLatLng(k[P._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(ur(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let C=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(C[0],C[2],this.getAngle(),this._map||this)}}),ve.CircleMarker=ve.extend({_shape:"CircleMarker",initialize(C){this._layer=C,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(C={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,C),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(C){this.enabled()?this.disable():this.enable(C)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let C=this._map;this._helperLayers&&(this._helperLayers.removeFrom(C),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(C);let k=this._layer.getLatLng(),B=this._layer._radius,P=this._getLatLngOnCircle(k,B);this._centerMarker=this._createCenterMarker(k),this._outerMarker=this._createOuterMarker(P),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(C,k){let B=this._map.project(C),P=L.point(B.x+k,B.y);return this._map.unproject(P)},_createHintLine(C,k){let B=C.getLatLng(),P=k.getLatLng();this._hintline=L.polyline([B,P],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(C){let k=this._createMarker(C);return this.options.draggable?(L.DomUtil.addClass(k._icon,"leaflet-pm-draggable"),k.on("move",this._moveCircle,this)):k.dragging.disable(),k},_createOuterMarker(C){let k=this._createMarker(C);return k.on("drag",this._resizeCircle,this),k},_createMarker(C){let k=new L.Marker(C,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(k,"vertexPane"),k._origLatLng=C,k._pmTempLayer=!0,k.on("dragstart",this._onMarkerDragStart,this),k.on("drag",this._onMarkerDrag,this),k.on("dragend",this._onMarkerDragEnd,this),k.on("click",this._onVertexClick,this),this._helperLayers.addLayer(k),k},_moveCircle(C){if(C.target._cancelDragEventChain)return;let k=this._centerMarker.getLatLng();this._layer.setLatLng(k);let B=this._layer._radius,P=this._getLatLngOnCircle(k,B);this._outerMarker._latlng=P,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let C=this._layer.getLatLng(),k=this._layer._radius,B=this._getLatLngOnCircle(C,k);this._outerMarker.setLatLng(B),this._centerMarker.setLatLng(C),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let C=this._centerMarker.getLatLng(),k=this._outerMarker.getLatLng(),B=this._distanceCalculation(C,k);this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(B),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let C=this._centerMarker.getLatLng(),k=this._outerMarker.getLatLng();this._hintline.setLatLngs([C,k])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(C){this._vertexValidation("move",C)&&this._fireMarkerDragStart(C)},_onMarkerDrag(C){let k=C.target;k instanceof L.Marker&&!this._vertexValidationDrag(k)||this._fireMarkerDrag(C)},_onMarkerDragEnd(C){this._extedingMarkerDragEnd();let k=C.target;this._vertexValidationDragEnd(k)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(C))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let C=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,C.off("pm:drag",this._handleSnapping,this),C.on("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.on("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this),C.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let C=this._layer;C.off("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let C=this._layer._map||this._map;if(C){let k=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),C,this._layer.getLatLng()),B=L.circle(this._layer.getLatLng(),this._layer.options);B.setRadius(k);let P=C&&C.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(B,200,!P).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(B,200,!P),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let C=this._centerMarker.getLatLng(),k=this._outerMarker.getLatLng(),B=this._distanceCalculation(C,k);return this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?k=zi(this._map,C,k,this._getMinDistanceInMeter(C)):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]&&(k=zi(this._map,C,k,this._getMaxDistanceInMeter(C))),k},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let C=this._centerMarker.getLatLng(),k=this._outerMarker.getLatLng(),B=this._distanceCalculation(C,k);this.options[this._minRadiusOption]&&B<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&B>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(C,k){return this._map.project(C).distanceTo(this._map.project(k))},_getMinDistanceInMeter(C){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,C)},_getMaxDistanceInMeter(C){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,C)},_onVertexClick(C){C.target._dragging||this._fireVertexClick(C,void 0)}}),ve.Circle=ve.CircleMarker.extend({_shape:"Circle",initialize(C){this._layer=C,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(C){L.PM.Edit.CircleMarker.prototype.enable.call(this,C||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let C=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(C,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let C=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!C).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!C),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(C,k){return this._map.distance(C,k)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(C){C.target._dragging||this._fireVertexClick(C,void 0)}}),ve.ImageOverlay=ve.extend({_shape:"ImageOverlay",initialize(C){this._layer=C,this._enabled=!1},toggleEdit(C){this.enabled()?this.disable():this.enable(C)},enabled(){return this._enabled},enable(C={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,C),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let C=this._layer.getBounds(),k=C.getNorthWest(),B=C.getNorthEast(),P=C.getSouthEast(),A=C.getSouthWest();return[k,B,P,A]}}),ve.Text=ve.extend({_shape:"Text",initialize(C){this._layer=C,this._enabled=!1},enable(C){if(L.Util.setOptions(this,C),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),document.removeEventListener("click",this._documentClickThis,{capture:!0}),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let C=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),C.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(C){this.enabled()?this.disable():this.enable(C)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let C=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,C.off("pm:drag",this._handleSnapping,this),C.on("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.on("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this),C.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let C=this._layer;C.off("pm:drag",this._handleSnapping,this),C.off("pm:dragend",this._cleanupSnapping,this),C.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let C=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,k=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${C}px`,this.textArea.style.width=`${k}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&(this._documentClickThis=this._documentClickThis||this._documentClick.bind(this),document.addEventListener("click",this._documentClickThis,{capture:!0}))},100)},_documentClick(C){C.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(C={}){let k=this._hasFocus;this._hasFocus=C.type==="focus",!k!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(C){C&&(this.textArea.value=C),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let k=this.options.className.split(" ");this.textArea.classList.add(...k)}let C=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(C),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(C=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),C===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(C){C.preventDefault()}});var Na=function(C,k,B,P,A,D){this._matrix=[C,k,B,P,A,D]};Na.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Na.prototype={transform(C){return this._transform(C.clone())},_transform(C){let k=this._matrix,{x:B,y:P}=C;return C.x=k[0]*B+k[1]*P+k[4],C.y=k[2]*B+k[3]*P+k[5],C},untransform(C){let k=this._matrix;return new L.Point((C.x/k[0]-k[4])/k[0],(C.y/k[2]-k[5])/k[2])},clone(){let C=this._matrix;return new L.PM.Matrix(C[0],C[1],C[2],C[3],C[4],C[5])},translate(C){if(C===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let k,B;return typeof C=="number"?(k=C,B=C):(k=C.x,B=C.y),this._add(1,0,0,1,k,B)},scale(C,k){if(C===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let B,P;return k=k||L.point(0,0),typeof C=="number"?(B=C,P=C):(B=C.x,P=C.y),this._add(B,0,0,P,k.x,k.y)._add(1,0,0,1,-k.x,-k.y)},rotate(C,k){let B=Math.cos(C),P=Math.sin(C);return k=k||new L.Point(0,0),this._add(B,P,-P,B,k.x,k.y)._add(1,0,0,1,-k.x,-k.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(C,k,B,P,A,D){let O=[[],[],[]],F=this._matrix,G=[[F[0],F[2],F[4]],[F[1],F[3],F[5]],[0,0,1]],Z=[[C,B,A],[k,P,D],[0,0,1]],W;C&&C instanceof L.PM.Matrix&&(F=C._matrix,Z=[[F[0],F[2],F[4]],[F[1],F[3],F[5]],[0,0,1]]);for(let V=0;V<3;V+=1)for(let rt=0;rt<3;rt+=1){W=0;for(let st=0;st<3;st+=1)W+=G[V][st]*Z[st][rt];O[V][rt]=W}return this._matrix=[O[0][0],O[1][0],O[0][1],O[1][1],O[0][2],O[1][2]],this}};var No=Na,Go={calcMiddleLatLng(C,k,B){let P=C.project(k),A=C.project(B);return C.unproject(P._add(A)._divideBy(2))},findLayers(C){let k=[];return C.eachLayer(B=>{(B instanceof L.Polyline||B instanceof L.Marker||B instanceof L.Circle||B instanceof L.CircleMarker||B instanceof L.ImageOverlay)&&k.push(B)}),k=k.filter(B=>!!B.pm),k=k.filter(B=>!B._pmTempLayer),k=k.filter(B=>!L.PM.optIn&&!B.options.pmIgnore||L.PM.optIn&&B.options.pmIgnore===!1),k},circleToPolygon(C,k=60,B=!0){let P=C.getLatLng(),A=C.getRadius(),D=Ii(P,A,k,0,B),O=[];for(let F=0;F<D.length;F+=1){let G=[D[F].lat,D[F].lng];O.push(G)}return L.polygon(O,C.options)},disablePopup(C){C.getPopup()&&(C._tempPopupCopy=C.getPopup(),C.unbindPopup())},enablePopup(C){C._tempPopupCopy&&(C.bindPopup(C._tempPopupCopy),delete C._tempPopupCopy)},_fireEvent(C,k,B,P=!1){C.fire(k,B,P);let{groups:A}=this.getAllParentGroups(C);A.forEach(D=>{D.fire(k,B,P)})},getAllParentGroups(C){let k=[],B=[],P=A=>{for(let D in A._eventParents)if(k.indexOf(D)===-1){k.push(D);let O=A._eventParents[D];B.push(O),P(O)}};return!C._pmLastGroupFetch||!C._pmLastGroupFetch.time||new Date().getTime()-C._pmLastGroupFetch.time>1e3?(P(C),C._pmLastGroupFetch={time:new Date().getTime(),groups:B,groupIds:k},{groupIds:k,groups:B}):{groups:C._pmLastGroupFetch.groups,groupIds:C._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Ii,getTranslation:Wt,findDeepCoordIndex(C,k,B=!0){let P,A=O=>(F,G)=>{let Z=O.concat(G);if(B){if(F.lat&&F.lat===k.lat&&F.lng===k.lng)return P=Z,!0}else if(F.lat&&L.latLng(F).equals(k))return P=Z,!0;return Array.isArray(F)&&F.some(A(Z))};C.some(A([]));let D={};return P&&(D={indexPath:P,index:P[P.length-1],parentPath:P.slice(0,P.length-1)}),D},findDeepMarkerIndex(C,k){let B,P=D=>(O,F)=>{let G=D.concat(F);return O._leaflet_id===k._leaflet_id?(B=G,!0):Array.isArray(O)&&O.some(P(G))};C.some(P([]));let A={};return B&&(A={indexPath:B,index:B[B.length-1],parentPath:B.slice(0,B.length-1)}),A},_getIndexFromSegment(C,k){if(k&&k.length===2){let B=this.findDeepCoordIndex(C,k[0]),P=this.findDeepCoordIndex(C,k[1]),A=Math.max(B.index,P.index);return(B.index===0||P.index===0)&&A!==1&&(A+=1),{indexA:B,indexB:P,newIndex:A,indexPath:B.indexPath,parentPath:B.parentPath}}return null},_getRotatedRectangle(C,k,B,P){let A=Fn(P,C),D=Fn(P,k),O=B*Math.PI/180,F=Math.cos(O),G=Math.sin(O),Z=(D.x-A.x)*F+(D.y-A.y)*G,W=(D.y-A.y)*F-(D.x-A.x)*G,V=Z*F+A.x,rt=Z*G+A.y,st=-W*G+A.x,vt=W*F+A.y,bt=Us(P,A),Pt=Us(P,{x:V,y:rt}),At=Us(P,D),K=Us(P,{x:st,y:vt});return[bt,Pt,At,K]},pxRadiusToMeterRadius(C,k,B){let P=k.project(B),A=L.point(P.x+C,P.y);return k.distance(k.unproject(A),B)}},Zo=Go;L.PM=L.PM||{version:re.version,Map:Ke,Toolbar:ls,Draw:fe,Edit:ve,Utils:Zo,Matrix:No,activeLang:"en",optIn:!1,initialize(C){this.addInitHooks(C)},setOptIn(C){this.optIn=!!C},addInitHooks(){function C(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(C);function k(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(k);function B(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(B);function P(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(P);function A(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(A);function D(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(D);function O(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(O);function F(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(F);function G(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(G)},reInitLayer(C){C instanceof L.LayerGroup&&C.eachLayer(k=>{this.reInitLayer(k)}),C.pm||L.PM.optIn&&C.options.pmIgnore!==!1||C.options.pmIgnore||(C instanceof L.Map?C.pm=new L.PM.Map(C):C instanceof L.Marker?C.options.textMarker?(C.pm=new L.PM.Edit.Text(C),C.pm._initTextMarker(),C.pm._createTextMarker(!1)):C.pm=new L.PM.Edit.Marker(C):C instanceof L.Circle?C.pm=new L.PM.Edit.Circle(C):C instanceof L.CircleMarker?C.pm=new L.PM.Edit.CircleMarker(C):C instanceof L.Rectangle?C.pm=new L.PM.Edit.Rectangle(C):C instanceof L.Polygon?C.pm=new L.PM.Edit.Polygon(C):C instanceof L.Polyline?C.pm=new L.PM.Edit.Line(C):C instanceof L.LayerGroup?C.pm=new L.PM.Edit.LayerGroup(C):C instanceof L.ImageOverlay&&(C.pm=new L.PM.Edit.ImageOverlay(C)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(C){let k=this._map.mouseEventToLayerPoint(C),B,P;for(let A=this._drawFirst;A;A=A.next)B=A.layer,B.options.interactive&&B._containsPoint(k)&&(!(C.type==="click"||C.type==="preclick")||!this._map._draggableMoved(B))&&(P=B);P&&(L.DomEvent.fakeStop(C),this._fireEvent([P],C))}}),L.PM.initialize()})()),leafletGeoman}requireLeafletGeoman();var leaflet_markerclusterSrc$1={exports:{}},leaflet_markerclusterSrc=leaflet_markerclusterSrc$1.exports,hasRequiredLeaflet_markerclusterSrc;function requireLeaflet_markerclusterSrc(){return hasRequiredLeaflet_markerclusterSrc||(hasRequiredLeaflet_markerclusterSrc=1,(function(X,at){(function(Y,ot){ot(at)})(leaflet_markerclusterSrc,function(Y){var ot=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(z){L.Util.setOptions(this,z),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var N=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,N?this._withAnimation:this._noAnimation),this._markerCluster=N?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(z){if(z instanceof L.LayerGroup)return this.addLayers([z]);if(!z.getLatLng)return this._nonPointGroup.addLayer(z),this.fire("layeradd",{layer:z}),this;if(!this._map)return this._needsClustering.push(z),this.fire("layeradd",{layer:z}),this;if(this.hasLayer(z))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(z,this._maxZoom),this.fire("layeradd",{layer:z}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var N=z,J=this._zoom;if(z.__parent)for(;N.__parent._zoom>=J;)N=N.__parent;return this._currentShownBounds.contains(N.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(z,N):this._animationAddLayerNonAnimated(z,N)),this},removeLayer:function(z){return z instanceof L.LayerGroup?this.removeLayers([z]):z.getLatLng?this._map?z.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(z)),this._removeLayer(z,!0),this.fire("layerremove",{layer:z}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),z.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(z)&&(this._featureGroup.removeLayer(z),z.clusterShow&&z.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,z)&&this.hasLayer(z)&&this._needsRemoving.push({layer:z,latlng:z._latlng}),this.fire("layerremove",{layer:z}),this):(this._nonPointGroup.removeLayer(z),this.fire("layerremove",{layer:z}),this)},addLayers:function(z,N){if(!L.Util.isArray(z))return this.addLayer(z);var J=this._featureGroup,et=this._nonPointGroup,mt=this.options.chunkedLoading,Lt=this.options.chunkInterval,ft=this.options.chunkProgress,kt=z.length,Ct=0,Tt=!0,St;if(this._map){var $t=new Date().getTime(),Ut=L.bind(function(){var ie=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();Ct<kt;Ct++){if(mt&&Ct%200===0){var ei=new Date().getTime()-ie;if(ei>Lt)break}if(St=z[Ct],St instanceof L.LayerGroup){Tt&&(z=z.slice(),Tt=!1),this._extractNonGroupLayers(St,z),kt=z.length;continue}if(!St.getLatLng){et.addLayer(St),N||this.fire("layeradd",{layer:St});continue}if(!this.hasLayer(St)&&(this._addLayer(St,this._maxZoom),N||this.fire("layeradd",{layer:St}),St.__parent&&St.__parent.getChildCount()===2)){var ke=St.__parent.getAllChildMarkers(),Ve=ke[0]===St?ke[1]:ke[0];J.removeLayer(Ve)}}ft&&ft(Ct,kt,new Date().getTime()-$t),Ct===kt?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(Ut,this.options.chunkDelay)},this);Ut()}else for(var ee=this._needsClustering;Ct<kt;Ct++){if(St=z[Ct],St instanceof L.LayerGroup){Tt&&(z=z.slice(),Tt=!1),this._extractNonGroupLayers(St,z),kt=z.length;continue}if(!St.getLatLng){et.addLayer(St);continue}this.hasLayer(St)||ee.push(St)}return this},removeLayers:function(z){var N,J,et=z.length,mt=this._featureGroup,Lt=this._nonPointGroup,ft=!0;if(!this._map){for(N=0;N<et;N++){if(J=z[N],J instanceof L.LayerGroup){ft&&(z=z.slice(),ft=!1),this._extractNonGroupLayers(J,z),et=z.length;continue}this._arraySplice(this._needsClustering,J),Lt.removeLayer(J),this.hasLayer(J)&&this._needsRemoving.push({layer:J,latlng:J._latlng}),this.fire("layerremove",{layer:J})}return this}if(this._unspiderfy){this._unspiderfy();var kt=z.slice(),Ct=et;for(N=0;N<Ct;N++){if(J=kt[N],J instanceof L.LayerGroup){this._extractNonGroupLayers(J,kt),Ct=kt.length;continue}this._unspiderfyLayer(J)}}for(N=0;N<et;N++){if(J=z[N],J instanceof L.LayerGroup){ft&&(z=z.slice(),ft=!1),this._extractNonGroupLayers(J,z),et=z.length;continue}if(!J.__parent){Lt.removeLayer(J),this.fire("layerremove",{layer:J});continue}this._removeLayer(J,!0,!0),this.fire("layerremove",{layer:J}),mt.hasLayer(J)&&(mt.removeLayer(J),J.clusterShow&&J.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(z){z.off(this._childMarkerEventHandlers,this),delete z.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var z=new L.LatLngBounds;this._topClusterLevel&&z.extend(this._topClusterLevel._bounds);for(var N=this._needsClustering.length-1;N>=0;N--)z.extend(this._needsClustering[N].getLatLng());return z.extend(this._nonPointGroup.getBounds()),z},eachLayer:function(z,N){var J=this._needsClustering.slice(),et=this._needsRemoving,mt,Lt,ft;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(J),Lt=J.length-1;Lt>=0;Lt--){for(mt=!0,ft=et.length-1;ft>=0;ft--)if(et[ft].layer===J[Lt]){mt=!1;break}mt&&z.call(N,J[Lt])}this._nonPointGroup.eachLayer(z,N)},getLayers:function(){var z=[];return this.eachLayer(function(N){z.push(N)}),z},getLayer:function(z){var N=null;return z=parseInt(z,10),this.eachLayer(function(J){L.stamp(J)===z&&(N=J)}),N},hasLayer:function(z){if(!z)return!1;var N,J=this._needsClustering;for(N=J.length-1;N>=0;N--)if(J[N]===z)return!0;for(J=this._needsRemoving,N=J.length-1;N>=0;N--)if(J[N].layer===z)return!1;return!!(z.__parent&&z.__parent._group===this)||this._nonPointGroup.hasLayer(z)},zoomToShowLayer:function(z,N){var J=this._map;typeof N!="function"&&(N=function(){});var et=function(){(J.hasLayer(z)||J.hasLayer(z.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",et,this),this.off("animationend",et,this),J.hasLayer(z)?N():z.__parent._icon&&(this.once("spiderfied",N,this),z.__parent.spiderfy()))};z._icon&&this._map.getBounds().contains(z.getLatLng())?N():z.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",et,this),this._map.panTo(z.getLatLng())):(this._map.on("moveend",et,this),this.on("animationend",et,this),z.__parent.zoomToBounds())},onAdd:function(z){this._map=z;var N,J,et;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(z),this._nonPointGroup.addTo(z),this._gridClusters||this._generateInitialClusters(),this._maxLat=z.options.crs.projection.MAX_LATITUDE,N=0,J=this._needsRemoving.length;N<J;N++)et=this._needsRemoving[N],et.newlatlng=et.layer._latlng,et.layer._latlng=et.latlng;for(N=0,J=this._needsRemoving.length;N<J;N++)et=this._needsRemoving[N],this._removeLayer(et.layer,!0),et.layer._latlng=et.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),J=this._needsClustering,this._needsClustering=[],this.addLayers(J,!0)},onRemove:function(z){z.off("zoomend",this._zoomEnd,this),z.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(z){for(var N=z;N&&!N._icon;)N=N.__parent;return N||null},_arraySplice:function(z,N){for(var J=z.length-1;J>=0;J--)if(z[J]===N)return z.splice(J,1),!0},_removeFromGridUnclustered:function(z,N){for(var J=this._map,et=this._gridUnclustered,mt=Math.floor(this._map.getMinZoom());N>=mt&&et[N].removeObject(z,J.project(z.getLatLng(),N));N--);},_childMarkerDragStart:function(z){z.target.__dragStart=z.target._latlng},_childMarkerMoved:function(z){if(!this._ignoreMove&&!z.target.__dragStart){var N=z.target._popup&&z.target._popup.isOpen();this._moveChild(z.target,z.oldLatLng,z.latlng),N&&z.target.openPopup()}},_moveChild:function(z,N,J){z._latlng=N,this.removeLayer(z),z._latlng=J,this.addLayer(z)},_childMarkerDragEnd:function(z){var N=z.target.__dragStart;delete z.target.__dragStart,N&&this._moveChild(z.target,N,z.target._latlng)},_removeLayer:function(z,N,J){var et=this._gridClusters,mt=this._gridUnclustered,Lt=this._featureGroup,ft=this._map,kt=Math.floor(this._map.getMinZoom());N&&this._removeFromGridUnclustered(z,this._maxZoom);var Ct=z.__parent,Tt=Ct._markers,St;for(this._arraySplice(Tt,z);Ct&&(Ct._childCount--,Ct._boundsNeedUpdate=!0,!(Ct._zoom<kt));)N&&Ct._childCount<=1?(St=Ct._markers[0]===z?Ct._markers[1]:Ct._markers[0],et[Ct._zoom].removeObject(Ct,ft.project(Ct._cLatLng,Ct._zoom)),mt[Ct._zoom].addObject(St,ft.project(St.getLatLng(),Ct._zoom)),this._arraySplice(Ct.__parent._childClusters,Ct),Ct.__parent._markers.push(St),St.__parent=Ct.__parent,Ct._icon&&(Lt.removeLayer(Ct),J||Lt.addLayer(St))):Ct._iconNeedsUpdate=!0,Ct=Ct.__parent;delete z.__parent},_isOrIsParent:function(z,N){for(;N;){if(z===N)return!0;N=N.parentNode}return!1},fire:function(z,N,J){if(N&&N.layer instanceof L.MarkerCluster){if(N.originalEvent&&this._isOrIsParent(N.layer._icon,N.originalEvent.relatedTarget))return;z="cluster"+z}L.FeatureGroup.prototype.fire.call(this,z,N,J)},listens:function(z,N){return L.FeatureGroup.prototype.listens.call(this,z,N)||L.FeatureGroup.prototype.listens.call(this,"cluster"+z,N)},_defaultIconCreateFunction:function(z){var N=z.getChildCount(),J=" marker-cluster-";return N<10?J+="small":N<100?J+="medium":J+="large",new L.DivIcon({html:"<div><span>"+N+"</span></div>",className:"marker-cluster"+J,iconSize:new L.Point(40,40)})},_bindEvents:function(){var z=this._map,N=this.options.spiderfyOnMaxZoom,J=this.options.showCoverageOnHover,et=this.options.zoomToBoundsOnClick,mt=this.options.spiderfyOnEveryZoom;(N||et||mt)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),J&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),z.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(z){var N=z.layer,J=N;if(!(z.type==="clusterkeypress"&&z.originalEvent&&z.originalEvent.keyCode!==13)){for(;J._childClusters.length===1;)J=J._childClusters[0];J._zoom===this._maxZoom&&J._childCount===N._childCount&&this.options.spiderfyOnMaxZoom?N.spiderfy():this.options.zoomToBoundsOnClick&&N.zoomToBounds(),this.options.spiderfyOnEveryZoom&&N.spiderfy(),z.originalEvent&&z.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(z){var N=this._map;this._inZoomAnimation||(this._shownPolygon&&N.removeLayer(this._shownPolygon),z.layer.getChildCount()>2&&z.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(z.layer.getConvexHull(),this.options.polygonOptions),N.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var z=this.options.spiderfyOnMaxZoom,N=this.options.showCoverageOnHover,J=this.options.zoomToBoundsOnClick,et=this.options.spiderfyOnEveryZoom,mt=this._map;(z||J||et)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),N&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),mt.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var z=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,z),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),z),this._currentShownBounds=z}},_generateInitialClusters:function(){var z=Math.ceil(this._map.getMaxZoom()),N=Math.floor(this._map.getMinZoom()),J=this.options.maxClusterRadius,et=J;typeof J!="function"&&(et=function(){return J}),this.options.disableClusteringAtZoom!==null&&(z=this.options.disableClusteringAtZoom-1),this._maxZoom=z,this._gridClusters={},this._gridUnclustered={};for(var mt=z;mt>=N;mt--)this._gridClusters[mt]=new L.DistanceGrid(et(mt)),this._gridUnclustered[mt]=new L.DistanceGrid(et(mt));this._topClusterLevel=new this._markerCluster(this,N-1)},_addLayer:function(z,N){var J=this._gridClusters,et=this._gridUnclustered,mt=Math.floor(this._map.getMinZoom()),Lt,ft;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(z),z.on(this._childMarkerEventHandlers,this);N>=mt;N--){Lt=this._map.project(z.getLatLng(),N);var kt=J[N].getNearObject(Lt);if(kt){kt._addChild(z),z.__parent=kt;return}if(kt=et[N].getNearObject(Lt),kt){var Ct=kt.__parent;Ct&&this._removeLayer(kt,!1);var Tt=new this._markerCluster(this,N,kt,z);J[N].addObject(Tt,this._map.project(Tt._cLatLng,N)),kt.__parent=Tt,z.__parent=Tt;var St=Tt;for(ft=N-1;ft>Ct._zoom;ft--)St=new this._markerCluster(this,ft,St),J[ft].addObject(St,this._map.project(kt.getLatLng(),ft));Ct._addChild(St),this._removeFromGridUnclustered(kt,N);return}et[N].addObject(z,Lt)}this._topClusterLevel._addChild(z),z.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(z){z instanceof L.MarkerCluster&&z._iconNeedsUpdate&&z._updateIcon()})},_enqueue:function(z){this._queue.push(z),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var z=0;z<this._queue.length;z++)this._queue[z].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var z=Math.round(this._map._zoom);this._processQueue(),this._zoom<z&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,z)):this._zoom>z?(this._animationStart(),this._animationZoomOut(this._zoom,z)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(z){var N=this._maxLat;return N!==void 0&&(z.getNorth()>=N&&(z._northEast.lat=1/0),z.getSouth()<=-N&&(z._southWest.lat=-1/0)),z},_animationAddLayerNonAnimated:function(z,N){if(N===z)this._featureGroup.addLayer(z);else if(N._childCount===2){N._addToMap();var J=N.getAllChildMarkers();this._featureGroup.removeLayer(J[0]),this._featureGroup.removeLayer(J[1])}else N._updateIcon()},_extractNonGroupLayers:function(z,N){var J=z.getLayers(),et=0,mt;for(N=N||[];et<J.length;et++){if(mt=J[et],mt instanceof L.LayerGroup){this._extractNonGroupLayers(mt,N);continue}N.push(mt)}return N},_overrideMarkerIcon:function(z){var N=z.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[z]}});return N}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(z,N){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),z),this._topClusterLevel._recursivelyAddChildrenToMap(null,N,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(z,N){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),z),this._topClusterLevel._recursivelyAddChildrenToMap(null,N,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(z,N){this._animationAddLayerNonAnimated(z,N)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(z,N){var J=this._getExpandedVisibleBounds(),et=this._featureGroup,mt=Math.floor(this._map.getMinZoom()),Lt;this._ignoreMove=!0,this._topClusterLevel._recursively(J,z,mt,function(ft){var kt=ft._latlng,Ct=ft._markers,Tt;for(J.contains(kt)||(kt=null),ft._isSingleParent()&&z+1===N?(et.removeLayer(ft),ft._recursivelyAddChildrenToMap(null,N,J)):(ft.clusterHide(),ft._recursivelyAddChildrenToMap(kt,N,J)),Lt=Ct.length-1;Lt>=0;Lt--)Tt=Ct[Lt],J.contains(Tt._latlng)||et.removeLayer(Tt)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(J,N),et.eachLayer(function(ft){!(ft instanceof L.MarkerCluster)&&ft._icon&&ft.clusterShow()}),this._topClusterLevel._recursively(J,z,N,function(ft){ft._recursivelyRestoreChildPositions(N)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(J,z,mt,function(ft){et.removeLayer(ft),ft.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(z,N){this._animationZoomOutSingle(this._topClusterLevel,z-1,N),this._topClusterLevel._recursivelyAddChildrenToMap(null,N,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),z,this._getExpandedVisibleBounds())},_animationAddLayer:function(z,N){var J=this,et=this._featureGroup;et.addLayer(z),N!==z&&(N._childCount>2?(N._updateIcon(),this._forceLayout(),this._animationStart(),z._setPos(this._map.latLngToLayerPoint(N.getLatLng())),z.clusterHide(),this._enqueue(function(){et.removeLayer(z),z.clusterShow(),J._animationEnd()})):(this._forceLayout(),J._animationStart(),J._animationZoomOutSingle(N,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(z,N,J){var et=this._getExpandedVisibleBounds(),mt=Math.floor(this._map.getMinZoom());z._recursivelyAnimateChildrenInAndAddSelfToMap(et,mt,N+1,J);var Lt=this;this._forceLayout(),z._recursivelyBecomeVisible(et,J),this._enqueue(function(){if(z._childCount===1){var ft=z._markers[0];this._ignoreMove=!0,ft.setLatLng(ft.getLatLng()),this._ignoreMove=!1,ft.clusterShow&&ft.clusterShow()}else z._recursively(et,J,mt,function(kt){kt._recursivelyRemoveChildrenFromMap(et,mt,N+1)});Lt._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(z){return new L.MarkerClusterGroup(z)};var lt=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(z,N,J,et){L.Marker.prototype.initialize.call(this,J?J._cLatLng||J.getLatLng():new L.LatLng(0,0),{icon:this,pane:z.options.clusterPane}),this._group=z,this._zoom=N,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,J&&this._addChild(J),et&&this._addChild(et)},getAllChildMarkers:function(z,N){z=z||[];for(var J=this._childClusters.length-1;J>=0;J--)this._childClusters[J].getAllChildMarkers(z,N);for(var et=this._markers.length-1;et>=0;et--)N&&this._markers[et].__dragStart||z.push(this._markers[et]);return z},getChildCount:function(){return this._childCount},zoomToBounds:function(z){for(var N=this._childClusters.slice(),J=this._group._map,et=J.getBoundsZoom(this._bounds),mt=this._zoom+1,Lt=J.getZoom(),ft;N.length>0&&et>mt;){mt++;var kt=[];for(ft=0;ft<N.length;ft++)kt=kt.concat(N[ft]._childClusters);N=kt}et>mt?this._group._map.setView(this._latlng,mt):et<=Lt?this._group._map.setView(this._latlng,Lt+1):this._group._map.fitBounds(this._bounds,z)},getBounds:function(){var z=new L.LatLngBounds;return z.extend(this._bounds),z},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(z,N){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(z),z instanceof L.MarkerCluster?(N||(this._childClusters.push(z),z.__parent=this),this._childCount+=z._childCount):(N||this._markers.push(z),this._childCount++),this.__parent&&this.__parent._addChild(z,!0)},_setClusterCenter:function(z){this._cLatLng||(this._cLatLng=z._cLatLng||z._latlng)},_resetBounds:function(){var z=this._bounds;z._southWest&&(z._southWest.lat=1/0,z._southWest.lng=1/0),z._northEast&&(z._northEast.lat=-1/0,z._northEast.lng=-1/0)},_recalculateBounds:function(){var z=this._markers,N=this._childClusters,J=0,et=0,mt=this._childCount,Lt,ft,kt,Ct;if(mt!==0){for(this._resetBounds(),Lt=0;Lt<z.length;Lt++)kt=z[Lt]._latlng,this._bounds.extend(kt),J+=kt.lat,et+=kt.lng;for(Lt=0;Lt<N.length;Lt++)ft=N[Lt],ft._boundsNeedUpdate&&ft._recalculateBounds(),this._bounds.extend(ft._bounds),kt=ft._wLatLng,Ct=ft._childCount,J+=kt.lat*Ct,et+=kt.lng*Ct;this._latlng=this._wLatLng=new L.LatLng(J/mt,et/mt),this._boundsNeedUpdate=!1}},_addToMap:function(z){z&&(this._backupLatlng=this._latlng,this.setLatLng(z)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(z,N,J){this._recursively(z,this._group._map.getMinZoom(),J-1,function(et){var mt=et._markers,Lt,ft;for(Lt=mt.length-1;Lt>=0;Lt--)ft=mt[Lt],ft._icon&&(ft._setPos(N),ft.clusterHide())},function(et){var mt=et._childClusters,Lt,ft;for(Lt=mt.length-1;Lt>=0;Lt--)ft=mt[Lt],ft._icon&&(ft._setPos(N),ft.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(z,N,J,et){this._recursively(z,et,N,function(mt){mt._recursivelyAnimateChildrenIn(z,mt._group._map.latLngToLayerPoint(mt.getLatLng()).round(),J),mt._isSingleParent()&&J-1===et?(mt.clusterShow(),mt._recursivelyRemoveChildrenFromMap(z,N,J)):mt.clusterHide(),mt._addToMap()})},_recursivelyBecomeVisible:function(z,N){this._recursively(z,this._group._map.getMinZoom(),N,null,function(J){J.clusterShow()})},_recursivelyAddChildrenToMap:function(z,N,J){this._recursively(J,this._group._map.getMinZoom()-1,N,function(et){if(N!==et._zoom)for(var mt=et._markers.length-1;mt>=0;mt--){var Lt=et._markers[mt];J.contains(Lt._latlng)&&(z&&(Lt._backupLatlng=Lt.getLatLng(),Lt.setLatLng(z),Lt.clusterHide&&Lt.clusterHide()),et._group._featureGroup.addLayer(Lt))}},function(et){et._addToMap(z)})},_recursivelyRestoreChildPositions:function(z){for(var N=this._markers.length-1;N>=0;N--){var J=this._markers[N];J._backupLatlng&&(J.setLatLng(J._backupLatlng),delete J._backupLatlng)}if(z-1===this._zoom)for(var et=this._childClusters.length-1;et>=0;et--)this._childClusters[et]._restorePosition();else for(var mt=this._childClusters.length-1;mt>=0;mt--)this._childClusters[mt]._recursivelyRestoreChildPositions(z)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(z,N,J,et){var mt,Lt;this._recursively(z,N-1,J-1,function(ft){for(Lt=ft._markers.length-1;Lt>=0;Lt--)mt=ft._markers[Lt],(!et||!et.contains(mt._latlng))&&(ft._group._featureGroup.removeLayer(mt),mt.clusterShow&&mt.clusterShow())},function(ft){for(Lt=ft._childClusters.length-1;Lt>=0;Lt--)mt=ft._childClusters[Lt],(!et||!et.contains(mt._latlng))&&(ft._group._featureGroup.removeLayer(mt),mt.clusterShow&&mt.clusterShow())})},_recursively:function(z,N,J,et,mt){var Lt=this._childClusters,ft=this._zoom,kt,Ct;if(N<=ft&&(et&&et(this),mt&&ft===J&&mt(this)),ft<N||ft<J)for(kt=Lt.length-1;kt>=0;kt--)Ct=Lt[kt],Ct._boundsNeedUpdate&&Ct._recalculateBounds(),z.intersects(Ct._bounds)&&Ct._recursively(z,N,J,et,mt)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var z=this.options.opacity;return this.setOpacity(0),this.options.opacity=z,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(z){this._cellSize=z,this._sqCellSize=z*z,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(z,N){var J=this._getCoord(N.x),et=this._getCoord(N.y),mt=this._grid,Lt=mt[et]=mt[et]||{},ft=Lt[J]=Lt[J]||[],kt=L.Util.stamp(z);this._objectPoint[kt]=N,ft.push(z)},updateObject:function(z,N){this.removeObject(z),this.addObject(z,N)},removeObject:function(z,N){var J=this._getCoord(N.x),et=this._getCoord(N.y),mt=this._grid,Lt=mt[et]=mt[et]||{},ft=Lt[J]=Lt[J]||[],kt,Ct;for(delete this._objectPoint[L.Util.stamp(z)],kt=0,Ct=ft.length;kt<Ct;kt++)if(ft[kt]===z)return ft.splice(kt,1),Ct===1&&delete Lt[J],!0},eachObject:function(z,N){var J,et,mt,Lt,ft,kt,Ct,Tt=this._grid;for(J in Tt){ft=Tt[J];for(et in ft)for(kt=ft[et],mt=0,Lt=kt.length;mt<Lt;mt++)Ct=z.call(N,kt[mt]),Ct&&(mt--,Lt--)}},getNearObject:function(z){var N=this._getCoord(z.x),J=this._getCoord(z.y),et,mt,Lt,ft,kt,Ct,Tt,St,$t=this._objectPoint,Ut=this._sqCellSize,ee=null;for(et=J-1;et<=J+1;et++)if(ft=this._grid[et],ft){for(mt=N-1;mt<=N+1;mt++)if(kt=ft[mt],kt)for(Lt=0,Ct=kt.length;Lt<Ct;Lt++)Tt=kt[Lt],St=this._sqDist($t[L.Util.stamp(Tt)],z),(St<Ut||St<=Ut&&ee===null)&&(Ut=St,ee=Tt)}return ee},_getCoord:function(z){var N=Math.floor(z/this._cellSize);return isFinite(N)?N:z},_sqDist:function(z,N){var J=N.x-z.x,et=N.y-z.y;return J*J+et*et}},(function(){L.QuickHull={getDistant:function(z,N){var J=N[1].lat-N[0].lat,et=N[0].lng-N[1].lng;return et*(z.lat-N[0].lat)+J*(z.lng-N[0].lng)},findMostDistantPointFromBaseLine:function(z,N){var J=0,et=null,mt=[],Lt,ft,kt;for(Lt=N.length-1;Lt>=0;Lt--){if(ft=N[Lt],kt=this.getDistant(ft,z),kt>0)mt.push(ft);else continue;kt>J&&(J=kt,et=ft)}return{maxPoint:et,newPoints:mt}},buildConvexHull:function(z,N){var J=[],et=this.findMostDistantPointFromBaseLine(z,N);return et.maxPoint?(J=J.concat(this.buildConvexHull([z[0],et.maxPoint],et.newPoints)),J=J.concat(this.buildConvexHull([et.maxPoint,z[1]],et.newPoints)),J):[z[0]]},getConvexHull:function(z){var N=!1,J=!1,et=!1,mt=!1,Lt=null,ft=null,kt=null,Ct=null,Tt=null,St=null,$t;for($t=z.length-1;$t>=0;$t--){var Ut=z[$t];(N===!1||Ut.lat>N)&&(Lt=Ut,N=Ut.lat),(J===!1||Ut.lat<J)&&(ft=Ut,J=Ut.lat),(et===!1||Ut.lng>et)&&(kt=Ut,et=Ut.lng),(mt===!1||Ut.lng<mt)&&(Ct=Ut,mt=Ut.lng)}J!==N?(St=ft,Tt=Lt):(St=Ct,Tt=kt);var ee=[].concat(this.buildConvexHull([St,Tt],z),this.buildConvexHull([Tt,St],z));return ee}}})(),L.MarkerCluster.include({getConvexHull:function(){var z=this.getAllChildMarkers(),N=[],J,et;for(et=z.length-1;et>=0;et--)J=z[et].getLatLng(),N.push(J);return L.QuickHull.getConvexHull(N)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var z=this.getAllChildMarkers(null,!0),N=this._group,J=N._map,et=J.latLngToLayerPoint(this._latlng),mt;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?mt=this._group.options.spiderfyShapePositions(z.length,et):z.length>=this._circleSpiralSwitchover?mt=this._generatePointsSpiral(z.length,et):(et.y+=10,mt=this._generatePointsCircle(z.length,et)),this._animationSpiderfy(z,mt)}},unspiderfy:function(z){this._group._inZoomAnimation||(this._animationUnspiderfy(z),this._group._spiderfied=null)},_generatePointsCircle:function(z,N){var J=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+z),et=J/this._2PI,mt=this._2PI/z,Lt=[],ft,kt;for(et=Math.max(et,35),Lt.length=z,ft=0;ft<z;ft++)kt=this._circleStartAngle+ft*mt,Lt[ft]=new L.Point(N.x+et*Math.cos(kt),N.y+et*Math.sin(kt))._round();return Lt},_generatePointsSpiral:function(z,N){var J=this._group.options.spiderfyDistanceMultiplier,et=J*this._spiralLengthStart,mt=J*this._spiralFootSeparation,Lt=J*this._spiralLengthFactor*this._2PI,ft=0,kt=[],Ct;for(kt.length=z,Ct=z;Ct>=0;Ct--)Ct<z&&(kt[Ct]=new L.Point(N.x+et*Math.cos(ft),N.y+et*Math.sin(ft))._round()),ft+=mt/et+Ct*5e-4,et+=Lt/ft;return kt},_noanimationUnspiderfy:function(){var z=this._group,N=z._map,J=z._featureGroup,et=this.getAllChildMarkers(null,!0),mt,Lt;for(z._ignoreMove=!0,this.setOpacity(1),Lt=et.length-1;Lt>=0;Lt--)mt=et[Lt],J.removeLayer(mt),mt._preSpiderfyLatlng&&(mt.setLatLng(mt._preSpiderfyLatlng),delete mt._preSpiderfyLatlng),mt.setZIndexOffset&&mt.setZIndexOffset(0),mt._spiderLeg&&(N.removeLayer(mt._spiderLeg),delete mt._spiderLeg);z.fire("unspiderfied",{cluster:this,markers:et}),z._ignoreMove=!1,z._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(z,N){var J=this._group,et=J._map,mt=J._featureGroup,Lt=this._group.options.spiderLegPolylineOptions,ft,kt,Ct,Tt;for(J._ignoreMove=!0,ft=0;ft<z.length;ft++)Tt=et.layerPointToLatLng(N[ft]),kt=z[ft],Ct=new L.Polyline([this._latlng,Tt],Lt),et.addLayer(Ct),kt._spiderLeg=Ct,kt._preSpiderfyLatlng=kt._latlng,kt.setLatLng(Tt),kt.setZIndexOffset&&kt.setZIndexOffset(1e6),mt.addLayer(kt);this.setOpacity(.3),J._ignoreMove=!1,J.fire("spiderfied",{cluster:this,markers:z})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(z,N){var J=this,et=this._group,mt=et._map,Lt=et._featureGroup,ft=this._latlng,kt=mt.latLngToLayerPoint(ft),Ct=L.Path.SVG,Tt=L.extend({},this._group.options.spiderLegPolylineOptions),St=Tt.opacity,$t,Ut,ee,ie,ei,ke;for(St===void 0&&(St=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),Ct?(Tt.opacity=0,Tt.className=(Tt.className||"")+" leaflet-cluster-spider-leg"):Tt.opacity=St,et._ignoreMove=!0,$t=0;$t<z.length;$t++)Ut=z[$t],ke=mt.layerPointToLatLng(N[$t]),ee=new L.Polyline([ft,ke],Tt),mt.addLayer(ee),Ut._spiderLeg=ee,Ct&&(ie=ee._path,ei=ie.getTotalLength()+.1,ie.style.strokeDasharray=ei,ie.style.strokeDashoffset=ei),Ut.setZIndexOffset&&Ut.setZIndexOffset(1e6),Ut.clusterHide&&Ut.clusterHide(),Lt.addLayer(Ut),Ut._setPos&&Ut._setPos(kt);for(et._forceLayout(),et._animationStart(),$t=z.length-1;$t>=0;$t--)ke=mt.layerPointToLatLng(N[$t]),Ut=z[$t],Ut._preSpiderfyLatlng=Ut._latlng,Ut.setLatLng(ke),Ut.clusterShow&&Ut.clusterShow(),Ct&&(ee=Ut._spiderLeg,ie=ee._path,ie.style.strokeDashoffset=0,ee.setStyle({opacity:St}));this.setOpacity(.3),et._ignoreMove=!1,setTimeout(function(){et._animationEnd(),et.fire("spiderfied",{cluster:J,markers:z})},200)},_animationUnspiderfy:function(z){var N=this,J=this._group,et=J._map,mt=J._featureGroup,Lt=z?et._latLngToNewLayerPoint(this._latlng,z.zoom,z.center):et.latLngToLayerPoint(this._latlng),ft=this.getAllChildMarkers(null,!0),kt=L.Path.SVG,Ct,Tt,St,$t,Ut,ee;for(J._ignoreMove=!0,J._animationStart(),this.setOpacity(1),Tt=ft.length-1;Tt>=0;Tt--)Ct=ft[Tt],Ct._preSpiderfyLatlng&&(Ct.closePopup(),Ct.setLatLng(Ct._preSpiderfyLatlng),delete Ct._preSpiderfyLatlng,ee=!0,Ct._setPos&&(Ct._setPos(Lt),ee=!1),Ct.clusterHide&&(Ct.clusterHide(),ee=!1),ee&&mt.removeLayer(Ct),kt&&(St=Ct._spiderLeg,$t=St._path,Ut=$t.getTotalLength()+.1,$t.style.strokeDashoffset=Ut,St.setStyle({opacity:0})));J._ignoreMove=!1,setTimeout(function(){var ie=0;for(Tt=ft.length-1;Tt>=0;Tt--)Ct=ft[Tt],Ct._spiderLeg&&ie++;for(Tt=ft.length-1;Tt>=0;Tt--)Ct=ft[Tt],Ct._spiderLeg&&(Ct.clusterShow&&Ct.clusterShow(),Ct.setZIndexOffset&&Ct.setZIndexOffset(0),ie>1&&mt.removeLayer(Ct),et.removeLayer(Ct._spiderLeg),delete Ct._spiderLeg);J._animationEnd(),J.fire("unspiderfied",{cluster:N,markers:ft})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(z){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(z))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(z){this._spiderfied&&this._spiderfied.unspiderfy(z)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(z){z._spiderLeg&&(this._featureGroup.removeLayer(z),z.clusterShow&&z.clusterShow(),z.setZIndexOffset&&z.setZIndexOffset(0),this._map.removeLayer(z._spiderLeg),delete z._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(z){return z?z instanceof L.MarkerClusterGroup?z=z._topClusterLevel.getAllChildMarkers():z instanceof L.LayerGroup?z=z._layers:z instanceof L.MarkerCluster?z=z.getAllChildMarkers():z instanceof L.Marker&&(z=[z]):z=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(z),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(z),this},_flagParentsIconsNeedUpdate:function(z){var N,J;for(N in z)for(J=z[N].__parent;J;)J._iconNeedsUpdate=!0,J=J.__parent},_refreshSingleMarkerModeMarkers:function(z){var N,J;for(N in z)J=z[N],this.hasLayer(J)&&J.setIcon(this._overrideMarkerIcon(J))}}),L.Marker.include({refreshIconOptions:function(z,N){var J=this.options.icon;return L.setOptions(J,z),this.setIcon(J),N&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),Y.MarkerClusterGroup=ot,Y.MarkerCluster=lt,Object.defineProperty(Y,"__esModule",{value:!0})})})(leaflet_markerclusterSrc$1,leaflet_markerclusterSrc$1.exports)),leaflet_markerclusterSrc$1.exports}requireLeaflet_markerclusterSrc();typeof document>"u"&&console.warn('"window.document" is undefined; leaflet.fullscreen requires this object to access the DOM');const nativeAPI=(()=>{const X=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"]],at=X[0],Y={};for(const ot of X)if(ot[1]in document){for(let lt=0;lt<ot.length;lt++)Y[at[lt]]=ot[lt];return Y}return!1})(),eventNameMap={change:nativeAPI.fullscreenchange,error:nativeAPI.fullscreenerror},fullscreenAPI={async request(X,at){X=X||document.documentElement;const Y=nativeAPI.requestFullscreen;await this._callNative(()=>X[Y](at))},async exit(){if(!this.isFullscreen)return;const X=nativeAPI.exitFullscreen;await this._callNative(()=>document[X]())},async _callNative(X){const at=X();if(at instanceof Promise){await at;return}await new Promise(Y=>{const ot=()=>{this.off("change",ot),Y()};this.on("change",ot)})},on(X,at){const Y=eventNameMap[X];Y&&document.addEventListener(Y,at)},off(X,at){const Y=eventNameMap[X];Y&&document.removeEventListener(Y,at)},nativeAPI};Object.defineProperties(fullscreenAPI,{isFullscreen:{get(){return!!document[nativeAPI.fullscreenElement]}},isEnabled:{enumerable:!0,get(){return!!document[nativeAPI.fullscreenEnabled]}}});const FullScreen=leafletSrcExports.Control.extend({options:{position:"topleft",title:"Full Screen",titleCancel:"Exit Full Screen",forceSeparateButton:!1,forcePseudoFullscreen:!1,fullscreenElement:!1},_screenfull:fullscreenAPI,onAdd(X){let at="leaflet-control-zoom-fullscreen",Y,ot="";return X.zoomControl&&!this.options.forceSeparateButton?Y=X.zoomControl._container:Y=leafletSrcExports.DomUtil.create("div","leaflet-bar"),this.options.content?ot=this.options.content:at+=" leaflet-fullscreen-icon",this._createButton(this.options.title,at,ot,Y,this.toggleFullScreen,this),this._map.fullscreenControl=this,this._map.on("enterFullscreen exitFullscreen",this._toggleState,this),Y},onRemove(){leafletSrcExports.DomEvent.off(this.link,"click",leafletSrcExports.DomEvent.stop).off(this.link,"click",this.toggleFullScreen,this),this._screenfull.isEnabled&&(leafletSrcExports.DomEvent.off(this._container,this._screenfull.nativeAPI.fullscreenchange,leafletSrcExports.DomEvent.stop).off(this._container,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,this),leafletSrcExports.DomEvent.off(document,this._screenfull.nativeAPI.fullscreenchange,leafletSrcExports.DomEvent.stop).off(document,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,this))},_createButton(X,at,Y,ot,lt,z){return this.link=leafletSrcExports.DomUtil.create("a",at,ot),this.link.href="#",this.link.title=X,this.link.innerHTML=Y,this.link.setAttribute("role","button"),this.link.setAttribute("aria-label",X),leafletSrcExports.DomEvent.disableClickPropagation(ot),leafletSrcExports.DomEvent.on(this.link,"click",leafletSrcExports.DomEvent.stop).on(this.link,"click",lt,z),this._screenfull.isEnabled&&(leafletSrcExports.DomEvent.on(ot,this._screenfull.nativeAPI.fullscreenchange,leafletSrcExports.DomEvent.stop).on(ot,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,z),leafletSrcExports.DomEvent.on(document,this._screenfull.nativeAPI.fullscreenchange,leafletSrcExports.DomEvent.stop).on(document,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,z)),this.link},toggleFullScreen(){const X=this._map;if(X._exitFired=!1,X._isFullscreen){if(this._screenfull.isEnabled&&!this.options.forcePseudoFullscreen)this._screenfull.exit().then(()=>X.invalidateSize());else{const at=this.options.fullscreenElement?this.options.fullscreenElement:X._container;at&&at.classList&&at.classList.remove("leaflet-pseudo-fullscreen"),X.invalidateSize()}X.fire("exitFullscreen"),X._exitFired=!0,X._isFullscreen=!1}else{if(this._screenfull.isEnabled&&!this.options.forcePseudoFullscreen)this._screenfull.request(this.options.fullscreenElement?this.options.fullscreenElement:X._container).then(()=>X.invalidateSize());else{const at=this.options.fullscreenElement?this.options.fullscreenElement:X._container;at&&at.classList&&at.classList.add("leaflet-pseudo-fullscreen"),X.invalidateSize()}X.fire("enterFullscreen"),X._isFullscreen=!0}},_toggleState(){this.link.title=this._map._isFullscreen?this.options.title:this.options.titleCancel,this.link&&this.link.classList&&(this._map._isFullscreen?this.link.classList.remove("leaflet-fullscreen-on"):this.link.classList.add("leaflet-fullscreen-on"))},_handleFullscreenChange(X){const at=this._map,Y=this.options.fullscreenElement||at.getContainer(),ot=X.target===Y,lt=!this._screenfull.isFullscreen&&!at._exitFired;ot&&lt&&(at._exitFired=!0,at.fire("exitFullscreen"),at._isFullscreen=!1,this._screenfull.exit().then(()=>at.invalidateSize()))}});leafletSrcExports.Map.include({toggleFullscreen(){this.fullscreenControl.toggleFullScreen()}});function e(){return e=Object.assign?Object.assign.bind():function(X){for(var at=1;at<arguments.length;at++){var Y=arguments[at];for(var ot in Y)Object.prototype.hasOwnProperty.call(Y,ot)&&(X[ot]=Y[ot])}return X},e.apply(this,arguments)}function r(X,at){X.prototype=Object.create(at.prototype),X.prototype.constructor=X,n(X,at)}function n(X,at){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Y,ot){return Y.__proto__=ot,Y},n(X,at)}function o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(X,at,Y){return i=o()?Reflect.construct.bind():function(ot,lt,z){var N=[null];N.push.apply(N,lt);var J=new(Function.bind.apply(ot,N));return z&&n(J,z.prototype),J},i.apply(null,arguments)}function s(X,at,Y,ot){at===void 0&&(at=""),ot===void 0&&(ot={});var lt=document.createElement(X);return at&&(lt.className=at),Object.keys(ot).forEach(function(z){if(typeof ot[z]=="function"){var N=z.indexOf("on")===0?z.substr(2).toLowerCase():z;lt.addEventListener(N,ot[z])}else z==="html"?lt.innerHTML=ot[z]:z==="text"?lt.innerText=ot[z]:lt.setAttribute(z,ot[z])}),Y&&Y.appendChild(lt),lt}function a(X){X.preventDefault(),X.stopPropagation()}var l=function(){return[].slice.call(arguments).filter(Boolean).join(" ").trim()};function c(X,at){X&&X.classList&&(Array.isArray(at)?at:[at]).forEach(function(Y){X.classList.contains(Y)||X.classList.add(Y)})}function u(X,at){X&&X.classList&&(Array.isArray(at)?at:[at]).forEach(function(Y){X.classList.contains(Y)&&X.classList.remove(Y)})}var h,p=13,d=40,f=38,m=[p,27,d,f,37,39],v=(function(){function X(Y){var ot=this,lt=Y.handleSubmit,z=Y.searchLabel,N=Y.classNames,J=N===void 0?{}:N;this.container=void 0,this.form=void 0,this.input=void 0,this.handleSubmit=void 0,this.hasError=!1,this.container=s("div",l("geosearch",J.container)),this.form=s("form",["",J.form].join(" "),this.container,{autocomplete:"none",onClick:a,onDblClick:a,touchStart:a,touchEnd:a}),this.input=s("input",["glass",J.input].join(" "),this.form,{type:"text",placeholder:z||"search",onInput:this.onInput,onKeyUp:function(et){return ot.onKeyUp(et)},onKeyPress:function(et){return ot.onKeyPress(et)},onFocus:this.onFocus,onBlur:this.onBlur,onClick:function(){ot.input.focus(),ot.input.dispatchEvent(new Event("focus"))}}),this.handleSubmit=lt}var at=X.prototype;return at.onFocus=function(){c(this.form,"active")},at.onBlur=function(){u(this.form,"active")},at.onSubmit=function(Y){try{var ot=this;return a(Y),u(lt=ot.container,"error"),c(lt,"pending"),Promise.resolve(ot.handleSubmit({query:ot.input.value})).then(function(){u(ot.container,"pending")})}catch(z){return Promise.reject(z)}var lt},at.onInput=function(){this.hasError&&(u(this.container,"error"),this.hasError=!1)},at.onKeyUp=function(Y){Y.keyCode===27&&(u(this.container,["pending","active"]),this.input.value="",document.body.focus(),document.body.blur())},at.onKeyPress=function(Y){Y.keyCode===p&&this.onSubmit(Y)},at.setQuery=function(Y){this.input.value=Y},X})(),g=(function(){function X(Y){var ot=this,lt=Y.handleClick,z=Y.classNames,N=z===void 0?{}:z,J=Y.notFoundMessage;this.handleClick=void 0,this.selected=-1,this.results=[],this.container=void 0,this.resultItem=void 0,this.notFoundMessage=void 0,this.onClick=function(et){if(typeof ot.handleClick=="function"){var mt=et.target;if(mt&&ot.container.contains(mt)&&mt.hasAttribute("data-key")){var Lt=Number(mt.getAttribute("data-key"));ot.handleClick({result:ot.results[Lt]})}}},this.handleClick=lt,this.notFoundMessage=J?s("div",l(N.notfound),void 0,{html:J}):void 0,this.container=s("div",l("results",N.resultlist)),this.container.addEventListener("click",this.onClick,!0),this.resultItem=s("div",l(N.item))}var at=X.prototype;return at.render=function(Y,ot){var lt=this;Y===void 0&&(Y=[]),this.clear(),Y.forEach(function(z,N){var J=lt.resultItem.cloneNode(!0);J.setAttribute("data-key",""+N),J.innerHTML=ot({result:z}),lt.container.appendChild(J)}),Y.length>0?(c(this.container.parentElement,"open"),c(this.container,"active")):this.notFoundMessage&&(this.container.appendChild(this.notFoundMessage),c(this.container.parentElement,"open")),this.results=Y},at.select=function(Y){return Array.from(this.container.children).forEach(function(ot,lt){return lt===Y?c(ot,"active"):u(ot,"active")}),this.selected=Y,this.results[Y]},at.count=function(){return this.results?this.results.length:0},at.clear=function(){for(this.selected=-1;this.container.lastChild;)this.container.removeChild(this.container.lastChild);u(this.container.parentElement,"open"),u(this.container,"active")},X})(),y={position:"topleft",style:"button",showMarker:!0,showPopup:!1,popupFormat:function(X){return""+X.result.label},resultFormat:function(X){return""+X.result.label},marker:{icon:t&&leafletSrcExports.Icon?new leafletSrcExports.Icon.Default:void 0,draggable:!1},maxMarkers:1,maxSuggestions:5,retainZoomLevel:!1,animateZoom:!0,searchLabel:"Enter address",clearSearchLabel:"Clear search",notFoundMessage:"",messageHideDelay:3e3,zoomLevel:18,classNames:{container:"leaflet-bar leaflet-control leaflet-control-geosearch",button:"leaflet-bar-part leaflet-bar-part-single",resetButton:"reset",msgbox:"leaflet-bar message",form:"",input:"",resultlist:"",item:"",notfound:"leaflet-bar-notfound"},autoComplete:!0,autoCompleteDelay:250,autoClose:!1,keepResult:!1,updateMap:!0,resetButton:""},b="Leaflet must be loaded before instantiating the GeoSearch control",E={options:e({},y),classNames:e({},y.classNames),initialize:function(X){var at,Y,ot,lt,z=this;if(!t)throw new Error(b);if(!X.provider)throw new Error("Provider is missing from options");this.options=e({},y,X),this.classNames=e({},this.classNames,X.classNames),this.markers=new leafletSrcExports.FeatureGroup,this.classNames.container+=" leaflet-geosearch-"+this.options.style,this.searchElement=new v({searchLabel:this.options.searchLabel,classNames:{container:this.classNames.container,form:this.classNames.form,input:this.classNames.input},handleSubmit:function(N){return z.onSubmit(N)}}),this.button=s("a",this.classNames.button,this.searchElement.container,{title:this.options.searchLabel,href:"#",onClick:function(N){return z.onClick(N)}}),leafletSrcExports.DomEvent.disableClickPropagation(this.button),this.resetButton=s("button",this.classNames.resetButton,this.searchElement.form,{text:this.options.resetButton,"aria-label":this.options.clearSearchLabel,onClick:function(){z.searchElement.input.value===""?z.close():z.clearResults(null,!0)}}),leafletSrcExports.DomEvent.disableClickPropagation(this.resetButton),this.options.autoComplete&&(this.resultList=new g({handleClick:function(N){var J=N.result;z.searchElement.input.value=J.label,z.onSubmit({query:J.label,data:J})},classNames:{resultlist:this.classNames.resultlist,item:this.classNames.item,notfound:this.classNames.notfound},notFoundMessage:this.options.notFoundMessage}),this.searchElement.form.appendChild(this.resultList.container),this.searchElement.input.addEventListener("keyup",(at=function(N){return z.autoSearch(N)},(Y=this.options.autoCompleteDelay)===void 0&&(Y=250),ot===void 0&&(ot=!1),function(){var N=[].slice.call(arguments);lt&&clearTimeout(lt),lt=setTimeout(function(){lt=null,ot||at.apply(void 0,N)},Y),ot&&!lt&&at.apply(void 0,N)}),!0),this.searchElement.input.addEventListener("keydown",function(N){return z.selectResult(N)},!0),this.searchElement.input.addEventListener("keydown",function(N){return z.clearResults(N,!0)},!0)),this.searchElement.form.addEventListener("click",function(N){N.preventDefault()},!1)},onAdd:function(X){var at=this.options,Y=at.showMarker,ot=at.style;if(this.map=X,Y&&this.markers.addTo(X),ot==="bar"){var lt=X.getContainer().querySelector(".leaflet-control-container");this.container=s("div","leaflet-control-geosearch leaflet-geosearch-bar"),this.container.appendChild(this.searchElement.form),lt.appendChild(this.container)}return leafletSrcExports.DomEvent.disableClickPropagation(this.searchElement.form),this.searchElement.container},onRemove:function(){var X;return(X=this.container)==null||X.remove(),this},open:function(){var X=this.searchElement,at=X.input;c(X.container,"active"),at.focus()},close:function(){u(this.searchElement.container,"active"),this.clearResults()},onClick:function(X){X.preventDefault(),X.stopPropagation(),this.searchElement.container.classList.contains("active")?this.close():this.open()},selectResult:function(X){if([p,d,f].indexOf(X.keyCode)!==-1)if(X.preventDefault(),X.keyCode!==p){var at=this.resultList.count()-1;if(!(at<0)){var Y=this.resultList.selected,ot=X.keyCode===d?Y+1:Y-1,lt=this.resultList.select(ot<0?at:ot>at?0:ot);this.searchElement.input.value=lt.label}}else{var z=this.resultList.select(this.resultList.selected);this.onSubmit({query:this.searchElement.input.value,data:z})}},clearResults:function(X,at){if(at===void 0&&(at=!1),!X||X.keyCode===27){var Y=this.options,ot=Y.autoComplete;!at&&Y.keepResult||(this.searchElement.input.value="",this.markers.clearLayers()),ot&&this.resultList.clear()}},autoSearch:function(X){try{var at=this;if(m.indexOf(X.keyCode)>-1)return Promise.resolve();var Y=X.target.value,ot=at.options.provider,lt=(function(){if(Y.length)return Promise.resolve(ot.search({query:Y})).then(function(z){z=z.slice(0,at.options.maxSuggestions),at.resultList.render(z,at.options.resultFormat)});at.resultList.clear()})();return Promise.resolve(lt&&lt.then?lt.then(function(){}):void 0)}catch(z){return Promise.reject(z)}},onSubmit:function(X){try{var at=this;return at.resultList.clear(),Promise.resolve(at.options.provider.search(X)).then(function(Y){Y&&Y.length>0&&at.showResult(Y[0],X)})}catch(Y){return Promise.reject(Y)}},showResult:function(X,at){var Y=this.options,ot=Y.autoClose,lt=Y.updateMap,z=this.markers.getLayers();z.length>=this.options.maxMarkers&&this.markers.removeLayer(z[0]);var N=this.addMarker(X,at);lt&&this.centerMap(X),this.map.fireEvent("geosearch/showlocation",{location:X,marker:N}),ot&&this.closeResults()},closeResults:function(){var X=this.searchElement.container;X.classList.contains("active")&&u(X,"active"),this.clearResults()},addMarker:function(X,at){var Y=this,ot=this.options,lt=ot.marker,z=ot.showPopup,N=ot.popupFormat,J=new leafletSrcExports.Marker([X.y,X.x],lt),et=X.label;return typeof N=="function"&&(et=N({query:at,result:X})),J.bindPopup(et),this.markers.addLayer(J),z&&J.openPopup(),lt.draggable&&J.on("dragend",function(mt){Y.map.fireEvent("geosearch/marker/dragend",{location:J.getLatLng(),event:mt})}),J},centerMap:function(X){var at=this.options,Y=at.retainZoomLevel,ot=at.animateZoom,lt=X.bounds?new leafletSrcExports.LatLngBounds(X.bounds):new leafletSrcExports.LatLng(X.y,X.x).toBounds(10),z=lt.isValid()?lt:this.markers.getBounds();!Y&&lt.isValid()&&!X.bounds||Y||!lt.isValid()?this.map.setView(z.getCenter(),this.getZoom(),{animate:ot}):this.map.fitBounds(z,{animate:ot})},getZoom:function(){var X=this.options,at=X.zoomLevel;return X.retainZoomLevel?this.map.getZoom():at}};function w(){if(!t)throw new Error(b);var X=leafletSrcExports.Control.extend(E);return i(X,[].slice.call(arguments))}(function(X){X[X.SEARCH=0]="SEARCH",X[X.REVERSE=1]="REVERSE"})(h||(h={}));var x=(function(){function X(Y){Y===void 0&&(Y={}),this.options=void 0,this.options=Y}var at=X.prototype;return at.getParamString=function(Y){Y===void 0&&(Y={});var ot=e({},this.options.params,Y);return Object.keys(ot).map(function(lt){return encodeURIComponent(lt)+"="+encodeURIComponent(ot[lt])}).join("&")},at.getUrl=function(Y,ot){return Y+"?"+this.getParamString(ot)},at.search=function(Y){try{var ot=this,lt=ot.endpoint({query:Y.query,type:h.SEARCH});return Promise.resolve(fetch(lt)).then(function(z){return Promise.resolve(z.json()).then(function(N){return ot.parse({data:N})})})}catch(z){return Promise.reject(z)}},X})(),L$1=(function(X){function at(){for(var ot,lt=arguments.length,z=new Array(lt),N=0;N<lt;N++)z[N]=arguments[N];return(ot=X.call.apply(X,[this].concat(z))||this).searchUrl="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find",ot}r(at,X);var Y=at.prototype;return Y.endpoint=function(ot){var lt=ot.query,z=typeof lt=="string"?{text:lt}:lt;return z.f="json",this.getUrl(this.searchUrl,z)},Y.parse=function(ot){return ot.data.locations.map(function(lt){return{x:lt.feature.geometry.x,y:lt.feature.geometry.y,label:lt.name,bounds:[[lt.extent.ymin,lt.extent.xmin],[lt.extent.ymax,lt.extent.xmax]],raw:lt}})},at})(x);typeof SuppressedError=="function"&&SuppressedError;var I;(function(X){X[X.INITIALIZED=0]="INITIALIZED",X[X.LOADING=1]="LOADING",X[X.SUCCESS=2]="SUCCESS",X[X.FAILURE=3]="FAILURE"})(I||(I={}));class LeafletMapCore{constructor(X,at="/vendor/filament-leaflet/images"){this.map=null,this.config=X,this.imgsPath=at,this.layers=new Map,this.layerGroups=new Map,this.baseLayers={},this.geoJsonLayer=null,this.info=null,this.layerControl=null,this.isDrawing=!1,this.callbacks={}}init(){this.createMap(),this.addTileLayers(),this.addLayerGroups(),this.setupMapControls(),Object.keys(this.config.geoJsonData)?.length&&(this.setupInfoControl(),this.loadGeoJson()),this.addLayers()}getTranslation(X,at=""){return window.filamentData?.translations?.[X]||at}createMap(){this.map=L$2.map(this.config.mapId,this.config.mapConfig||{}).setView(this.config.defaultCoord,this.config.defaultZoom),this.config.autoCenter&&this.map.locate({setView:!0}),new ResizeObserver(()=>{this.map&&Alpine.raw(this.map).invalidateSize()}).observe(Alpine.raw(this.map._container))}addTileLayers(){this.config.tileLayersUrl.forEach(([X,at,Y],ot)=>{const lt=L$2.tileLayer(at,{maxZoom:this.config.zoomConfig.max,minZoom:this.config.zoomConfig.min,attribution:Y||""});this.baseLayers[X]=Alpine.raw(lt),ot===0&&Alpine.raw(lt).addTo(Alpine.raw(this.map))})}setupInfoControl(){this.info=L$2.control(),this.info.onAdd=()=>{const X=L$2.DomUtil.create("div","info");return this.info._div=X,X.style.display="none",X},this.info.update=X=>{if(this.info._div)if(X){this.info._div.style.display="block";let at=this.config.infoText.replace("{state}",X.name).replace("{density}",X.density);this.info._div.innerHTML=at}else this.info._div.style.display="none"},this.info.addTo(Alpine.raw(this.map))}async loadGeoJson(){if(this.config.geoJsonUrl)try{const at=await(await fetch(this.config.geoJsonUrl)).json(),Y=Object.entries(this.config.geoJsonData).filter(([ot])=>at[ot]).map(([ot,lt])=>({type:"Feature",id:ot,properties:{name:at[ot].name,density:lt},geometry:{type:"Polygon",coordinates:at[ot].coordinates}}));this.geoJsonLayer=L$2.geoJson({type:"FeatureCollection",features:Y},{style:ot=>this.getFeatureStyle(ot),onEachFeature:(ot,lt)=>{lt.on({mouseover:z=>this.info?.update(z.target.feature.properties),mouseout:()=>this.info?.update(),click:z=>Alpine.raw(this.map).fitBounds(z.target.getBounds())})}}).addTo(Alpine.raw(this.map))}catch(X){console.error("Erro GeoJSON:",X)}}getFeatureStyle(X){const at=Object.values(this.config.geoJsonData),Y=X.properties.density/Math.max(...at),ot=Math.max(0,Math.ceil(Y*this.config.geoJsonColors.length)-1);return{fillColor:this.config.geoJsonColors[ot],weight:2,opacity:1,color:"white",dashArray:"3",fillOpacity:.8}}removeLayer(X){let at=this.layers.get(X.id);at&&Alpine.raw(this.map).removeLayer(Alpine.raw(at.layer))}addLayer(layerData){let layer=null;switch(layerData.type){case"marker":layer=this.createMarker(layerData);break;case"circle":layer=this.createCircle(layerData);break;case"circleMarker":layer=this.createCircleMarker(layerData);break;case"rectangle":layer=this.createRectangle(layerData);break;case"polygon":layer=this.createPolygon(layerData);break;case"polyline":layer=this.createPolyline(layerData);break;default:console.warn(`Tipo de layer desconhecido: ${layerData.type}`);return}if(layer){if(layer.options.group=layerData.group||null,layerData.popup&&this.bindPopup(layer,layerData.popup),layerData.tooltip&&this.bindTooltip(layer,layerData.tooltip),layerData.clickAction&&this.callbacks.onLayerClick&&layer.on("click",()=>{this.callbacks.onLayerClick(layer.options.layerId)}),layerData.onMouseOver&&layer.on("mouseover",function(){eval(layerData.onMouseOver)}),layerData.onMouseOut&&layer.on("mouseout",function(){eval(layerData.onMouseOut)}),layerData.group){const X=this.layerGroups.get(layerData.group);layer.addTo(Alpine.raw(X.layer))}else layer.addTo(Alpine.raw(this.map));this.layers.set(layerData.id,{layer:Alpine.raw(layer),data:layerData})}}addLayers(){const X=Alpine.raw(this.config.layersData);X?.length&&X.forEach(at=>this.addLayer(at))}addLayerGroups(){const X=Alpine.raw(this.config.layerGroupsData);!Object.keys(X)?.length>0||X.forEach(at=>{let Y=null;switch(at.options={pmIgnore:!0},at.type){case"group":Y=L$2.layerGroup(at.options);break;case"feature":Y=L$2.featureGroup(at.options);break;case"cluster":Y=L$2.markerClusterGroup(at.options);break;default:console.warn(`Tipo de grupo desconhecido: ${at.type}`);return}Y&&(this.layerGroups.set(at.id,{name:at.name,layer:Y}),Y.addTo(Alpine.raw(this.map)))})}createMarker(X){const at=this.createIcon(X.icon);return L$2.marker(X.coords,{icon:at,draggable:X.draggable})}createCircle(X){return L$2.circle(X.center,X.options)}createCircleMarker(X){return L$2.circleMarker(X.center,X.options)}createRectangle(X){return L$2.rectangle(X.bounds,X.options)}createPolygon(X){return L$2.polygon(X.points,X.options)}createPolyline(X){return L$2.polyline(X.point,X.options)}createIcon(X){const at=X?.color||"blue",Y=X?.url,ot=X?.size||[25,41],lt=Math.max(...ot),z=[ot[0]/2,ot[1]],N=[0,ot[1]/1.25*-1],J=[lt,lt];return L$2.icon({iconUrl:Y||`${this.imgsPath}/marker-icon-2x-${at}.png`,iconSize:ot,iconAnchor:z,popupAnchor:N,shadowUrl:`${this.imgsPath}/marker-shadow.png`,shadowSize:J})}bindPopup(X,at){let Y='<div class="custom-popup">';at.title&&(Y+=`<strong>${at.title}</strong>`),at.content&&(Y+=`<div>${at.content}</div>`),at.actions&&at.actions.length>0&&at.actions.forEach(ot=>{Y+=`<button onclick="${ot.action}">${ot.label}</button>`}),Y+="</div>",X.bindPopup(Y,at.options||{})}bindTooltip(X,at){const Y=at.content,ot=at.options||{};X.bindTooltip(Y,ot)}setupLayerControl(){let X=Array.from(this.layerGroups.values()).filter(lt=>lt&&lt.name).map(lt=>[lt.name,lt.layer]);X=Object.fromEntries(X);let at=Alpine.raw(this.baseLayers);const Y=Object.keys(at)?.length>1,ot=Object.keys(X)?.length>0;!Y&&!ot||(this.layerControl&&Alpine.raw(this.map).removeControl(Alpine.raw(this.layerControl)),this.layerControl=L$2.control.layers(at,X),Alpine.raw(this.layerControl).addTo(Alpine.raw(this.map)))}setupMapControls(){this.config.mapControls.attributionControl&&this.setupAttributionControl(),this.config.mapControls.scaleControl&&this.setupScaleControl(),this.config.mapControls.zoomControl&&this.setupZoomControl(),this.config.mapControls.fullscreenControl&&this.setupFullscreenControl(),this.config.mapControls.searchControl&&this.setupSearchControl(),this.config.mapControls.drawControls&&this.setupDrawControl(),this.setupLayerControl()}setupAttributionControl(){new L$2.control.attribution().addTo(Alpine.raw(this.map))}setupScaleControl(){new L$2.control.scale().addTo(Alpine.raw(this.map))}setupZoomControl(){new L$2.control.zoom().addTo(Alpine.raw(this.map))}setupSearchControl(){const X=new L$1;new w({provider:X,notFoundMessage:this.getTranslation("address_not_found",""),searchLabel:this.getTranslation("enter_address",""),marker:{icon:this.createIcon({color:"blue"}),draggable:!1}}).addTo(Alpine.raw(this.map))}setupFullscreenControl(){new FullScreen({title:this.getTranslation("full_screen",""),titleCancel:this.getTranslation("exit_full_screen",""),forceSeparateButton:!0}).addTo(Alpine.raw(this.map))}setupDrawControl(){Alpine.raw(this.map.pm).setLang(window.filamentData?.language),Alpine.raw(this.map.pm).setGlobalOptions({snappable:!0,snapDistance:20,markerStyle:{icon:this.createIcon({color:"blue"})}}),Alpine.raw(this.map.pm).addControls(this.config.mapControls.drawControls)}setupEventHandlers(X={}){this.callbacks=X,Alpine.raw(this.map).on("click",Y=>{if(this.isDrawing)return;const ot=Y.latlng;this.callbacks.onMapClick&&this.callbacks.onMapClick(ot.lat,ot.lng)});let at=null;Alpine.raw(this.map).on("move",()=>{if(!this.config.mapConfig.recenterMapTimeout)return;clearTimeout(at);const Y=this.map.getCenter(),ot=this.map.getZoom();Math.abs(Y.lat-this.config.defaultCoord[0])<1&&Math.abs(Y.lng-this.config.defaultCoord[1])<1&&Math.abs(ot-this.config.defaultZoom)<1||(at=setTimeout(()=>{this.map.flyTo(this.config.defaultCoord,this.config.defaultZoom)},this.config.mapConfig.recenterMapTimeout))}),Alpine.raw(this.map).on("pm:globaldrawmodetoggled",Y=>{this.isDrawing=Y.enabled}),Alpine.raw(this.map).on("pm:globaleditmodetoggled",Y=>{this.isDrawing=Y.enabled}),Alpine.raw(this.map).on("pm:globaldragmodetoggled",Y=>{this.isDrawing=Y.enabled}),Alpine.raw(this.map).on("pm:globalremovalmodetoggled",Y=>{this.isDrawing=Y.enabled}),Alpine.raw(this.map).on("pm:globalcutmodetoggled",Y=>{this.isDrawing=Y.enabled}),Alpine.raw(this.map).on("pm:globalrotatemodetoggled",Y=>{this.isDrawing=Y.enabled})}updateMapData(X){const at=this.config;this.config=X;let Y=[],ot=[];at.layersData.forEach(lt=>{this.config.layersData.find(z=>z.id==lt.id)||ot.push(lt)}),this.config.layersData.forEach(lt=>{at.layersData.find(z=>z.id==lt.id)||Y.push(lt)}),ot.forEach(lt=>this.removeLayer(lt)),Y.forEach(lt=>this.addLayer(lt)),Object.keys(this.config.geoJsonData)?.length&&(this.setupInfoControl(),this.loadGeoJson())}clearLayers(){Object.values(this.layers).forEach(({layer:X})=>{X.options.group?Alpine.raw(this.layerGroups[X.options.group].layer).removeLayer(Alpine.raw(X)):Alpine.raw(this.map).removeLayer(Alpine.raw(X))}),this.layers.clear(),Object.values(this.layerGroups).forEach(({layer:X})=>{Alpine.raw(this.map).removeLayer(Alpine.raw(X))}),this.layerGroups.clear(),this.layerControl&&(Alpine.raw(this.map).removeControl(this.layerControl),this.layerControl=null)}destroy(){this.map&&(this.clearLayers(),Alpine.raw(this.map).remove(),this.map=null)}}document.addEventListener("livewire:init",()=>{const X=(at,Y)=>({mapCore:null,config:Y,$wire:at,state:void 0,pickMarker:null,init(){this.mapCore=new LeafletMapCore(this.config),this.state=this.getState(),this.mapCore.init(),this.setupEventHandlers(),this.updatePickMarker(),this.watchState()},getState(){if(!this.config.state)return;const ot=this.$wire.get(this.config.state.statePath);return{lat:ot?ot[this.config.state.latitudeFieldName]:this.config.defaultCoord[0],lng:ot?ot[this.config.state.longitudeFieldName]:this.config.defaultCoord[1]}},setState(ot,lt){this.config.state&&(this.$wire.set(this.config.state.statePath,{[this.config.state.latitudeFieldName]:ot,[this.config.state.longitudeFieldName]:lt}),this.updatePickMarker())},watchState(){this.config.state&&this.$watch("state",ot=>{this.setState(ot.lat,ot.lng)})},updatePickMarker(){this.pickMarker&&Alpine.raw(this.pickMarker).removeFrom(Alpine.raw(this.mapCore.map));const ot=this.getState();let lt=this.config.state.pickMarker;lt.coords=Object.values(ot),this.pickMarker=this.mapCore.createMarker(lt),Alpine.raw(this.pickMarker).addTo(Alpine.raw(this.mapCore.map))},setupEventHandlers(){const ot={onMapClick:(lt,z)=>{this.config.state.disabled||this.setState(lt,z),this.callFieldMethod("handleMapClick",{latitude:lt,longitude:z})},onLayerClick:lt=>{this.callFieldMethod("handleLayerClick",{layerId:lt})}};this.mapCore.setupEventHandlers(ot)},callFieldMethod(ot,lt){this.$wire.callSchemaComponentMethod(Y.state.key,ot,lt)}});window.leafletMapField=X}),document.addEventListener("livewire:init",()=>{const X=(at,Y)=>({mapCore:null,config:Y,$wire:at,init(){this.mapCore=new LeafletMapCore(this.config),this.mapCore.init(),this.setupEventHandlers(),this.setupLivewireListeners()},setupEventHandlers(){const ot={onMapClick:(lt,z)=>{this.$wire.call("handleMapClick",lt,z)},onLayerClick:lt=>{this.$wire.call("handleLayerClick",[lt])}};this.mapCore.setupEventHandlers(ot)},setupLivewireListeners(){window.addEventListener(`update-leaflet-${this.config.mapId}`,ot=>{this.updateMapData(ot.detail.config)})},updateMapData(ot){this.config=ot,this.mapCore.updateMapData(ot)}});window.leafletMapWidget=X}),document.addEventListener("livewire:init",()=>{const X=(at,Y)=>({mapCore:null,config:Y,$wire:at,state:void 0,pickMarker:null,init(){this.mapCore=new LeafletMapCore(this.config),this.state=this.getState(),this.mapCore.init(),this.setupEventHandlers(),this.setupPickMarker()},getState(){if(!this.config.state)return;const ot=this.config.state.state;return{lat:ot?ot[this.config.state.latitudeFieldName]:this.config.defaultCoord[0],lng:ot?ot[this.config.state.longitudeFieldName]:this.config.defaultCoord[1]}},setupPickMarker(){const ot=this.getState();this.pickMarker&&Alpine.raw(this.pickMarker).removeFrom(Alpine.raw(this.mapCore.map));let lt=this.config.state.pickMarker;lt.coords=Object.values(ot),this.pickMarker=this.mapCore.createMarker(lt),Alpine.raw(this.pickMarker).addTo(Alpine.raw(this.mapCore.map))},setupEventHandlers(){const ot={onMapClick:(lt,z)=>{this.callFieldMethod("handleMapClick",{latitude:lt,longitude:z})},onLayerClick:lt=>{this.callFieldMethod("handleLayerClick",{layerId:lt})}};this.mapCore.setupEventHandlers(ot)},callFieldMethod(ot,lt){this.$wire.callSchemaComponentMethod(Y.state.key,ot,lt)}});window.leafletMapEntry=X}),document.addEventListener("livewire:init",()=>{const X=(at,Y)=>({mapCore:null,config:Y,$wire:at,state:void 0,pickMarker:null,init(){this.mapCore=new LeafletMapCore(this.config),this.state=this.getState(),this.mapCore.init(),this.setupEventHandlers(),this.setupPickMarker()},getState(){if(!this.config.state)return;const ot=this.config.state.state;return{lat:ot?ot[this.config.state.latitudeFieldName]:this.config.defaultCoord[0],lng:ot?ot[this.config.state.longitudeFieldName]:this.config.defaultCoord[1]}},setupPickMarker(){const ot=this.getState();this.pickMarker&&Alpine.raw(this.pickMarker).removeFrom(Alpine.raw(this.mapCore.map));let lt=this.config.state.pickMarker;lt.coords=Object.values(ot),this.pickMarker=this.mapCore.createMarker(lt),Alpine.raw(this.pickMarker).addTo(Alpine.raw(this.mapCore.map))},setupEventHandlers(){const ot={onMapClick:(lt,z)=>{this.callColumnMethod("handleMapClick",{latitude:lt,longitude:z})},onLayerClick:lt=>{this.callColumnMethod("handleLayerClick",{layerId:lt})}};this.mapCore.setupEventHandlers(ot)},callColumnMethod(ot,lt){this.$wire.callTableColumnMethod(Y.state.name,Y.state.recordKey,ot,lt)}});window.leafletMapColumn=X})}));
